[0m00:11:18.959446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c2b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c2a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c2a6f0>]}


============================== 00:11:18.961055 | 5013db6b-1917-4862-8141-f0b96e4e26a3 ==============================
[0m00:11:18.961055 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:11:18.961383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:11:18.968235 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m00:11:18.968562 [debug] [MainThread]: Command `dbt deps` failed at 00:11:18.968516 after 0.01 seconds
[0m00:11:18.968787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c2a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c2ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c28ec0>]}
[0m00:11:18.969014 [debug] [MainThread]: Flushing usage events
[0m00:16:21.136640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5cb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6ea120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9f4aa0>]}


============================== 00:16:21.138572 | 704e58cf-6b94-44d5-91a4-7b746ba4beaa ==============================
[0m00:16:21.138572 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:16:21.138949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:16:21.145643 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m00:16:21.145995 [debug] [MainThread]: Command `dbt deps` failed at 00:16:21.145951 after 0.01 seconds
[0m00:16:21.146246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7da2f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be81d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c923590>]}
[0m00:16:21.146547 [debug] [MainThread]: Flushing usage events
[0m00:16:23.038346 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:21:24.722922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e7b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb8b6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f9fe90>]}


============================== 00:21:24.724762 | 4aa92dab-57f7-421f-97fd-c1b2a16f24e6 ==============================
[0m00:21:24.724762 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:21:24.725095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:21:24.732255 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m00:21:24.732811 [debug] [MainThread]: Command `dbt deps` failed at 00:21:24.732769 after 0.01 seconds
[0m00:21:24.733078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba677380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e9c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e9c0e0>]}
[0m00:21:24.733343 [debug] [MainThread]: Flushing usage events
[0m00:21:26.201974 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:35:08.437368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b9b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb51e6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b9a630>]}


============================== 04:35:08.438934 | 6de82cf7-89b1-4c2c-8e2a-ce85cdbb3d9a ==============================
[0m04:35:08.438934 [info ] [MainThread]: Running with dbt=1.6.0
[0m04:35:08.439331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:35:08.446564 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m04:35:08.447156 [debug] [MainThread]: Command `dbt deps` failed at 04:35:08.447114 after 0.01 seconds
[0m04:35:08.447446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4f3f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb917e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4bb9c10>]}
[0m04:35:08.447744 [debug] [MainThread]: Flushing usage events
[0m04:40:10.538924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3a8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4dbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3aa630>]}


============================== 04:40:10.541245 | 530ecbd1-56a5-41e3-a6f8-c420fee5c1fa ==============================
[0m04:40:10.541245 [info ] [MainThread]: Running with dbt=1.6.0
[0m04:40:10.541640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:40:10.554834 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m04:40:10.556342 [debug] [MainThread]: Command `dbt deps` failed at 04:40:10.556112 after 0.02 seconds
[0m04:40:10.557470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c270170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4d9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3dc350>]}
[0m04:40:10.558311 [debug] [MainThread]: Flushing usage events
[0m04:40:11.994624 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:45:13.701003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c58e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1dd7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22a7740>]}


============================== 04:45:13.702688 | f6aa1f91-b7af-40ae-bc12-70134446aa68 ==============================
[0m04:45:13.702688 [info ] [MainThread]: Running with dbt=1.6.0
[0m04:45:13.703057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:45:13.710491 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m04:45:13.710988 [debug] [MainThread]: Command `dbt deps` failed at 04:45:13.710928 after 0.01 seconds
[0m04:45:13.711291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2294b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c89d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c8ade0>]}
[0m04:45:13.711591 [debug] [MainThread]: Flushing usage events
[0m04:45:15.190066 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:53:57.602974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8462b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8462a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8462b620>]}


============================== 04:53:57.605590 | 501a73c4-ad29-40d1-b502-7362fcb07fbe ==============================
[0m04:53:57.605590 [info ] [MainThread]: Running with dbt=1.6.0
[0m04:53:57.605997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:53:57.614296 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m04:53:57.614830 [debug] [MainThread]: Command `dbt deps` failed at 04:53:57.614777 after 0.02 seconds
[0m04:53:57.615118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ac9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b7f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b5d160>]}
[0m04:53:57.615415 [debug] [MainThread]: Flushing usage events
[0m04:58:59.794178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36c79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa307a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3078e60>]}


============================== 04:58:59.796720 | a4cf9196-3784-470a-a9e0-c3e984f3a05f ==============================
[0m04:58:59.796720 [info ] [MainThread]: Running with dbt=1.6.0
[0m04:58:59.797085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:58:59.803872 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m04:58:59.804225 [debug] [MainThread]: Command `dbt deps` failed at 04:58:59.804181 after 0.01 seconds
[0m04:58:59.804489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3038170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e1ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30abd70>]}
[0m04:58:59.804752 [debug] [MainThread]: Flushing usage events
[0m05:04:01.871120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891a8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8966a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891aa630>]}


============================== 05:04:01.872588 | ffe90933-2e75-4dbd-b230-d66544cb7849 ==============================
[0m05:04:01.872588 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:04:01.872927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m05:04:01.879556 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m05:04:01.879915 [debug] [MainThread]: Command `dbt deps` failed at 05:04:01.879871 after 0.01 seconds
[0m05:04:01.880167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896b8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895e2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891d8080>]}
[0m05:04:01.880415 [debug] [MainThread]: Flushing usage events
[0m05:04:03.691313 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:26:55.460835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c79b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdaa1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c79a630>]}


============================== 05:26:55.462750 | 7adba9b4-da13-4e1f-8062-3100e2cc2e1a ==============================
[0m05:26:55.462750 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:26:55.463285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:26:55.496817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7adba9b4-da13-4e1f-8062-3100e2cc2e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d732cf0>]}
[0m05:26:55.497973 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:26:55.498476 [debug] [MainThread]: Command `dbt deps` succeeded at 05:26:55.498424 after 0.04 seconds
[0m05:26:55.498789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cca0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c92e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c83f980>]}
[0m05:26:55.499060 [debug] [MainThread]: Flushing usage events
[0m05:26:57.254150 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:26:58.014007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fa4fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81da3cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fa6a80>]}


============================== 05:26:58.015742 | 66baa373-f242-41e9-a9b8-b4dfd3765003 ==============================
[0m05:26:58.015742 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:26:58.016117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models silver --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:26:58.058168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81089f70>]}
[0m05:26:58.063472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fa7440>]}
[0m05:26:58.063894 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:26:58.067994 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:26:58.068831 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:26:58.069107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81779ca0>]}
[0m05:26:58.330755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804c6030>]}
[0m05:26:58.335712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804a20c0>]}
[0m05:26:58.335964 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:26:58.336177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804c4e90>]}
[0m05:26:58.336854 [info ] [MainThread]: 
[0m05:26:58.337220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:26:58.337790 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:26:58.341379 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:26:58.341667 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:26:58.341870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:26:58.345090 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m05:26:58.345712 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:26:58.346207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_gold_silver)
[0m05:26:58.346552 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "gold_silver"
"
[0m05:26:58.348410 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_silver"
[0m05:26:58.348628 [debug] [ThreadPool]: On create_spacex_db_gold_silver: BEGIN
[0m05:26:58.348863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:26:58.350322 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.350584 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_silver"
[0m05:26:58.350837 [debug] [ThreadPool]: On create_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "create_spacex_db_gold_silver"} */
create schema if not exists "gold_silver"
[0m05:26:58.351984 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:26:58.352430 [debug] [ThreadPool]: On create_spacex_db_gold_silver: COMMIT
[0m05:26:58.352653 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_silver"
[0m05:26:58.352820 [debug] [ThreadPool]: On create_spacex_db_gold_silver: COMMIT
[0m05:26:58.353492 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m05:26:58.353684 [debug] [ThreadPool]: On create_spacex_db_gold_silver: Close
[0m05:26:58.354675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:26:58.354956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_gold_silver, now list_spacex_db_gold_silver)
[0m05:26:58.357006 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:26:58.357792 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:26:58.358011 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:26:58.358217 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:26:58.358398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:26:58.358629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:26:58.360193 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.360314 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.360452 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:26:58.360672 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:26:58.360886 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:26:58.361110 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:26:58.364322 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:26:58.364440 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:26:58.364951 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:26:58.365465 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:26:58.365726 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:26:58.365895 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:26:58.369716 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.370206 [debug] [MainThread]: On master: BEGIN
[0m05:26:58.370413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:26:58.371847 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.372066 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.372282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:26:58.377184 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m05:26:58.377809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8049a720>]}
[0m05:26:58.378098 [debug] [MainThread]: On master: ROLLBACK
[0m05:26:58.378372 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.378570 [debug] [MainThread]: On master: BEGIN
[0m05:26:58.378878 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.379093 [debug] [MainThread]: On master: COMMIT
[0m05:26:58.379274 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.379443 [debug] [MainThread]: On master: COMMIT
[0m05:26:58.379654 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:26:58.379830 [debug] [MainThread]: On master: Close
[0m05:26:58.380191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:26:58.380843 [info ] [MainThread]: 
[0m05:26:58.382126 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m05:26:58.382290 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m05:26:58.382536 [info ] [Thread-1 (]: 1 of 2 START sql view model gold_silver.silver_launches ........................ [RUN]
[0m05:26:58.382761 [info ] [Thread-2 (]: 2 of 2 START sql view model gold_silver.silver_starlink ........................ [RUN]
[0m05:26:58.383225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now model.spacex_analytics.silver_launches)
[0m05:26:58.383549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.silver_starlink)
[0m05:26:58.383775 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m05:26:58.383979 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m05:26:58.386959 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m05:26:58.388371 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m05:26:58.391286 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 05:26:58.387198 => 05:26:58.391183
[0m05:26:58.391591 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m05:26:58.397476 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 05:26:58.384160 => 05:26:58.397400
[0m05:26:58.403098 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m05:26:58.403998 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.silver_starlink"
[0m05:26:58.405245 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.silver_launches"
[0m05:26:58.408212 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.408476 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: BEGIN
[0m05:26:58.408746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:26:58.408903 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.409629 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: BEGIN
[0m05:26:58.409878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:26:58.410570 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.410885 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.411271 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

  create view "spacex_db"."gold_silver"."silver_starlink__dbt_tmp"
    
    
  as (
    

WITH parsed_starlink AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as satellite_id,
        data->'spaceTrack'->>'OBJECT_NAME' as satellite_name,
        data->>'launch' as launch_id,
        
        -- Launch and creation dates
        CASE 
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'LAUNCH_DATE')::date 
            ELSE NULL 
        END as launch_date,
        
        CASE 
            WHEN data->'spaceTrack'->>'CREATION_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'CREATION_DATE')::timestamp 
            ELSE NULL 
        END as tracking_creation_date,
        
        -- Satellite status determination (multiple fallback methods)
        CASE 
            -- Primary: DECAYED field
            WHEN data->'spaceTrack'->>'DECAYED' = '0' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'false' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'False' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = '1' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'true' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'True' THEN false
            -- Fallback: DECAY_DATE field
            WHEN data->'spaceTrack'->>'DECAY_DATE' IS NULL OR data->'spaceTrack'->>'DECAY_DATE' = '' THEN true
            ELSE false
        END as is_active,
        
        -- Orbital parameters (parsed to numeric types)
        CASE 
            WHEN data->'spaceTrack'->>'INCLINATION' IS NOT NULL 
            THEN (data->'spaceTrack'->>'INCLINATION')::numeric 
            ELSE NULL 
        END as inclination_deg,
        
        CASE 
            WHEN data->'spaceTrack'->>'SEMIMAJOR_AXIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'SEMIMAJOR_AXIS')::numeric 
            ELSE NULL 
        END as semimajor_axis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIOD' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIOD')::numeric 
            ELSE NULL 
        END as orbital_period_min,
        
        CASE 
            WHEN data->'spaceTrack'->>'APOAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'APOAPSIS')::numeric 
            ELSE NULL 
        END as apoapsis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIAPSIS')::numeric 
            ELSE NULL 
        END as periapsis_km,
        
        -- Current position data (if available)
        CASE 
            WHEN data->>'longitude' IS NOT NULL 
            THEN (data->>'longitude')::numeric 
            ELSE NULL 
        END as longitude,
        
        CASE 
            WHEN data->>'latitude' IS NOT NULL 
            THEN (data->>'latitude')::numeric 
            ELSE NULL 
        END as latitude,
        
        CASE 
            WHEN data->>'height_km' IS NOT NULL 
            THEN (data->>'height_km')::numeric 
            ELSE NULL 
        END as altitude_km,
        
        CASE 
            WHEN data->>'velocity_kms' IS NOT NULL 
            THEN (data->>'velocity_kms')::numeric 
            ELSE NULL 
        END as velocity_kms,
        
        -- Tracking information
        data->'spaceTrack'->>'NORAD_CAT_ID' as norad_catalog_id,
        data->'spaceTrack'->>'OBJECT_ID' as object_id,
        data->'spaceTrack'->>'DECAY_DATE' as decay_date_raw,
        
        -- Data quality assessment
        CASE 
            WHEN data->'spaceTrack'->>'OBJECT_NAME' IS NULL THEN 'missing_satellite_name'
            WHEN data->>'launch' IS NULL THEN 'missing_launch_reference'
            WHEN data->'spaceTrack'->>'DECAYED' IS NULL AND data->'spaceTrack'->>'DECAY_DATE' IS NULL THEN 'missing_status_info'
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NULL THEN 'missing_launch_date'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."starlink"
    WHERE data IS NOT NULL
)

SELECT 
    satellite_id,
    satellite_name,
    launch_id,
    launch_date,
    tracking_creation_date,
    is_active,
    inclination_deg,
    semimajor_axis_km,
    orbital_period_min,
    apoapsis_km,
    periapsis_km,
    longitude,
    latitude,
    altitude_km,
    velocity_kms,
    norad_catalog_id,
    object_id,
    decay_date_raw,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    CASE 
        WHEN semimajor_axis_km IS NOT NULL 
        THEN semimajor_axis_km - 6371.0  -- Convert to altitude above Earth's surface
        ELSE NULL 
    END as calculated_altitude_km,
    
    -- Orbital regime classification
    CASE 
        WHEN semimajor_axis_km - 6371.0 BETWEEN 160 AND 2000 THEN 'Low Earth Orbit (LEO)'
        WHEN semimajor_axis_km - 6371.0 BETWEEN 2000 AND 35786 THEN 'Medium Earth Orbit (MEO)'
        WHEN semimajor_axis_km - 6371.0 > 35786 THEN 'Geostationary Orbit (GEO)'
        ELSE 'Unknown'
    END as orbital_regime,
    
    -- Age calculation
    CASE 
        WHEN launch_date IS NOT NULL 
        THEN CURRENT_DATE - launch_date 
        ELSE NULL 
    END as satellite_age_days

FROM parsed_starlink
WHERE satellite_id IS NOT NULL

-- Add model documentation

  );
[0m05:26:58.411827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.412367 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.412837 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

  create view "spacex_db"."gold_silver"."silver_launches__dbt_tmp"
    
    
  as (
    

WITH parsed_launches AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as launch_id,
        data->>'name' as mission_name,
        
        -- Date and time parsing
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp 
            ELSE NULL 
        END as launch_date_utc,
        
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp::date 
            ELSE NULL 
        END as launch_date,
        
        -- Launch outcome
        CASE 
            WHEN (data->'success')::text = 'true' THEN true
            WHEN (data->'success')::text = 'false' THEN false
            ELSE NULL
        END as launch_success,
        
        CASE 
            WHEN (data->'upcoming')::text = 'true' THEN true
            WHEN (data->'upcoming')::text = 'false' THEN false
            ELSE NULL
        END as is_upcoming,
        
        -- Technical details
        data->>'rocket' as rocket_id,
        
        CASE 
            WHEN data->>'flight_number' IS NOT NULL 
            THEN (data->>'flight_number')::integer 
            ELSE NULL 
        END as flight_number,
        
        data->>'launchpad' as launchpad_id,
        data->>'details' as mission_details,
        
        -- Business logic: Starlink mission identification
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN true
            WHEN LOWER(data->>'name') LIKE '%starship%' AND LOWER(data->>'name') LIKE '%starlink%' THEN true
            ELSE false
        END as is_starlink_mission,
        
        -- Satellite count estimation for Starlink missions
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN
                CASE 
                    -- Early test missions
                    WHEN LOWER(data->>'name') LIKE '%demo%' 
                      OR LOWER(data->>'name') LIKE '%test%' 
                      OR data->>'name' ILIKE '%tintin%' THEN 2
                    -- V1.0 missions (60 satellites each)
                    WHEN data->>'name' ILIKE '%v1.0%' THEN 60
                    -- V2 missions (larger satellites, fewer per launch)
                    WHEN data->>'name' ILIKE '%v2%' THEN 23
                    -- Standard production batches
                    ELSE 60
                END
            ELSE 0
        END as estimated_satellite_count,
        
        -- Payload analysis
        CASE 
            WHEN data->'payloads' IS NOT NULL 
            THEN jsonb_array_length(data->'payloads') 
            ELSE 0 
        END as payload_count,
        
        -- Data quality assessment
        CASE 
            WHEN data->>'date_utc' IS NULL THEN 'missing_launch_date'
            WHEN data->>'name' IS NULL THEN 'missing_mission_name'
            WHEN (data->'success') IS NULL AND (data->'upcoming')::text = 'false' THEN 'missing_success_status'
            WHEN data->>'rocket' IS NULL THEN 'missing_rocket_info'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."launches"
    WHERE data IS NOT NULL
)

SELECT 
    launch_id,
    mission_name,
    launch_date_utc,
    launch_date,
    launch_success,
    is_upcoming,
    rocket_id,
    flight_number,
    launchpad_id,
    mission_details,
    is_starlink_mission,
    estimated_satellite_count,
    payload_count,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    EXTRACT(YEAR FROM launch_date_utc) as launch_year,
    EXTRACT(MONTH FROM launch_date_utc) as launch_month,
    EXTRACT(DOW FROM launch_date_utc) as launch_day_of_week,
    
    -- Mission type classification
    CASE 
        WHEN is_starlink_mission THEN 'Starlink'
        WHEN LOWER(mission_name) LIKE '%crew%' THEN 'Crew'
        WHEN LOWER(mission_name) LIKE '%cargo%' OR LOWER(mission_name) LIKE '%crs%' THEN 'Cargo'
        WHEN LOWER(mission_name) LIKE '%satellite%' THEN 'Commercial Satellite'
        ELSE 'Other'
    END as mission_type

FROM parsed_launches
WHERE launch_id IS NOT NULL

-- Add model documentation

  );
[0m05:26:58.416900 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:26:58.417069 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:26:58.419432 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.420456 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.420749 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
alter table "spacex_db"."gold_silver"."silver_launches__dbt_tmp" rename to "silver_launches"
[0m05:26:58.420972 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
alter table "spacex_db"."gold_silver"."silver_starlink__dbt_tmp" rename to "silver_starlink"
[0m05:26:58.421454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:58.421603 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:58.426899 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.427897 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.428158 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

        COMMENT ON VIEW "spacex_db"."gold_silver"."silver_launches" IS 'Cleaned launch data with Starlink mission identification and satellite count estimation'
      
[0m05:26:58.428377 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

        COMMENT ON VIEW "spacex_db"."gold_silver"."silver_starlink" IS 'Cleaned Starlink satellite data with active status determination and orbital parameters'
      
[0m05:26:58.429987 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m05:26:58.430128 [debug] [Thread-2 (]: SQL status: COMMENT in 0.0 seconds
[0m05:26:58.430534 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m05:26:58.431199 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.430948 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m05:26:58.431596 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.431402 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m05:26:58.431790 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m05:26:58.432661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:58.435625 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.435777 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:58.435955 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
drop view if exists "spacex_db"."gold_silver"."silver_launches__dbt_backup" cascade
[0m05:26:58.436901 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.437225 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:26:58.437355 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
drop view if exists "spacex_db"."gold_silver"."silver_starlink__dbt_backup" cascade
[0m05:26:58.438021 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 05:26:58.404123 => 05:26:58.437959
[0m05:26:58.438314 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:26:58.438493 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: Close
[0m05:26:58.439066 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 05:26:58.391812 => 05:26:58.439014
[0m05:26:58.439511 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: Close
[0m05:26:58.440713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80464110>]}
[0m05:26:58.440829 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803db4a0>]}
[0m05:26:58.441136 [info ] [Thread-1 (]: 1 of 2 OK created sql view model gold_silver.silver_launches ................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:26:58.441432 [info ] [Thread-2 (]: 2 of 2 OK created sql view model gold_silver.silver_starlink ................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:26:58.441815 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m05:26:58.442091 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m05:26:58.446879 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.447056 [debug] [MainThread]: On master: BEGIN
[0m05:26:58.447209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:26:58.448464 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.448690 [debug] [MainThread]: On master: COMMIT
[0m05:26:58.449117 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.449308 [debug] [MainThread]: On master: COMMIT
[0m05:26:58.449554 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:26:58.449746 [debug] [MainThread]: On master: Close
[0m05:26:58.450058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:26:58.450550 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_launches' was properly closed.
[0m05:26:58.450746 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_starlink' was properly closed.
[0m05:26:58.450945 [info ] [MainThread]: 
[0m05:26:58.451215 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m05:26:58.451604 [debug] [MainThread]: Command end result
[0m05:26:58.456171 [info ] [MainThread]: 
[0m05:26:58.456446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:26:58.456653 [info ] [MainThread]: 
[0m05:26:58.456854 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:26:58.457222 [debug] [MainThread]: Command `dbt run` succeeded at 05:26:58.457185 after 0.45 seconds
[0m05:26:58.457457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810899a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f3dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f3dbe0>]}
[0m05:26:58.457687 [debug] [MainThread]: Flushing usage events
[0m05:26:59.312740 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:27:01.191298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b748ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4ba330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc4cc80>]}


============================== 05:27:01.192999 | be1720af-5233-49a2-b284-a86ced899074 ==============================
[0m05:27:01.192999 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:27:01.193333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:27:01.229062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b77c200>]}
[0m05:27:01.234511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8a80e0>]}
[0m05:27:01.234864 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:27:01.238566 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:27:01.255541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:27:01.255795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:27:01.257939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b74b260>]}
[0m05:27:01.263283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad172c0>]}
[0m05:27:01.263563 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:27:01.263815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7eee40>]}
[0m05:27:01.264478 [info ] [MainThread]: 
[0m05:27:01.264840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:27:01.265392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:27:01.269041 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:27:01.269284 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:27:01.269513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:01.271545 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:27:01.272129 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:27:01.272631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_gold_gold)
[0m05:27:01.272983 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "gold_gold"
"
[0m05:27:01.274875 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_gold"
[0m05:27:01.275124 [debug] [ThreadPool]: On create_spacex_db_gold_gold: BEGIN
[0m05:27:01.275330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:01.277173 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.277449 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_gold"
[0m05:27:01.277849 [debug] [ThreadPool]: On create_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "create_spacex_db_gold_gold"} */
create schema if not exists "gold_gold"
[0m05:27:01.278260 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:27:01.278696 [debug] [ThreadPool]: On create_spacex_db_gold_gold: COMMIT
[0m05:27:01.278931 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_gold"
[0m05:27:01.279150 [debug] [ThreadPool]: On create_spacex_db_gold_gold: COMMIT
[0m05:27:01.279676 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m05:27:01.279903 [debug] [ThreadPool]: On create_spacex_db_gold_gold: Close
[0m05:27:01.280752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_gold_gold, now list_spacex_db_gold_silver)
[0m05:27:01.281092 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:27:01.283068 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:27:01.283817 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:27:01.284032 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:27:01.284221 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:27:01.284413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:01.284614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:01.285870 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.285988 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.286105 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:27:01.286304 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:27:01.286504 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:27:01.286719 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:27:01.287857 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:27:01.288388 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:27:01.288518 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:27:01.288657 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:27:01.289140 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:27:01.290194 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:27:01.292627 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.292864 [debug] [MainThread]: On master: BEGIN
[0m05:27:01.293075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:27:01.294404 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.294665 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.294918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:27:01.298410 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:27:01.298960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c693ec0>]}
[0m05:27:01.299244 [debug] [MainThread]: On master: ROLLBACK
[0m05:27:01.299537 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.299755 [debug] [MainThread]: On master: BEGIN
[0m05:27:01.300096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.300321 [debug] [MainThread]: On master: COMMIT
[0m05:27:01.300561 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.300776 [debug] [MainThread]: On master: COMMIT
[0m05:27:01.301044 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:27:01.301256 [debug] [MainThread]: On master: Close
[0m05:27:01.301635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:27:01.302235 [info ] [MainThread]: 
[0m05:27:01.303632 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:27:01.303938 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:27:01.304330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now model.spacex_analytics.starlink_constellation_status)
[0m05:27:01.304609 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:27:01.307634 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:27:01.309253 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:27:01.304835 => 05:27:01.309163
[0m05:27:01.309513 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:27:01.322675 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:27:01.324253 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:27:01.324547 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:27:01.324763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:01.326352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.326577 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:27:01.326877 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600 as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:27:01.328614 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:27:01.328839 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: ROLLBACK
[0m05:27:01.329161 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:27:01.309715 => 05:27:01.329085
[0m05:27:01.329378 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:27:01.333562 [debug] [Thread-1 (]: Database Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)
  function round(double precision, integer) does not exist
  LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:27:01.333861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac7b650>]}
[0m05:27:01.334154 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold_gold.starlink_constellation_status .. [[31mERROR[0m in 0.03s]
[0m05:27:01.334441 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:27:01.335810 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:27:01.336071 [info ] [Thread-3 (]: 2 of 2 SKIP relation gold_gold.starlink_42k_projection ......................... [[33mSKIP[0m]
[0m05:27:01.336297 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:27:01.337440 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.337666 [debug] [MainThread]: On master: BEGIN
[0m05:27:01.337850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:27:01.339144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.339321 [debug] [MainThread]: On master: COMMIT
[0m05:27:01.339475 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.339639 [debug] [MainThread]: On master: COMMIT
[0m05:27:01.339848 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:27:01.340005 [debug] [MainThread]: On master: Close
[0m05:27:01.340295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:27:01.340458 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:27:01.340615 [debug] [MainThread]: Connection 'list_spacex_db_gold_gold' was properly closed.
[0m05:27:01.340815 [info ] [MainThread]: 
[0m05:27:01.340988 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m05:27:01.341281 [debug] [MainThread]: Command end result
[0m05:27:01.344944 [info ] [MainThread]: 
[0m05:27:01.345148 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:27:01.345315 [info ] [MainThread]: 
[0m05:27:01.345489 [error] [MainThread]: [33mDatabase Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)[0m
[0m05:27:01.345655 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:27:01.345816 [error] [MainThread]:   LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
[0m05:27:01.345974 [error] [MainThread]:                 ^
[0m05:27:01.346155 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:27:01.346329 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:27:01.346509 [info ] [MainThread]: 
[0m05:27:01.346706 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m05:27:01.346949 [debug] [MainThread]: Command `dbt run` failed at 05:27:01.346915 after 0.16 seconds
[0m05:27:01.347153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc7fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb38770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb85940>]}
[0m05:27:01.347335 [debug] [MainThread]: Flushing usage events
[0m05:27:02.207590 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:32:03.979193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbdb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d217620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc9a330>]}


============================== 05:32:03.981248 | c6a81c57-89b2-4081-b159-5233cd5ad9db ==============================
[0m05:32:03.981248 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:32:03.981868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:32:04.035127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c15d670>]}
[0m05:32:04.041128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c15c8c0>]}
[0m05:32:04.041857 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:32:04.046845 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:32:04.065710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:32:04.066107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:32:04.068407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c15fdd0>]}
[0m05:32:04.075214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1aa1e0>]}
[0m05:32:04.075564 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:32:04.075972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ccbd730>]}
[0m05:32:04.076795 [info ] [MainThread]: 
[0m05:32:04.077276 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:32:04.077903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:32:04.082160 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:32:04.082509 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:32:04.082722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:32:04.085010 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:32:04.085750 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:32:04.086572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_silver)
[0m05:32:04.087061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:32:04.089190 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:32:04.090217 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:32:04.090605 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:32:04.090940 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:32:04.091231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:32:04.091498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:32:04.093408 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.093654 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.093826 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:32:04.094115 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:32:04.094412 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:32:04.094702 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:32:04.096052 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:32:04.096225 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:32:04.096803 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:32:04.097443 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:32:04.097857 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:32:04.098047 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:32:04.101306 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.101649 [debug] [MainThread]: On master: BEGIN
[0m05:32:04.101903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:32:04.103550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.103821 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.104073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:32:04.107789 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:32:04.108541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc0c4a0>]}
[0m05:32:04.108847 [debug] [MainThread]: On master: ROLLBACK
[0m05:32:04.109136 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.109354 [debug] [MainThread]: On master: BEGIN
[0m05:32:04.109768 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.110109 [debug] [MainThread]: On master: COMMIT
[0m05:32:04.110320 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.110513 [debug] [MainThread]: On master: COMMIT
[0m05:32:04.110799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:32:04.111027 [debug] [MainThread]: On master: Close
[0m05:32:04.111409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:32:04.111831 [info ] [MainThread]: 
[0m05:32:04.113511 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:32:04.113883 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:32:04.114306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now model.spacex_analytics.starlink_constellation_status)
[0m05:32:04.114613 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:32:04.117846 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:32:04.119064 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:32:04.114836 => 05:32:04.118988
[0m05:32:04.119268 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:32:04.134052 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:32:04.135265 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:32:04.135581 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:32:04.135793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:04.137451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.137771 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:32:04.138080 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600 as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:32:04.139337 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:32:04.141416 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: ROLLBACK
[0m05:32:04.141765 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:32:04.119448 => 05:32:04.141692
[0m05:32:04.141972 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:32:04.143661 [debug] [Thread-1 (]: Database Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)
  function round(double precision, integer) does not exist
  LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:32:04.143990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff786a7830>]}
[0m05:32:04.144324 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold_gold.starlink_constellation_status .. [[31mERROR[0m in 0.03s]
[0m05:32:04.144788 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:32:04.146195 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:32:04.146608 [info ] [Thread-3 (]: 2 of 2 SKIP relation gold_gold.starlink_42k_projection ......................... [[33mSKIP[0m]
[0m05:32:04.146891 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:32:04.148253 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.148496 [debug] [MainThread]: On master: BEGIN
[0m05:32:04.148683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:32:04.150207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.150382 [debug] [MainThread]: On master: COMMIT
[0m05:32:04.150539 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.150682 [debug] [MainThread]: On master: COMMIT
[0m05:32:04.150863 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:32:04.151014 [debug] [MainThread]: On master: Close
[0m05:32:04.151273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:32:04.151439 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:32:04.151610 [debug] [MainThread]: Connection 'list_spacex_db_gold_gold' was properly closed.
[0m05:32:04.151795 [info ] [MainThread]: 
[0m05:32:04.151980 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m05:32:04.152286 [debug] [MainThread]: Command end result
[0m05:32:04.156259 [info ] [MainThread]: 
[0m05:32:04.156735 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:32:04.157120 [info ] [MainThread]: 
[0m05:32:04.157675 [error] [MainThread]: [33mDatabase Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)[0m
[0m05:32:04.157956 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:32:04.158196 [error] [MainThread]:   LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
[0m05:32:04.158368 [error] [MainThread]:                 ^
[0m05:32:04.158546 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:32:04.158709 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:32:04.158893 [info ] [MainThread]: 
[0m05:32:04.159079 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m05:32:04.159331 [debug] [MainThread]: Command `dbt run` failed at 05:32:04.159290 after 0.19 seconds
[0m05:32:04.159569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d10e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d97b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d07ac60>]}
[0m05:32:04.159780 [debug] [MainThread]: Flushing usage events
[0m05:37:07.210052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e98b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb0d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e98a630>]}


============================== 05:37:07.212046 | da678821-e62f-492c-8093-34cd0d025100 ==============================
[0m05:37:07.212046 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:37:07.212365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:37:07.251411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e98be30>]}
[0m05:37:07.256822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df01ca0>]}
[0m05:37:07.257188 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:37:07.261318 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:37:07.278651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:37:07.278925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:37:07.281032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ded75f0>]}
[0m05:37:07.287669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df3ffb0>]}
[0m05:37:07.287948 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:37:07.288249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea10980>]}
[0m05:37:07.288936 [info ] [MainThread]: 
[0m05:37:07.289318 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:37:07.289913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:37:07.293624 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:37:07.293841 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:37:07.294056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:07.296833 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:37:07.297424 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:37:07.298181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_silver)
[0m05:37:07.298546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:37:07.300434 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:37:07.301234 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:37:07.301450 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:37:07.301684 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:37:07.301875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:37:07.302087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:07.303510 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.303984 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.304152 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:37:07.304401 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:37:07.304714 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:37:07.305010 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:37:07.306547 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:37:07.306943 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:37:07.307373 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:37:07.307919 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:37:07.308294 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:37:07.308448 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:37:07.311511 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.311776 [debug] [MainThread]: On master: BEGIN
[0m05:37:07.312004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:37:07.313212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.313471 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.313758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:37:07.317291 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:37:07.317849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3a81a0>]}
[0m05:37:07.318131 [debug] [MainThread]: On master: ROLLBACK
[0m05:37:07.318431 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.318676 [debug] [MainThread]: On master: BEGIN
[0m05:37:07.319022 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.319265 [debug] [MainThread]: On master: COMMIT
[0m05:37:07.319497 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.319740 [debug] [MainThread]: On master: COMMIT
[0m05:37:07.320025 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:37:07.320252 [debug] [MainThread]: On master: Close
[0m05:37:07.320626 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:37:07.321116 [info ] [MainThread]: 
[0m05:37:07.322453 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:37:07.322779 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:37:07.323133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m05:37:07.323390 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:37:07.326392 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:37:07.327891 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:37:07.323613 => 05:37:07.327822
[0m05:37:07.328202 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:37:07.341189 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:37:07.342425 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:37:07.342726 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:37:07.342978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:37:07.344289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.344523 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:37:07.344818 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600 as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:37:07.346269 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:37:07.348098 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: ROLLBACK
[0m05:37:07.348422 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:37:07.328419 => 05:37:07.348357
[0m05:37:07.348655 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:37:07.350197 [debug] [Thread-1 (]: Database Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)
  function round(double precision, integer) does not exist
  LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:37:07.350755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4863f0>]}
[0m05:37:07.351107 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold_gold.starlink_constellation_status .. [[31mERROR[0m in 0.03s]
[0m05:37:07.351669 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:37:07.353403 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:37:07.353722 [info ] [Thread-3 (]: 2 of 2 SKIP relation gold_gold.starlink_42k_projection ......................... [[33mSKIP[0m]
[0m05:37:07.354027 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:37:07.355322 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.355553 [debug] [MainThread]: On master: BEGIN
[0m05:37:07.355739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:37:07.356896 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.357122 [debug] [MainThread]: On master: COMMIT
[0m05:37:07.357317 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.357514 [debug] [MainThread]: On master: COMMIT
[0m05:37:07.357735 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:37:07.357924 [debug] [MainThread]: On master: Close
[0m05:37:07.358251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:37:07.358697 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m05:37:07.358894 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:37:07.359110 [info ] [MainThread]: 
[0m05:37:07.359336 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m05:37:07.359671 [debug] [MainThread]: Command end result
[0m05:37:07.364323 [info ] [MainThread]: 
[0m05:37:07.364565 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:37:07.364761 [info ] [MainThread]: 
[0m05:37:07.364955 [error] [MainThread]: [33mDatabase Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)[0m
[0m05:37:07.365139 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:37:07.365323 [error] [MainThread]:   LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
[0m05:37:07.365517 [error] [MainThread]:                 ^
[0m05:37:07.365702 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:37:07.365881 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:37:07.366058 [info ] [MainThread]: 
[0m05:37:07.366262 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m05:37:07.366680 [debug] [MainThread]: Command `dbt run` failed at 05:37:07.366572 after 0.16 seconds
[0m05:37:07.367000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea5e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea02cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee1b560>]}
[0m05:37:07.367247 [debug] [MainThread]: Flushing usage events
[0m05:40:02.053838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed53ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c45f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c203a40>]}


============================== 05:40:02.055879 | e0743292-f03b-4850-b6aa-842968f4678e ==============================
[0m05:40:02.055879 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:40:02.056401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:40:02.100829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bebde50>]}
[0m05:40:02.106846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b40ca70>]}
[0m05:40:02.107399 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:40:02.111562 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:40:02.135257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:40:02.135768 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_constellation_status.sql
[0m05:40:02.153769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bfeb230>]}
[0m05:40:02.160580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b373bf0>]}
[0m05:40:02.160979 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:40:02.161421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b373dd0>]}
[0m05:40:02.162460 [info ] [MainThread]: 
[0m05:40:02.163081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:40:02.163831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:40:02.168280 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:40:02.168586 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:40:02.168830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:40:02.171919 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:40:02.172834 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:40:02.173721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_silver)
[0m05:40:02.174148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:40:02.178123 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:40:02.177003 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:40:02.178941 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:40:02.178641 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:40:02.179511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:40:02.179195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:40:02.182660 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.183187 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:40:02.182946 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.183750 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:40:02.183489 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:40:02.184032 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:40:02.185386 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:40:02.186986 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:40:02.186431 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:40:02.187833 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:40:02.187386 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:40:02.188215 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:40:02.191642 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.191977 [debug] [MainThread]: On master: BEGIN
[0m05:40:02.192250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:40:02.194282 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.194575 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.194865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:40:02.199432 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:40:02.200135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8cae10>]}
[0m05:40:02.200423 [debug] [MainThread]: On master: ROLLBACK
[0m05:40:02.200732 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.200952 [debug] [MainThread]: On master: BEGIN
[0m05:40:02.201368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.201628 [debug] [MainThread]: On master: COMMIT
[0m05:40:02.201884 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.202105 [debug] [MainThread]: On master: COMMIT
[0m05:40:02.202394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:40:02.202605 [debug] [MainThread]: On master: Close
[0m05:40:02.203027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:40:02.203475 [info ] [MainThread]: 
[0m05:40:02.205166 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:40:02.205573 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:40:02.206075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m05:40:02.206344 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:40:02.209595 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.210848 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:40:02.206556 => 05:40:02.210737
[0m05:40:02.211093 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:40:02.225768 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.227286 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.227562 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:40:02.227845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:40:02.229995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.230369 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.230714 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:40:02.253114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m05:40:02.256150 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.256658 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m05:40:02.257131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:40:02.263704 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:40:02.264149 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.264499 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:40:02.265546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:40:02.268505 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.268942 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m05:40:02.269308 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:40:02.270060 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:40:02.211284 => 05:40:02.269993
[0m05:40:02.270314 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:40:02.270753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3e7f50>]}
[0m05:40:02.271691 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.06s]
[0m05:40:02.272203 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:40:02.273453 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:40:02.273725 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m05:40:02.274098 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m05:40:02.274349 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m05:40:02.276409 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m05:40:02.277403 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 05:40:02.274570 => 05:40:02.277318
[0m05:40:02.277643 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m05:40:02.279949 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m05:40:02.280939 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:40:02.281172 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m05:40:02.281368 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:40:02.283162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.283936 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:40:02.284407 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        (SELECT current_active_satellites FROM current_status) / NULLIF(COUNT(CASE WHEN launch_success THEN 1 END), 0) as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)
        ) as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, 50)  -- Minimum 50 per launch
        ) as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING(
            (42000 - s.current_active_satellites) / 70.0  -- Optimistic 70 satellites per launch
        ) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count), 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    ROUND(optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month), 1) as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(actual_satellites_per_successful_launch, 1) as "METRIC: Actual Sats per Success Launch",
    ROUND(recent_total_launches::numeric / NULLIF(recent_successful_launches, 0), 2) as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m05:40:02.286210 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:40:02.288681 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m05:40:02.289155 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 05:40:02.277819 => 05:40:02.289070
[0m05:40:02.289443 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m05:40:02.291238 [debug] [Thread-3 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  function round(double precision, integer) does not exist
  LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:40:02.291585 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae16750>]}
[0m05:40:02.291903 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model gold_gold.starlink_42k_projection ........ [[31mERROR[0m in 0.02s]
[0m05:40:02.292359 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:40:02.294051 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.294265 [debug] [MainThread]: On master: BEGIN
[0m05:40:02.294446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:40:02.295821 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.296013 [debug] [MainThread]: On master: COMMIT
[0m05:40:02.296171 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.296313 [debug] [MainThread]: On master: COMMIT
[0m05:40:02.296504 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:40:02.296660 [debug] [MainThread]: On master: Close
[0m05:40:02.296949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:40:02.297107 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m05:40:02.297253 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:40:02.297401 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m05:40:02.297580 [info ] [MainThread]: 
[0m05:40:02.297759 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m05:40:02.298098 [debug] [MainThread]: Command end result
[0m05:40:02.302020 [info ] [MainThread]: 
[0m05:40:02.302282 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:40:02.302523 [info ] [MainThread]: 
[0m05:40:02.302775 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m05:40:02.302997 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:40:02.303187 [error] [MainThread]:   LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
[0m05:40:02.303360 [error] [MainThread]:                 ^
[0m05:40:02.303537 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:40:02.303701 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:40:02.303883 [info ] [MainThread]: 
[0m05:40:02.304067 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:40:02.304304 [debug] [MainThread]: Command `dbt run` failed at 05:40:02.304267 after 0.25 seconds
[0m05:40:02.304525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c203a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5e0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed53ec0>]}
[0m05:40:02.304728 [debug] [MainThread]: Flushing usage events
[0m05:45:04.922698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb17cb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b6d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c56f60>]}


============================== 05:45:04.924419 | 6b82eb6c-1960-4f02-b984-563799dee11b ==============================
[0m05:45:04.924419 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:45:04.924775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:45:04.962808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb193b200>]}
[0m05:45:04.968169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c549e0>]}
[0m05:45:04.968558 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:45:04.973729 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:45:04.987550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:45:04.987796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:45:04.990083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d3d220>]}
[0m05:45:04.995652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d8afc0>]}
[0m05:45:04.995956 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:45:04.996210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d17f80>]}
[0m05:45:04.997131 [info ] [MainThread]: 
[0m05:45:04.997617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:45:04.998215 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:45:05.002301 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:45:05.002638 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:45:05.002884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:05.005388 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:45:05.006083 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:45:05.006876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_gold)
[0m05:45:05.007171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_silver'
[0m05:45:05.009404 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:45:05.010214 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:45:05.010540 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:45:05.010790 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:45:05.011056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:05.011300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:05.012946 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.013082 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.013394 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:45:05.013686 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:45:05.013953 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:45:05.014241 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:45:05.015418 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:45:05.016164 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:45:05.016338 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m05:45:05.016515 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:45:05.017015 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:45:05.017766 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:45:05.020106 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.020361 [debug] [MainThread]: On master: BEGIN
[0m05:45:05.020571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:05.022089 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.022341 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.022648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:45:05.026275 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:45:05.026896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d8b620>]}
[0m05:45:05.027198 [debug] [MainThread]: On master: ROLLBACK
[0m05:45:05.027528 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.027760 [debug] [MainThread]: On master: BEGIN
[0m05:45:05.028111 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.028349 [debug] [MainThread]: On master: COMMIT
[0m05:45:05.028603 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.028862 [debug] [MainThread]: On master: COMMIT
[0m05:45:05.029134 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:45:05.029359 [debug] [MainThread]: On master: Close
[0m05:45:05.029736 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:45:05.030424 [info ] [MainThread]: 
[0m05:45:05.031827 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:45:05.032150 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:45:05.032563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m05:45:05.032821 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:45:05.035858 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.037448 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:45:05.033030 => 05:45:05.037367
[0m05:45:05.037712 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:45:05.050798 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.052046 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.052275 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:45:05.052486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:05.053977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.054184 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.054432 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:45:05.066797 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m05:45:05.069177 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.069431 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m05:45:05.069768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:45:05.070759 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.070978 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m05:45:05.071246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:45:05.077817 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:45:05.078099 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.078348 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:45:05.078997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:45:05.081705 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.081946 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m05:45:05.083825 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:45:05.084405 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:45:05.037916 => 05:45:05.084343
[0m05:45:05.084626 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:45:05.085013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0cabf50>]}
[0m05:45:05.085329 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.05s]
[0m05:45:05.085821 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:45:05.087210 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:45:05.087447 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m05:45:05.087817 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m05:45:05.088016 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m05:45:05.089750 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m05:45:05.090543 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 05:45:05.088165 => 05:45:05.090472
[0m05:45:05.090735 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m05:45:05.092051 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m05:45:05.092752 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:45:05.092954 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m05:45:05.093128 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:45:05.094419 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.094660 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:45:05.094992 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        (SELECT current_active_satellites FROM current_status) / NULLIF(COUNT(CASE WHEN launch_success THEN 1 END), 0) as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)
        ) as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, 50)  -- Minimum 50 per launch
        ) as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING(
            (42000 - s.current_active_satellites) / 70.0  -- Optimistic 70 satellites per launch
        ) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count), 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    ROUND(optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month), 1) as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(actual_satellites_per_successful_launch, 1) as "METRIC: Actual Sats per Success Launch",
    ROUND(recent_total_launches::numeric / NULLIF(recent_successful_launches, 0), 2) as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m05:45:05.097614 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:45:05.098096 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m05:45:05.101475 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 05:45:05.090893 => 05:45:05.101391
[0m05:45:05.101720 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m05:45:05.105407 [debug] [Thread-3 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  function round(double precision, integer) does not exist
  LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:45:05.106691 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d59340>]}
[0m05:45:05.107071 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model gold_gold.starlink_42k_projection ........ [[31mERROR[0m in 0.02s]
[0m05:45:05.107557 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:45:05.109320 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.109572 [debug] [MainThread]: On master: BEGIN
[0m05:45:05.109805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:45:05.111369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.111604 [debug] [MainThread]: On master: COMMIT
[0m05:45:05.111793 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.111979 [debug] [MainThread]: On master: COMMIT
[0m05:45:05.112202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:45:05.112384 [debug] [MainThread]: On master: Close
[0m05:45:05.112707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:45:05.113323 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:45:05.113540 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m05:45:05.113718 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m05:45:05.113925 [info ] [MainThread]: 
[0m05:45:05.114197 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m05:45:05.114570 [debug] [MainThread]: Command end result
[0m05:45:05.118734 [info ] [MainThread]: 
[0m05:45:05.118996 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:45:05.119200 [info ] [MainThread]: 
[0m05:45:05.119411 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m05:45:05.119615 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:45:05.119798 [error] [MainThread]:   LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
[0m05:45:05.119975 [error] [MainThread]:                 ^
[0m05:45:05.120152 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:45:05.120324 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:45:05.120511 [info ] [MainThread]: 
[0m05:45:05.120713 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:45:05.120982 [debug] [MainThread]: Command `dbt run` failed at 05:45:05.120947 after 0.20 seconds
[0m05:45:05.121228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb18ebcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d2fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b6d9a0>]}
[0m05:45:05.121453 [debug] [MainThread]: Flushing usage events
[0m05:45:06.676825 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:45:20.163217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f578800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a1d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f57af90>]}


============================== 05:45:20.165158 | fcc29022-eff9-4418-9ec0-bb59a358803c ==============================
[0m05:45:20.165158 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:45:20.165539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:45:20.202837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eafd280>]}
[0m05:45:20.208415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eaff230>]}
[0m05:45:20.208885 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:45:20.212944 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:45:20.231874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:45:20.232244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:45:20.234547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eadb830>]}
[0m05:45:20.240873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb47290>]}
[0m05:45:20.241221 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:45:20.241626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6dee40>]}
[0m05:45:20.242348 [info ] [MainThread]: 
[0m05:45:20.242762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:45:20.243365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:45:20.247209 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:45:20.247509 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:45:20.247753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:20.249945 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:45:20.250591 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:45:20.251320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_silver)
[0m05:45:20.251708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:45:20.253654 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:45:20.254421 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:45:20.254733 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:45:20.255000 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:45:20.255287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:20.255515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:20.257363 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.257499 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.257704 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:45:20.257965 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:45:20.258279 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:45:20.258586 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:45:20.259812 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m05:45:20.261677 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:45:20.261100 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:45:20.262521 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:45:20.262079 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:45:20.262852 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:45:20.266215 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.266524 [debug] [MainThread]: On master: BEGIN
[0m05:45:20.266778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:20.268560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.268810 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.269087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:45:20.273032 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:45:20.273779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9031b200>]}
[0m05:45:20.274097 [debug] [MainThread]: On master: ROLLBACK
[0m05:45:20.274432 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.274674 [debug] [MainThread]: On master: BEGIN
[0m05:45:20.275063 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.275291 [debug] [MainThread]: On master: COMMIT
[0m05:45:20.275514 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.275741 [debug] [MainThread]: On master: COMMIT
[0m05:45:20.276006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:45:20.276216 [debug] [MainThread]: On master: Close
[0m05:45:20.276635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:45:20.277136 [info ] [MainThread]: 
[0m05:45:20.278663 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:45:20.278987 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:45:20.279397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m05:45:20.279647 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:45:20.282844 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.284118 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:45:20.279846 => 05:45:20.284034
[0m05:45:20.284367 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:45:20.298208 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.299517 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.299773 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:45:20.300002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:20.301677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.301937 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.302253 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:45:20.314962 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m05:45:20.317474 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.317818 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m05:45:20.318312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:45:20.319413 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.319729 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m05:45:20.320112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:45:20.326996 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:45:20.327314 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.327577 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:45:20.328258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:45:20.331045 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.331314 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m05:45:20.332311 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:45:20.333019 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:45:20.284562 => 05:45:20.332950
[0m05:45:20.333296 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:45:20.333717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea8fb60>]}
[0m05:45:20.334918 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.05s]
[0m05:45:20.335417 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:45:20.336594 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:45:20.336874 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m05:45:20.337301 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m05:45:20.337534 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m05:45:20.339437 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m05:45:20.340319 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 05:45:20.337703 => 05:45:20.340224
[0m05:45:20.340582 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m05:45:20.342016 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m05:45:20.342881 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:45:20.343125 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m05:45:20.343347 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:45:20.344917 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.345129 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:45:20.345476 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        (SELECT current_active_satellites FROM current_status) / NULLIF(COUNT(CASE WHEN launch_success THEN 1 END), 0) as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)
        ) as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, 50)  -- Minimum 50 per launch
        ) as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING(
            (42000 - s.current_active_satellites) / 70.0  -- Optimistic 70 satellites per launch
        ) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count), 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    ROUND(optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month), 1) as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(actual_satellites_per_successful_launch, 1) as "METRIC: Actual Sats per Success Launch",
    ROUND(recent_total_launches::numeric / NULLIF(recent_successful_launches, 0), 2) as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m05:45:20.347057 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:45:20.347282 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m05:45:20.347604 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 05:45:20.340754 => 05:45:20.347530
[0m05:45:20.347814 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m05:45:20.349450 [debug] [Thread-3 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  function round(double precision, integer) does not exist
  LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:45:20.349775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb18710>]}
[0m05:45:20.350111 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model gold_gold.starlink_42k_projection ........ [[31mERROR[0m in 0.01s]
[0m05:45:20.350619 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:45:20.352234 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.352457 [debug] [MainThread]: On master: BEGIN
[0m05:45:20.352659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:45:20.353921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.354130 [debug] [MainThread]: On master: COMMIT
[0m05:45:20.354322 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.354477 [debug] [MainThread]: On master: COMMIT
[0m05:45:20.354683 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:45:20.354848 [debug] [MainThread]: On master: Close
[0m05:45:20.355157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:45:20.355322 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m05:45:20.355472 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:45:20.355631 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m05:45:20.355840 [info ] [MainThread]: 
[0m05:45:20.356028 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m05:45:20.356360 [debug] [MainThread]: Command end result
[0m05:45:20.360537 [info ] [MainThread]: 
[0m05:45:20.360786 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:45:20.360973 [info ] [MainThread]: 
[0m05:45:20.361162 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m05:45:20.361345 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:45:20.361521 [error] [MainThread]:   LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
[0m05:45:20.361691 [error] [MainThread]:                 ^
[0m05:45:20.361854 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:45:20.362017 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:45:20.362178 [info ] [MainThread]: 
[0m05:45:20.362379 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:45:20.362631 [debug] [MainThread]: Command `dbt run` failed at 05:45:20.362593 after 0.20 seconds
[0m05:45:20.362870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa180b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a1d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f70eed0>]}
[0m05:45:20.363115 [debug] [MainThread]: Flushing usage events
[0m05:45:21.359752 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:50:22.326722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e21bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3ad9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f162330>]}


============================== 05:50:22.328307 | 23d97afb-0792-4a34-9abf-497b2482da42 ==============================
[0m05:50:22.328307 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:50:22.328661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:50:22.370528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d77bef0>]}
[0m05:50:22.376113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e24a720>]}
[0m05:50:22.376620 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:50:22.380854 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:50:22.397083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:50:22.397454 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m05:50:22.414707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d79c440>]}
[0m05:50:22.421131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d703e30>]}
[0m05:50:22.421431 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:50:22.421872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d703bf0>]}
[0m05:50:22.422558 [info ] [MainThread]: 
[0m05:50:22.422972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:50:22.423509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:50:22.427024 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:50:22.427231 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:50:22.427409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:22.429929 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:50:22.430541 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:50:22.431218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_silver)
[0m05:50:22.431571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:50:22.434256 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:50:22.433547 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:50:22.434727 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:50:22.434471 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:50:22.435255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:22.434997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:22.436592 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.437063 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:50:22.436911 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.437594 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:50:22.437313 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:50:22.437828 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:50:22.439230 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:50:22.439791 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:50:22.440523 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m05:50:22.441179 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:50:22.440749 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:50:22.441464 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:50:22.444245 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.444511 [debug] [MainThread]: On master: BEGIN
[0m05:50:22.444748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:50:22.445965 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.446179 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.446420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:50:22.450292 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:50:22.450809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7e53a0>]}
[0m05:50:22.451074 [debug] [MainThread]: On master: ROLLBACK
[0m05:50:22.451354 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.451570 [debug] [MainThread]: On master: BEGIN
[0m05:50:22.451902 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.452132 [debug] [MainThread]: On master: COMMIT
[0m05:50:22.452352 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.452560 [debug] [MainThread]: On master: COMMIT
[0m05:50:22.452832 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:50:22.453039 [debug] [MainThread]: On master: Close
[0m05:50:22.453374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:50:22.453766 [info ] [MainThread]: 
[0m05:50:22.455206 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:50:22.455518 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:50:22.455895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m05:50:22.456141 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:50:22.459007 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.460293 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:50:22.456336 => 05:50:22.460221
[0m05:50:22.460536 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:50:22.473112 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.474247 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.474465 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:50:22.474676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:22.475744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.475980 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.476269 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:50:22.491833 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m05:50:22.494051 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.494347 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m05:50:22.494797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:50:22.495841 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.496110 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m05:50:22.496516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:50:22.502962 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:50:22.503241 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.503509 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:50:22.504201 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:50:22.507660 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.507915 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m05:50:22.508886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:50:22.509493 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:50:22.460719 => 05:50:22.509423
[0m05:50:22.509737 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:50:22.510131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d17fa10>]}
[0m05:50:22.511118 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.05s]
[0m05:50:22.511561 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:50:22.512682 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:50:22.512953 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m05:50:22.513347 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m05:50:22.513543 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m05:50:22.515289 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m05:50:22.516265 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 05:50:22.513707 => 05:50:22.516175
[0m05:50:22.516502 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m05:50:22.517879 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m05:50:22.519806 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:50:22.520010 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m05:50:22.520195 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:50:22.521508 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.521736 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:50:22.522114 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        (SELECT current_active_satellites FROM current_status) / NULLIF(COUNT(CASE WHEN launch_success THEN 1 END), 0) as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)
        ) as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, 50)  -- Minimum 50 per launch
        ) as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING(
            (42000 - s.current_active_satellites) / 70.0  -- Optimistic 70 satellites per launch
        ) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count)::numeric, 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch::numeric, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month::numeric, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year::numeric, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate::numeric, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed::numeric, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed::numeric, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    ROUND((optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month))::numeric, 1) as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(actual_satellites_per_successful_launch::numeric, 1) as "METRIC: Actual Sats per Success Launch",
    ROUND((recent_total_launches::numeric / NULLIF(recent_successful_launches, 0))::numeric, 2) as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m05:50:22.527988 [debug] [Thread-3 (]: Postgres adapter: Postgres error: division by zero

[0m05:50:22.529590 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m05:50:22.529937 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 05:50:22.516667 => 05:50:22.529869
[0m05:50:22.530171 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m05:50:22.532330 [debug] [Thread-3 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  division by zero
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:50:22.532618 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d17c380>]}
[0m05:50:22.532921 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model gold_gold.starlink_42k_projection ........ [[31mERROR[0m in 0.02s]
[0m05:50:22.533218 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:50:22.534834 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.535073 [debug] [MainThread]: On master: BEGIN
[0m05:50:22.535298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:50:22.536434 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.536634 [debug] [MainThread]: On master: COMMIT
[0m05:50:22.536812 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.536974 [debug] [MainThread]: On master: COMMIT
[0m05:50:22.537177 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:50:22.537349 [debug] [MainThread]: On master: Close
[0m05:50:22.537651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:50:22.537826 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m05:50:22.537989 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:50:22.538152 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m05:50:22.538346 [info ] [MainThread]: 
[0m05:50:22.538561 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m05:50:22.538897 [debug] [MainThread]: Command end result
[0m05:50:22.542806 [info ] [MainThread]: 
[0m05:50:22.543023 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:50:22.543200 [info ] [MainThread]: 
[0m05:50:22.543376 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m05:50:22.543546 [error] [MainThread]:   division by zero
[0m05:50:22.543712 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:50:22.543893 [info ] [MainThread]: 
[0m05:50:22.544072 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:50:22.544306 [debug] [MainThread]: Command `dbt run` failed at 05:50:22.544272 after 0.22 seconds
[0m05:50:22.544518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e39b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926bd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6094f0>]}
[0m05:50:22.544709 [debug] [MainThread]: Flushing usage events
[0m05:50:23.860082 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:55:25.630283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33db620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4071a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33d9220>]}


============================== 05:55:25.632737 | 01a017ec-09ed-4860-894a-9e44f168c2ec ==============================
[0m05:55:25.632737 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:55:25.633093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m05:55:25.668225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64786b0>]}
[0m05:55:25.673424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa390e120>]}
[0m05:55:25.673798 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:55:25.677369 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:55:25.692448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:55:25.692719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:55:25.694789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa340cc50>]}
[0m05:55:25.700228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29a37a0>]}
[0m05:55:25.700512 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:55:25.700753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3859b50>]}
[0m05:55:25.701417 [info ] [MainThread]: 
[0m05:55:25.701811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:55:25.702342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:55:25.705974 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:55:25.706204 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:55:25.706407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:25.708390 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:55:25.708974 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:55:25.709620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_gold)
[0m05:55:25.711648 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:55:25.711928 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_silver'
[0m05:55:25.712081 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:55:25.712819 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:55:25.713092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:55:25.713341 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:55:25.713961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:25.714838 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.715111 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.715240 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:55:25.715504 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:55:25.715775 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:55:25.716058 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:55:25.717154 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m05:55:25.718028 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:55:25.718467 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:55:25.719041 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:55:25.719343 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:55:25.719602 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:55:25.721938 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.722190 [debug] [MainThread]: On master: BEGIN
[0m05:55:25.722419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:55:25.723617 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.723867 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.724131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:55:25.727669 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:55:25.728187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33dadb0>]}
[0m05:55:25.728478 [debug] [MainThread]: On master: ROLLBACK
[0m05:55:25.728778 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.729011 [debug] [MainThread]: On master: BEGIN
[0m05:55:25.729359 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.729606 [debug] [MainThread]: On master: COMMIT
[0m05:55:25.729828 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.730049 [debug] [MainThread]: On master: COMMIT
[0m05:55:25.730328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:55:25.730565 [debug] [MainThread]: On master: Close
[0m05:55:25.730932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:55:25.731448 [info ] [MainThread]: 
[0m05:55:25.732776 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:55:25.733080 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:55:25.733441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now model.spacex_analytics.starlink_constellation_status)
[0m05:55:25.733766 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:55:25.736679 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.738221 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:55:25.733981 => 05:55:25.738149
[0m05:55:25.738472 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:55:25.751330 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.752570 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.752826 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:55:25.753077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:25.754346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.754594 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.754915 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:55:25.767144 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m05:55:25.769343 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.769566 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m05:55:25.769870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:55:25.770869 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.771109 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m05:55:25.771429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:55:25.777867 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:55:25.778122 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.778347 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:55:25.778993 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:55:25.781586 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.781817 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m05:55:25.782843 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:55:25.783393 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:55:25.738697 => 05:55:25.783332
[0m05:55:25.783610 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:55:25.783951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28d34a0>]}
[0m05:55:25.784259 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.05s]
[0m05:55:25.784700 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:55:25.785842 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:55:25.786120 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m05:55:25.786533 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m05:55:25.786748 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m05:55:25.788791 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m05:55:25.789688 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 05:55:25.786922 => 05:55:25.789598
[0m05:55:25.789939 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m05:55:25.791381 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m05:55:25.792220 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:55:25.792440 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m05:55:25.792656 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:55:25.793832 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.794058 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:55:25.794413 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        (SELECT current_active_satellites FROM current_status) / NULLIF(COUNT(CASE WHEN launch_success THEN 1 END), 0) as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)
        ) as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, 50)  -- Minimum 50 per launch
        ) as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING(
            (42000 - s.current_active_satellites) / 70.0  -- Optimistic 70 satellites per launch
        ) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count)::numeric, 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch::numeric, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month::numeric, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year::numeric, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate::numeric, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed::numeric, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed::numeric, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    ROUND((optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month))::numeric, 1) as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(actual_satellites_per_successful_launch::numeric, 1) as "METRIC: Actual Sats per Success Launch",
    ROUND((recent_total_launches::numeric / NULLIF(recent_successful_launches, 0))::numeric, 2) as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m05:55:25.799765 [debug] [Thread-3 (]: Postgres adapter: Postgres error: division by zero

[0m05:55:25.800022 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m05:55:25.802345 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 05:55:25.790138 => 05:55:25.802284
[0m05:55:25.802559 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m05:55:25.804004 [debug] [Thread-3 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  division by zero
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:55:25.804284 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa06fb710>]}
[0m05:55:25.804563 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model gold_gold.starlink_42k_projection ........ [[31mERROR[0m in 0.02s]
[0m05:55:25.804956 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:55:25.806586 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.806823 [debug] [MainThread]: On master: BEGIN
[0m05:55:25.807027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:55:25.808150 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.808340 [debug] [MainThread]: On master: COMMIT
[0m05:55:25.808503 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.808658 [debug] [MainThread]: On master: COMMIT
[0m05:55:25.808846 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:55:25.808996 [debug] [MainThread]: On master: Close
[0m05:55:25.809247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:25.809419 [debug] [MainThread]: Connection 'list_spacex_db_gold_gold' was properly closed.
[0m05:55:25.809581 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:55:25.809732 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m05:55:25.809912 [info ] [MainThread]: 
[0m05:55:25.810091 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m05:55:25.810408 [debug] [MainThread]: Command end result
[0m05:55:25.814029 [info ] [MainThread]: 
[0m05:55:25.814263 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:55:25.814455 [info ] [MainThread]: 
[0m05:55:25.814657 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m05:55:25.814841 [error] [MainThread]:   division by zero
[0m05:55:25.815019 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:55:25.815200 [info ] [MainThread]: 
[0m05:55:25.815400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:55:25.815669 [debug] [MainThread]: Command `dbt run` failed at 05:55:25.815633 after 0.19 seconds
[0m05:55:25.815887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38780b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34cbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa353ac60>]}
[0m05:55:25.816076 [debug] [MainThread]: Flushing usage events
[0m05:55:27.684143 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m06:14:01.598413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9434a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98ca330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad92cc80>]}


============================== 06:14:01.600921 | 84f0773b-1931-42fc-87fa-ee3481415939 ==============================
[0m06:14:01.600921 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:14:01.601273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:14:01.645795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9437830>]}
[0m06:14:01.651279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89ab1a0>]}
[0m06:14:01.651728 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m06:14:01.655974 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:14:01.677263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:14:01.677737 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m06:14:01.697547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89abcb0>]}
[0m06:14:01.704215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8934290>]}
[0m06:14:01.704550 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m06:14:01.704797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9a649b0>]}
[0m06:14:01.705530 [info ] [MainThread]: 
[0m06:14:01.705960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:14:01.706750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m06:14:01.710927 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m06:14:01.711233 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m06:14:01.711469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:01.715468 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m06:14:01.716190 [debug] [ThreadPool]: On list_spacex_db: Close
[0m06:14:01.717025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_gold)
[0m06:14:01.717411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_silver'
[0m06:14:01.720926 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:01.719975 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:01.721494 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m06:14:01.721203 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m06:14:01.722019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:01.721752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:14:01.724587 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.725423 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.725696 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:01.725978 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:01.726292 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m06:14:01.726650 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m06:14:01.729120 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:01.729873 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m06:14:01.730020 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:01.730264 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m06:14:01.730779 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m06:14:01.732194 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m06:14:01.734555 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.734837 [debug] [MainThread]: On master: BEGIN
[0m06:14:01.735071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:01.737021 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.737413 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.737727 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:14:01.742218 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:01.742956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa2f3f80>]}
[0m06:14:01.743267 [debug] [MainThread]: On master: ROLLBACK
[0m06:14:01.743595 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.743881 [debug] [MainThread]: On master: BEGIN
[0m06:14:01.744297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.744549 [debug] [MainThread]: On master: COMMIT
[0m06:14:01.744797 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.745041 [debug] [MainThread]: On master: COMMIT
[0m06:14:01.745336 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:01.745596 [debug] [MainThread]: On master: Close
[0m06:14:01.746056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:14:01.746861 [info ] [MainThread]: 
[0m06:14:01.748424 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m06:14:01.748770 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m06:14:01.749266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m06:14:01.749527 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m06:14:01.753239 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.754962 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 06:14:01.749729 => 06:14:01.754862
[0m06:14:01.755278 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m06:14:01.769770 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.771334 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.771617 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m06:14:01.771900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:01.774659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.774952 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.775227 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m06:14:01.798635 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:01.801490 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.802007 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m06:14:01.802814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:14:01.804059 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.804562 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m06:14:01.805843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:14:01.815307 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m06:14:01.816764 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.817084 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m06:14:01.818020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m06:14:01.823549 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.823948 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m06:14:01.825499 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m06:14:01.826303 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 06:14:01.755530 => 06:14:01.826228
[0m06:14:01.826540 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m06:14:01.826947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa838e900>]}
[0m06:14:01.827286 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.08s]
[0m06:14:01.827629 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m06:14:01.829350 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m06:14:01.829736 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m06:14:01.830168 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m06:14:01.830410 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m06:14:01.832550 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.833768 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 06:14:01.830624 => 06:14:01.833690
[0m06:14:01.833990 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m06:14:01.835543 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.836541 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.836803 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m06:14:01.837034 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:14:01.838795 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.839036 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.839439 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        CASE 
            WHEN COUNT(CASE WHEN launch_success THEN 1 END) > 0 THEN
                (SELECT current_active_satellites FROM current_status) / COUNT(CASE WHEN launch_success THEN 1 END)
            ELSE NULL
        END as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CASE 
            WHEN GREATEST(COALESCE(e.actual_satellites_per_successful_launch, 0), COALESCE(e.avg_estimated_per_launch, 0)) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch))
            ELSE NULL
        END as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CASE 
            WHEN GREATEST(COALESCE(e.actual_satellites_per_successful_launch, 0), 50) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50))
            ELSE NULL
        END as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING((42000 - s.current_active_satellites) / 70.0) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 AND GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 AND GREATEST(e.actual_satellites_per_successful_launch, 50) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count)::numeric, 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch::numeric, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month::numeric, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year::numeric, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate::numeric, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed::numeric, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed::numeric, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    CASE 
        WHEN GREATEST(COALESCE(recent_6mo_monthly_rate, 0), COALESCE(avg_launches_per_month, 0)) > 0 AND optimistic_launches_needed > 0 THEN
            ROUND((optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month))::numeric, 1)
        ELSE NULL
    END as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(COALESCE(actual_satellites_per_successful_launch, 0)::numeric, 1) as "METRIC: Actual Sats per Success Launch",
    CASE 
        WHEN recent_successful_launches > 0 THEN
            ROUND((recent_total_launches::numeric / recent_successful_launches)::numeric, 2)
        ELSE NULL
    END as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m06:14:01.845059 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:01.846390 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.846624 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp" rename to "starlink_42k_projection"
[0m06:14:01.846928 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:14:01.847800 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.847997 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

        COMMENT ON TABLE "spacex_db"."gold_gold"."starlink_42k_projection" IS 'Business intelligence table answering: When will SpaceX reach 42,000 Starlink satellites and how many launches will it take?'
      
[0m06:14:01.848577 [debug] [Thread-3 (]: SQL status: COMMENT in 0.0 seconds
[0m06:14:01.849187 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m06:14:01.849384 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.849566 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m06:14:01.850172 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m06:14:01.851333 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.851613 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
drop table if exists "spacex_db"."gold_gold"."starlink_42k_projection__dbt_backup" cascade
[0m06:14:01.851928 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m06:14:01.852548 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 06:14:01.834154 => 06:14:01.852460
[0m06:14:01.852773 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m06:14:01.853214 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa838d160>]}
[0m06:14:01.853567 [info ] [Thread-3 (]: 2 of 2 OK created sql table model gold_gold.starlink_42k_projection ............ [[32mSELECT 1[0m in 0.02s]
[0m06:14:01.854131 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m06:14:01.855853 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.856073 [debug] [MainThread]: On master: BEGIN
[0m06:14:01.856260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:14:01.857812 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.858012 [debug] [MainThread]: On master: COMMIT
[0m06:14:01.858177 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.858338 [debug] [MainThread]: On master: COMMIT
[0m06:14:01.858606 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:01.858879 [debug] [MainThread]: On master: Close
[0m06:14:01.859202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:01.859397 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m06:14:01.859638 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m06:14:01.859833 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m06:14:01.860064 [info ] [MainThread]: 
[0m06:14:01.860272 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m06:14:01.860628 [debug] [MainThread]: Command end result
[0m06:14:01.864397 [info ] [MainThread]: 
[0m06:14:01.864658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:14:01.864870 [info ] [MainThread]: 
[0m06:14:01.865099 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:14:01.865372 [debug] [MainThread]: Command `dbt run` succeeded at 06:14:01.865328 after 0.27 seconds
[0m06:14:01.865583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93e8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa0c1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa95bc200>]}
[0m06:14:01.865795 [debug] [MainThread]: Flushing usage events
[0m06:14:03.472163 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m06:14:04.874349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b90b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba9ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c10f740>]}


============================== 06:14:04.876138 | bcb6bd0f-4a76-4e86-902c-5337f081613c ==============================
[0m06:14:04.876138 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:14:04.876676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:14:04.898036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862bb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86a85e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8643cb60>]}


============================== 06:14:04.900542 | 28170a0f-63f2-4b38-abb6-e633c0250afd ==============================
[0m06:14:04.900542 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:14:04.901162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:14:04.918083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba8b110>]}
[0m06:14:04.923765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7d2360>]}
[0m06:14:04.924393 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m06:14:04.930351 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:14:04.941047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863d9df0>]}
[0m06:14:04.947505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8582f2f0>]}
[0m06:14:04.947821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:14:04.948836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:14:04.947905 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m06:14:04.951288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9a25d0>]}
[0m06:14:04.953696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aede990>]}
[0m06:14:04.954027 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m06:14:04.954261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1cf4a0>]}
[0m06:14:04.955209 [info ] [MainThread]: 
[0m06:14:04.955447 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:14:04.955810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:14:04.956410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_silver'
[0m06:14:04.957044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m06:14:04.961914 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:04.961138 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:04.962311 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m06:14:04.962118 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m06:14:04.962951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:04.962627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:04.966528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:04.966920 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:04.966688 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:04.967546 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:04.967191 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m06:14:04.967928 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m06:14:04.969531 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:04.971468 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:04.972612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:14:04.972114 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m06:14:04.972898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:14:04.972726 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m06:14:04.973157 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m06:14:04.973543 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m06:14:04.976317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8582ffb0>]}
[0m06:14:04.977063 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:04.977342 [debug] [MainThread]: On master: BEGIN
[0m06:14:04.977587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:04.979031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:04.979346 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:04.979711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:14:04.982938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85872ea0>]}
[0m06:14:04.983216 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m06:14:04.983635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8665ecc0>]}
[0m06:14:04.984161 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:04.985138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aedee70>]}
[0m06:14:04.984555 [info ] [MainThread]: 
[0m06:14:04.985717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:14:04.985414 [debug] [MainThread]: On master: ROLLBACK
[0m06:14:04.986269 [debug] [MainThread]: On master: Close
[0m06:14:04.986649 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:14:04.987003 [info ] [MainThread]: 
[0m06:14:04.986402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m06:14:04.991681 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m06:14:04.987404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_silver'
[0m06:14:04.992046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now model.spacex_analytics.silver_launches)
[0m06:14:04.992848 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m06:14:04.991808 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:04.993015 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:04.993561 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m06:14:04.993795 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m06:14:04.995564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:04.995784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:04.992227 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m06:14:04.997776 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:04.992710 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:04.998110 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:04.998555 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m06:14:04.992555 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:04.998262 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:04.999290 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:04.999127 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae'
[0m06:14:04.999761 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:04.999559 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m06:14:04.999890 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:05.002457 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m06:14:05.003758 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:05.003933 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m06:14:05.004363 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m06:14:05.005786 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m06:14:05.008055 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:04.998640 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb'
[0m06:14:04.997420 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m06:14:05.008337 [debug] [MainThread]: On master: BEGIN
[0m06:14:04.997828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.silver_starlink)
[0m06:14:05.008923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:05.009115 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m06:14:05.008490 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.013830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.014127 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:05.014368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:14:05.006845 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m06:14:05.011872 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 06:14:04.993007 => 06:14:05.011745
[0m06:14:05.015760 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m06:14:05.016276 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 06:14:05.016200 => 06:14:05.016209
[0m06:14:05.011578 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m06:14:05.014980 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m06:14:05.016954 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m06:14:05.017380 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 06:14:05.000057 => 06:14:05.017273
[0m06:14:05.019265 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.017979 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.020179 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:05.020233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_launches, now test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1)
[0m06:14:05.020825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85872ba0>]}
[0m06:14:05.021020 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.021141 [debug] [MainThread]: On master: ROLLBACK
[0m06:14:05.021426 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:05.021612 [debug] [MainThread]: On master: BEGIN
[0m06:14:05.021957 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.022135 [debug] [MainThread]: On master: COMMIT
[0m06:14:05.022295 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:05.022450 [debug] [MainThread]: On master: COMMIT
[0m06:14:05.022642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:05.022791 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m06:14:05.022812 [debug] [MainThread]: On master: Close
[0m06:14:05.019732 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 06:14:05.010025 => 06:14:05.019670
[0m06:14:05.019554 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 06:14:05.012653 => 06:14:05.019466
[0m06:14:05.019904 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 06:14:05.019820 => 06:14:05.019837
[0m06:14:05.023282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:14:05.024404 [info ] [MainThread]: 
[0m06:14:05.024267 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.025327 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.023967 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 06:14:05.021278 => 06:14:05.023901
[0m06:14:05.023437 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m06:14:05.026492 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.023703 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.026950 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 06:14:05.026861 => 06:14:05.026866
[0m06:14:05.027119 [info ] [Thread-1 (]: 1 of 8 START test source_not_null_bronze_launches_data ......................... [RUN]
[0m06:14:05.026205 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.026834 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.026541 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 06:14:05.026461 => 06:14:05.026465
[0m06:14:05.026676 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.025935 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed)
[0m06:14:05.029142 [info ] [Thread-2 (]: 2 of 8 START test source_not_null_bronze_launches_id ........................... [RUN]
[0m06:14:05.029226 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.029513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb)
[0m06:14:05.031142 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.028456 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 06:14:05.028383 => 06:14:05.028386
[0m06:14:05.028972 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m06:14:05.027956 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.032307 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.032640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m06:14:05.031891 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.030956 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m06:14:05.032848 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.027348 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.033134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_starlink, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m06:14:05.031645 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.036594 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m06:14:05.036904 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.028242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae)
[0m06:14:05.038550 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.037121 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 06:14:05.029436 => 06:14:05.037049
[0m06:14:05.037348 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.039198 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m06:14:05.039498 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.040359 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 06:14:05.040295 => 06:14:05.040298
[0m06:14:05.038022 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m06:14:05.038208 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_bronze_starlink_data ......................... [RUN]
[0m06:14:05.040008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m06:14:05.028704 [info ] [Thread-3 (]: 3 of 8 START test source_not_null_bronze_rockets_id ............................ [RUN]
[0m06:14:05.040451 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m06:14:05.041869 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 06:14:05.031338 => 06:14:05.041793
[0m06:14:05.042087 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.039731 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 06:14:05.033809 => 06:14:05.039663
[0m06:14:05.042404 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.041118 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 06:14:05.037837 => 06:14:05.041059
[0m06:14:05.043852 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.044091 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 06:14:05.044032 => 06:14:05.044035
[0m06:14:05.043621 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 06:14:05.043543 => 06:14:05.043547
[0m06:14:05.044881 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.040817 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.044452 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.041708 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.041131 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed'
[0m06:14:05.048772 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.045133 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.047833 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m06:14:05.042386 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 06:14:05.038732 => 06:14:05.042272
[0m06:14:05.049651 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m06:14:05.041580 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1'
[0m06:14:05.051077 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.050132 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m06:14:05.050538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now model.spacex_analytics.starlink_constellation_status)
[0m06:14:05.052667 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m06:14:05.050291 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m06:14:05.052051 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 06:14:05.048134 => 06:14:05.051975
[0m06:14:05.050731 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.051742 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.048611 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m06:14:05.053234 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m06:14:05.054069 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m06:14:05.055222 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m06:14:05.054503 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.058154 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 06:14:05.058074 => 06:14:05.058078
[0m06:14:05.056964 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 06:14:05.048942 => 06:14:05.056877
[0m06:14:05.056760 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m06:14:05.059404 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 06:14:05.052820 => 06:14:05.059334
[0m06:14:05.059239 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.058835 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.059891 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m06:14:05.058953 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 06:14:05.051565 => 06:14:05.058568
[0m06:14:05.061313 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.061244 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 06:14:05.061169 => 06:14:05.061171
[0m06:14:05.059631 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m06:14:05.062536 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: BEGIN
[0m06:14:05.061075 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 06:14:05.055379 => 06:14:05.061002
[0m06:14:05.059092 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m06:14:05.062987 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: BEGIN
[0m06:14:05.062654 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m06:14:05.062905 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.060797 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m06:14:05.062734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:05.063681 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 06:14:05.063612 => 06:14:05.063615
[0m06:14:05.064376 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.062223 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m06:14:05.063232 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:14:05.064731 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m06:14:05.065879 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m06:14:05.065636 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: BEGIN
[0m06:14:05.066752 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:14:05.066727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e, now model.spacex_analytics.starlink_42k_projection)
[0m06:14:05.066618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.067538 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m06:14:05.067250 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m06:14:05.067235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.068643 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m06:14:05.069723 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."launches"
where id is null



      
    ) dbt_internal_test
[0m06:14:05.067091 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m06:14:05.070256 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: BEGIN
[0m06:14:05.071135 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m06:14:05.070027 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.068115 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."launches"
where data is null



      
    ) dbt_internal_test
[0m06:14:05.070558 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:14:05.071305 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.072671 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 06:14:05.068308 => 06:14:05.072588
[0m06:14:05.072924 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m06:14:05.073170 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 06:14:05.073105 => 06:14:05.073110
[0m06:14:05.073566 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m06:14:05.071441 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m06:14:05.074595 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."starlink"
where data is null



      
    ) dbt_internal_test
[0m06:14:05.074152 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 06:14:05.042517 => 06:14:05.074065
[0m06:14:05.075144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:05.075807 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m06:14:05.072542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.076115 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m06:14:05.076907 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m06:14:05.075396 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.077191 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m06:14:05.075673 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: ROLLBACK
[0m06:14:05.078062 [debug] [MainThread]: Command end result
[0m06:14:05.076780 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 06:14:05.054552 => 06:14:05.076703
[0m06:14:05.077068 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.077355 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m06:14:05.078306 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: Close
[0m06:14:05.080542 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: ROLLBACK
[0m06:14:05.081211 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 06:14:05.060114 => 06:14:05.081148
[0m06:14:05.081454 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."rockets"
where id is null



      
    ) dbt_internal_test
[0m06:14:05.082902 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: Close
[0m06:14:05.083093 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: ROLLBACK
[0m06:14:05.083631 [info ] [Thread-2 (]: 2 of 8 PASS source_not_null_bronze_launches_id ................................. [[32mPASS[0m in 0.05s]
[0m06:14:05.085291 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.084724 [info ] [Thread-1 (]: 1 of 8 PASS source_not_null_bronze_launches_data ............................... [[32mPASS[0m in 0.06s]
[0m06:14:05.085575 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: Close
[0m06:14:05.085810 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.088182 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.086900 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.087344 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_bronze_starlink_data ............................... [[32mPASS[0m in 0.05s]
[0m06:14:05.086530 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 06:14:05.061594 => 06:14:05.086449
[0m06:14:05.088692 [info ] [Thread-2 (]: 5 of 8 START test source_not_null_bronze_starlink_id ........................... [RUN]
[0m06:14:05.089199 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.089611 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.091055 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m06:14:05.091446 [info ] [MainThread]: Building catalog
[0m06:14:05.091307 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.090335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m06:14:05.092225 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.089848 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: ROLLBACK
[0m06:14:05.094317 [debug] [ThreadPool]: Acquiring new postgres connection 'spacex_db.information_schema'
[0m06:14:05.091940 [info ] [Thread-4 (]: 7 of 8 START test source_unique_bronze_rockets_id .............................. [RUN]
[0m06:14:05.090608 [info ] [Thread-1 (]: 6 of 8 START test source_unique_bronze_launches_id ............................. [RUN]
[0m06:14:05.096977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m06:14:05.097186 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.097164 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m06:14:05.097448 [debug] [ThreadPool]: On spacex_db.information_schema: BEGIN
[0m06:14:05.097625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:05.096670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m06:14:05.094027 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m06:14:05.094636 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: Close
[0m06:14:05.100881 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.099676 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m06:14:05.100392 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.101686 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m06:14:05.102156 [debug] [ThreadPool]: On spacex_db.information_schema: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "spacex_db.information_schema"} */

    
    

    select
        'spacex_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('gold_silver') or upper(sch.nspname) = upper('gold_gold') or upper(sch.nspname) = upper('bronze'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m06:14:05.101273 [info ] [Thread-3 (]: 3 of 8 PASS source_not_null_bronze_rockets_id .................................. [[32mPASS[0m in 0.06s]
[0m06:14:05.103450 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m06:14:05.104243 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 06:14:05.092399 => 06:14:05.104170
[0m06:14:05.104657 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.109073 [debug] [ThreadPool]: SQL status: SELECT 124 in 0.0 seconds
[0m06:14:05.106152 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 06:14:05.097357 => 06:14:05.106048
[0m06:14:05.110201 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.109253 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.110019 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 06:14:05.102027 => 06:14:05.109885
[0m06:14:05.108847 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.114172 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m06:14:05.114420 [debug] [ThreadPool]: On spacex_db.information_schema: ROLLBACK
[0m06:14:05.112876 [info ] [Thread-3 (]: 8 of 8 START test source_unique_bronze_starlink_id ............................. [RUN]
[0m06:14:05.115184 [debug] [ThreadPool]: On spacex_db.information_schema: Close
[0m06:14:05.113358 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.112420 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m06:14:05.114999 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m06:14:05.117643 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m06:14:05.118109 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m06:14:05.118288 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.118946 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: BEGIN
[0m06:14:05.119277 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m06:14:05.120922 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m06:14:05.121455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:14:05.121676 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m06:14:05.123553 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: BEGIN
[0m06:14:05.122875 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: BEGIN
[0m06:14:05.124237 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:14:05.124918 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 06:14:05.119378 => 06:14:05.124685
[0m06:14:05.125576 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.126490 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/target/catalog.json
[0m06:14:05.126902 [debug] [MainThread]: Command `dbt docs generate` succeeded at 06:14:05.126853 after 0.26 seconds
[0m06:14:05.127123 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m06:14:05.127304 [debug] [MainThread]: Connection 'spacex_db.information_schema' was properly closed.
[0m06:14:05.127512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba9ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c10eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c10f740>]}
[0m06:14:05.127800 [debug] [MainThread]: Flushing usage events
[0m06:14:05.125114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:05.128001 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m06:14:05.128248 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.128756 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m06:14:05.129398 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."starlink"
where id is null



      
    ) dbt_internal_test
[0m06:14:05.129817 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.130348 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m06:14:05.130100 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m06:14:05.130725 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.130581 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."rockets"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:14:05.130871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.131013 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: BEGIN
[0m06:14:05.133930 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:14:05.133705 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m06:14:05.133566 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.132657 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 06:14:05.113564 => 06:14:05.132576
[0m06:14:05.135407 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: ROLLBACK
[0m06:14:05.135125 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 06:14:05.116674 => 06:14:05.135047
[0m06:14:05.134330 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."launches"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:14:05.135877 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: Close
[0m06:14:05.135713 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: ROLLBACK
[0m06:14:05.136387 [info ] [Thread-2 (]: 5 of 8 PASS source_not_null_bronze_starlink_id ................................. [[32mPASS[0m in 0.05s]
[0m06:14:05.136865 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.136625 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: Close
[0m06:14:05.138026 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.137859 [info ] [Thread-4 (]: 7 of 8 PASS source_unique_bronze_rockets_id .................................... [[32mPASS[0m in 0.04s]
[0m06:14:05.140084 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.139816 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.140602 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m06:14:05.139056 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 06:14:05.111576 => 06:14:05.138984
[0m06:14:05.141043 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."starlink"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:14:05.141315 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: ROLLBACK
[0m06:14:05.141830 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: Close
[0m06:14:05.142286 [info ] [Thread-1 (]: 6 of 8 PASS source_unique_bronze_launches_id ................................... [[32mPASS[0m in 0.05s]
[0m06:14:05.142581 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.144094 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.149585 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 06:14:05.126136 => 06:14:05.149461
[0m06:14:05.149886 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: ROLLBACK
[0m06:14:05.150320 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: Close
[0m06:14:05.150729 [info ] [Thread-3 (]: 8 of 8 PASS source_unique_bronze_starlink_id ................................... [[32mPASS[0m in 0.04s]
[0m06:14:05.151685 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.153117 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:05.153325 [debug] [MainThread]: On master: BEGIN
[0m06:14:05.153755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:14:05.155215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.155418 [debug] [MainThread]: On master: COMMIT
[0m06:14:05.155596 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:05.155754 [debug] [MainThread]: On master: COMMIT
[0m06:14:05.155955 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:05.156119 [debug] [MainThread]: On master: Close
[0m06:14:05.156411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:05.156724 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e' was properly closed.
[0m06:14:05.156918 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8' was properly closed.
[0m06:14:05.157095 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m06:14:05.157253 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m06:14:05.157436 [info ] [MainThread]: 
[0m06:14:05.157656 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m06:14:05.158223 [debug] [MainThread]: Command end result
[0m06:14:05.162265 [info ] [MainThread]: 
[0m06:14:05.162531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:14:05.162737 [info ] [MainThread]: 
[0m06:14:05.162943 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m06:14:05.163211 [debug] [MainThread]: Command `dbt test` succeeded at 06:14:05.163173 after 0.27 seconds
[0m06:14:05.163436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8676dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8676d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8639bad0>]}
[0m06:14:05.163659 [debug] [MainThread]: Flushing usage events
[0m06:14:06.026217 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m06:14:06.026581 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m06:14:07.210539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec78800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed99ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec79ac0>]}


============================== 06:14:07.212777 | 706afecb-61b3-4673-a134-67b62676d6b8 ==============================
[0m06:14:07.212777 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:14:07.213254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation log_results --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:14:07.251915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '706afecb-61b3-4673-a134-67b62676d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1cb8f0>]}
[0m06:14:07.257946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '706afecb-61b3-4673-a134-67b62676d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f128ef0>]}
[0m06:14:07.258528 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m06:14:07.262752 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:14:07.277394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:14:07.277802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:14:07.280256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '706afecb-61b3-4673-a134-67b62676d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1ea810>]}
[0m06:14:07.285704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '706afecb-61b3-4673-a134-67b62676d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2451c0>]}
[0m06:14:07.286001 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m06:14:07.286292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '706afecb-61b3-4673-a134-67b62676d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edfee40>]}
[0m06:14:07.286755 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_results'
[0m06:14:07.286985 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m06:14:07.287147 [debug] [MainThread]: On macro_log_results: BEGIN
[0m06:14:07.287297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:07.289340 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:07.289638 [debug] [MainThread]: On macro_log_results: COMMIT
[0m06:14:07.289849 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m06:14:07.290051 [debug] [MainThread]: On macro_log_results: COMMIT
[0m06:14:07.290267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:07.295460 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m06:14:07.295810 [debug] [MainThread]: On macro_log_results: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "macro_log_results"} */

    
    SELECT 
      "🎯 ANSWER: Launches Needed" as launches_needed,
      "🎯 ANSWER: Months to 42K" as months_needed,
      "🎯 ANSWER: Est. Completion Date" as completion_date,
      "CONFIDENCE: Projection Reliability" as confidence
    FROM gold.starlink_42k_projection
    LIMIT 1
  
  
[0m06:14:07.296312 [debug] [MainThread]: Postgres adapter: Postgres error: relation "gold.starlink_42k_projection" does not exist
LINE 9:     FROM gold.starlink_42k_projection
                 ^

[0m06:14:07.296779 [debug] [MainThread]: Postgres adapter: Error running SQL: macro log_results
[0m06:14:07.297001 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m06:14:07.297207 [debug] [MainThread]: On macro_log_results: Close
[0m06:14:07.297564 [error] [MainThread]: Encountered an error while running operation: Database Error
  relation "gold.starlink_42k_projection" does not exist
  LINE 9:     FROM gold.starlink_42k_projection
                   ^
[0m06:14:07.299886 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 73, in exception_handler
    yield
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "gold.starlink_42k_projection" does not exist
LINE 9:     FROM gold.starlink_42k_projection
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1054, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 290, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 146, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 84, in exception_handler
    raise dbt.exceptions.DbtDatabaseError(str(e).strip()) from e
dbt.exceptions.DbtDatabaseError: Database Error
  relation "gold.starlink_42k_projection" does not exist
  LINE 9:     FROM gold.starlink_42k_projection
                   ^

[0m06:14:07.301036 [debug] [MainThread]: Command `dbt run-operation` failed at 06:14:07.300991 after 0.10 seconds
[0m06:14:07.301260 [debug] [MainThread]: Connection 'macro_log_results' was properly closed.
[0m06:14:07.301476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0b72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0b7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0b6f60>]}
[0m06:14:07.301702 [debug] [MainThread]: Flushing usage events
[0m06:14:08.157689 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:50:35.373329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d27c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbafe21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d24d70>]}


============================== 11:50:35.374924 | bec08a15-c06d-47a9-9ea8-2b6236e90e24 ==============================
[0m11:50:35.374924 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:50:35.375263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:35.382108 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('schema-paths' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m11:50:35.382436 [debug] [MainThread]: Command `dbt deps` failed at 11:50:35.382394 after 0.01 seconds
[0m11:50:35.382679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1092b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d27c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d25ac0>]}
[0m11:50:35.382920 [debug] [MainThread]: Flushing usage events
[0m11:55:29.161632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88636a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887ff740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8800a630>]}


============================== 11:55:29.163136 | ad754ad7-bdb8-43fd-9d19-902b9631a6f5 ==============================
[0m11:55:29.163136 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:55:29.163478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:29.180051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad754ad7-bdb8-43fd-9d19-902b9631a6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8815aff0>]}
[0m11:55:29.180517 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:55:29.180884 [debug] [MainThread]: Command `dbt deps` succeeded at 11:55:29.180827 after 0.02 seconds
[0m11:55:29.181123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88508170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88636a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8846f6e0>]}
[0m11:55:29.181355 [debug] [MainThread]: Flushing usage events
[0m11:55:31.798688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a54c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b37c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f7a0c0>]}


============================== 11:55:31.800203 | 73ec1bd9-0450-41ef-8ce1-77101511a843 ==============================
[0m11:55:31.800203 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:55:31.800559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models silver --profiles-dir .', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:31.836054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73ec1bd9-0450-41ef-8ce1-77101511a843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f7a8a0>]}
[0m11:55:31.841271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73ec1bd9-0450-41ef-8ce1-77101511a843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a57890>]}
[0m11:55:31.841661 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m11:55:31.845406 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:55:31.849644 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:55:31.849955 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:55:31.850205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73ec1bd9-0450-41ef-8ce1-77101511a843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e809b0>]}
[0m11:55:32.094794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73ec1bd9-0450-41ef-8ce1-77101511a843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f5c5f0>]}
[0m11:55:32.101312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73ec1bd9-0450-41ef-8ce1-77101511a843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ff0650>]}
[0m11:55:32.101619 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m11:55:32.102041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73ec1bd9-0450-41ef-8ce1-77101511a843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e7ce30>]}
[0m11:55:32.102779 [info ] [MainThread]: 
[0m11:55:32.103233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:55:32.103794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m11:55:32.107318 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m11:55:32.107529 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m11:55:32.107703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:32.109660 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:55:32.110229 [debug] [ThreadPool]: On list_spacex_db: Close
[0m11:55:32.110841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_silver)
[0m11:55:32.111142 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m11:55:32.113272 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m11:55:32.114114 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m11:55:32.114361 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m11:55:32.114563 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m11:55:32.114739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:32.114999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:32.117243 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:32.117747 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:32.118130 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m11:55:32.117886 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m11:55:32.118673 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m11:55:32.118389 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m11:55:32.120822 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:55:32.120952 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:55:32.122092 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m11:55:32.121492 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m11:55:32.122418 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m11:55:32.122573 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m11:55:32.124843 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:32.125100 [debug] [MainThread]: On master: BEGIN
[0m11:55:32.125299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:32.126584 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:32.126814 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:32.127080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:55:32.130009 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:55:32.130532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73ec1bd9-0450-41ef-8ce1-77101511a843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ff1310>]}
[0m11:55:32.130812 [debug] [MainThread]: On master: ROLLBACK
[0m11:55:32.131084 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:32.131293 [debug] [MainThread]: On master: BEGIN
[0m11:55:32.131567 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:32.131821 [debug] [MainThread]: On master: COMMIT
[0m11:55:32.132059 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:32.132261 [debug] [MainThread]: On master: COMMIT
[0m11:55:32.132495 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:32.132691 [debug] [MainThread]: On master: Close
[0m11:55:32.133040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:32.133260 [info ] [MainThread]: 
[0m11:55:32.134397 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m11:55:32.134554 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m11:55:32.134768 [info ] [Thread-1 (]: 1 of 2 START sql view model silver.silver_launches ............................. [RUN]
[0m11:55:32.135070 [info ] [Thread-2 (]: 2 of 2 START sql view model silver.silver_starlink ............................. [RUN]
[0m11:55:32.135492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_launches)
[0m11:55:32.135844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_starlink)
[0m11:55:32.136139 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m11:55:32.136394 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m11:55:32.139337 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m11:55:32.140805 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m11:55:32.143115 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 11:55:32.139595 => 11:55:32.143035
[0m11:55:32.143372 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m11:55:32.143565 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 11:55:32.136632 => 11:55:32.143488
[0m11:55:32.155090 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.silver_starlink"
[0m11:55:32.155256 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m11:55:32.156758 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.silver_launches"
[0m11:55:32.157948 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m11:55:32.158182 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: BEGIN
[0m11:55:32.158344 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m11:55:32.158474 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:55:32.158727 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: BEGIN
[0m11:55:32.159426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:32.160650 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:32.160805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:32.160986 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m11:55:32.161233 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m11:55:32.161532 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

  create view "spacex_db"."silver"."silver_starlink__dbt_tmp"
    
    
  as (
    

WITH parsed_starlink AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as satellite_id,
        data->'spaceTrack'->>'OBJECT_NAME' as satellite_name,
        data->>'launch' as launch_id,
        
        -- Launch and creation dates
        CASE 
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'LAUNCH_DATE')::date 
            ELSE NULL 
        END as launch_date,
        
        CASE 
            WHEN data->'spaceTrack'->>'CREATION_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'CREATION_DATE')::timestamp 
            ELSE NULL 
        END as tracking_creation_date,
        
        -- Satellite status determination (multiple fallback methods)
        CASE 
            -- Primary: DECAYED field
            WHEN data->'spaceTrack'->>'DECAYED' = '0' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'false' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'False' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = '1' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'true' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'True' THEN false
            -- Fallback: DECAY_DATE field
            WHEN data->'spaceTrack'->>'DECAY_DATE' IS NULL OR data->'spaceTrack'->>'DECAY_DATE' = '' THEN true
            ELSE false
        END as is_active,
        
        -- Orbital parameters (parsed to numeric types)
        CASE 
            WHEN data->'spaceTrack'->>'INCLINATION' IS NOT NULL 
            THEN (data->'spaceTrack'->>'INCLINATION')::numeric 
            ELSE NULL 
        END as inclination_deg,
        
        CASE 
            WHEN data->'spaceTrack'->>'SEMIMAJOR_AXIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'SEMIMAJOR_AXIS')::numeric 
            ELSE NULL 
        END as semimajor_axis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIOD' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIOD')::numeric 
            ELSE NULL 
        END as orbital_period_min,
        
        CASE 
            WHEN data->'spaceTrack'->>'APOAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'APOAPSIS')::numeric 
            ELSE NULL 
        END as apoapsis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIAPSIS')::numeric 
            ELSE NULL 
        END as periapsis_km,
        
        -- Current position data (if available)
        CASE 
            WHEN data->>'longitude' IS NOT NULL 
            THEN (data->>'longitude')::numeric 
            ELSE NULL 
        END as longitude,
        
        CASE 
            WHEN data->>'latitude' IS NOT NULL 
            THEN (data->>'latitude')::numeric 
            ELSE NULL 
        END as latitude,
        
        CASE 
            WHEN data->>'height_km' IS NOT NULL 
            THEN (data->>'height_km')::numeric 
            ELSE NULL 
        END as altitude_km,
        
        CASE 
            WHEN data->>'velocity_kms' IS NOT NULL 
            THEN (data->>'velocity_kms')::numeric 
            ELSE NULL 
        END as velocity_kms,
        
        -- Tracking information
        data->'spaceTrack'->>'NORAD_CAT_ID' as norad_catalog_id,
        data->'spaceTrack'->>'OBJECT_ID' as object_id,
        data->'spaceTrack'->>'DECAY_DATE' as decay_date_raw,
        
        -- Data quality assessment
        CASE 
            WHEN data->'spaceTrack'->>'OBJECT_NAME' IS NULL THEN 'missing_satellite_name'
            WHEN data->>'launch' IS NULL THEN 'missing_launch_reference'
            WHEN data->'spaceTrack'->>'DECAYED' IS NULL AND data->'spaceTrack'->>'DECAY_DATE' IS NULL THEN 'missing_status_info'
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NULL THEN 'missing_launch_date'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."starlink"
    WHERE data IS NOT NULL
)

SELECT 
    satellite_id,
    satellite_name,
    launch_id,
    launch_date,
    tracking_creation_date,
    is_active,
    inclination_deg,
    semimajor_axis_km,
    orbital_period_min,
    apoapsis_km,
    periapsis_km,
    longitude,
    latitude,
    altitude_km,
    velocity_kms,
    norad_catalog_id,
    object_id,
    decay_date_raw,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    CASE 
        WHEN semimajor_axis_km IS NOT NULL 
        THEN semimajor_axis_km - 6371.0  -- Convert to altitude above Earth's surface
        ELSE NULL 
    END as calculated_altitude_km,
    
    -- Orbital regime classification
    CASE 
        WHEN semimajor_axis_km - 6371.0 BETWEEN 160 AND 2000 THEN 'Low Earth Orbit (LEO)'
        WHEN semimajor_axis_km - 6371.0 BETWEEN 2000 AND 35786 THEN 'Medium Earth Orbit (MEO)'
        WHEN semimajor_axis_km - 6371.0 > 35786 THEN 'Geostationary Orbit (GEO)'
        ELSE 'Unknown'
    END as orbital_regime,
    
    -- Age calculation
    CASE 
        WHEN launch_date IS NOT NULL 
        THEN CURRENT_DATE - launch_date 
        ELSE NULL 
    END as satellite_age_days

FROM parsed_starlink
WHERE satellite_id IS NOT NULL

-- Add model documentation

  );
[0m11:55:32.161905 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

  create view "spacex_db"."silver"."silver_launches__dbt_tmp"
    
    
  as (
    

WITH parsed_launches AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as launch_id,
        data->>'name' as mission_name,
        
        -- Date and time parsing
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp 
            ELSE NULL 
        END as launch_date_utc,
        
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp::date 
            ELSE NULL 
        END as launch_date,
        
        -- Launch outcome
        CASE 
            WHEN (data->'success')::text = 'true' THEN true
            WHEN (data->'success')::text = 'false' THEN false
            ELSE NULL
        END as launch_success,
        
        CASE 
            WHEN (data->'upcoming')::text = 'true' THEN true
            WHEN (data->'upcoming')::text = 'false' THEN false
            ELSE NULL
        END as is_upcoming,
        
        -- Technical details
        data->>'rocket' as rocket_id,
        
        CASE 
            WHEN data->>'flight_number' IS NOT NULL 
            THEN (data->>'flight_number')::integer 
            ELSE NULL 
        END as flight_number,
        
        data->>'launchpad' as launchpad_id,
        data->>'details' as mission_details,
        
        -- Business logic: Starlink mission identification
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN true
            WHEN LOWER(data->>'name') LIKE '%starship%' AND LOWER(data->>'name') LIKE '%starlink%' THEN true
            ELSE false
        END as is_starlink_mission,
        
        -- Satellite count estimation for Starlink missions
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN
                CASE 
                    -- Early test missions
                    WHEN LOWER(data->>'name') LIKE '%demo%' 
                      OR LOWER(data->>'name') LIKE '%test%' 
                      OR data->>'name' ILIKE '%tintin%' THEN 2
                    -- V1.0 missions (60 satellites each)
                    WHEN data->>'name' ILIKE '%v1.0%' THEN 60
                    -- V2 missions (larger satellites, fewer per launch)
                    WHEN data->>'name' ILIKE '%v2%' THEN 23
                    -- Standard production batches
                    ELSE 60
                END
            ELSE 0
        END as estimated_satellite_count,
        
        -- Payload analysis
        CASE 
            WHEN data->'payloads' IS NOT NULL 
            THEN jsonb_array_length(data->'payloads') 
            ELSE 0 
        END as payload_count,
        
        -- Data quality assessment
        CASE 
            WHEN data->>'date_utc' IS NULL THEN 'missing_launch_date'
            WHEN data->>'name' IS NULL THEN 'missing_mission_name'
            WHEN (data->'success') IS NULL AND (data->'upcoming')::text = 'false' THEN 'missing_success_status'
            WHEN data->>'rocket' IS NULL THEN 'missing_rocket_info'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."launches"
    WHERE data IS NOT NULL
)

SELECT 
    launch_id,
    mission_name,
    launch_date_utc,
    launch_date,
    launch_success,
    is_upcoming,
    rocket_id,
    flight_number,
    launchpad_id,
    mission_details,
    is_starlink_mission,
    estimated_satellite_count,
    payload_count,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    EXTRACT(YEAR FROM launch_date_utc) as launch_year,
    EXTRACT(MONTH FROM launch_date_utc) as launch_month,
    EXTRACT(DOW FROM launch_date_utc) as launch_day_of_week,
    
    -- Mission type classification
    CASE 
        WHEN is_starlink_mission THEN 'Starlink'
        WHEN LOWER(mission_name) LIKE '%crew%' THEN 'Crew'
        WHEN LOWER(mission_name) LIKE '%cargo%' OR LOWER(mission_name) LIKE '%crs%' THEN 'Cargo'
        WHEN LOWER(mission_name) LIKE '%satellite%' THEN 'Commercial Satellite'
        ELSE 'Other'
    END as mission_type

FROM parsed_launches
WHERE launch_id IS NOT NULL

-- Add model documentation

  );
[0m11:55:32.165145 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:55:32.165280 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:55:32.168512 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m11:55:32.167494 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m11:55:32.168989 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
alter table "spacex_db"."silver"."silver_starlink__dbt_tmp" rename to "silver_starlink"
[0m11:55:32.168746 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
alter table "spacex_db"."silver"."silver_launches__dbt_tmp" rename to "silver_launches"
[0m11:55:32.169476 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:32.174730 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m11:55:32.174900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:32.175095 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

        COMMENT ON VIEW "spacex_db"."silver"."silver_starlink" IS 'Cleaned Starlink satellite data with active status determination and orbital parameters'
      
[0m11:55:32.176047 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m11:55:32.176479 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

        COMMENT ON VIEW "spacex_db"."silver"."silver_launches" IS 'Cleaned launch data with Starlink mission identification and satellite count estimation'
      
[0m11:55:32.176657 [debug] [Thread-2 (]: SQL status: COMMENT in 0.0 seconds
[0m11:55:32.176897 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m11:55:32.177244 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m11:55:32.177668 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m11:55:32.177947 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m11:55:32.178206 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m11:55:32.178483 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m11:55:32.178735 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m11:55:32.179488 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:32.179631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:32.182242 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m11:55:32.183729 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m11:55:32.183995 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
drop view if exists "spacex_db"."silver"."silver_starlink__dbt_backup" cascade
[0m11:55:32.184218 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
drop view if exists "spacex_db"."silver"."silver_launches__dbt_backup" cascade
[0m11:55:32.184511 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:55:32.184685 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:55:32.185215 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 11:55:32.143665 => 11:55:32.185155
[0m11:55:32.185750 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 11:55:32.155600 => 11:55:32.185696
[0m11:55:32.185989 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: Close
[0m11:55:32.186188 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: Close
[0m11:55:32.186612 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73ec1bd9-0450-41ef-8ce1-77101511a843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a1f620>]}
[0m11:55:32.187680 [info ] [Thread-2 (]: 2 of 2 OK created sql view model silver.silver_starlink ........................ [[32mCREATE VIEW[0m in 0.05s]
[0m11:55:32.187802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73ec1bd9-0450-41ef-8ce1-77101511a843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a1f620>]}
[0m11:55:32.188269 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m11:55:32.188547 [info ] [Thread-1 (]: 1 of 2 OK created sql view model silver.silver_launches ........................ [[32mCREATE VIEW[0m in 0.05s]
[0m11:55:32.189087 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m11:55:32.190607 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:32.190812 [debug] [MainThread]: On master: BEGIN
[0m11:55:32.191009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:32.192227 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:32.192429 [debug] [MainThread]: On master: COMMIT
[0m11:55:32.192607 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:32.192779 [debug] [MainThread]: On master: COMMIT
[0m11:55:32.192992 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:32.193237 [debug] [MainThread]: On master: Close
[0m11:55:32.193536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:32.193976 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_launches' was properly closed.
[0m11:55:32.194168 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_starlink' was properly closed.
[0m11:55:32.194373 [info ] [MainThread]: 
[0m11:55:32.194632 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m11:55:32.195049 [debug] [MainThread]: Command end result
[0m11:55:32.198974 [info ] [MainThread]: 
[0m11:55:32.199234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:32.199479 [info ] [MainThread]: 
[0m11:55:32.199733 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:55:32.200033 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:32.199993 after 0.41 seconds
[0m11:55:32.200285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3dbfbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb55d61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb47e7380>]}
[0m11:55:32.200525 [debug] [MainThread]: Flushing usage events
[0m11:55:34.954604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c0b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c0a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c092b0>]}


============================== 11:55:34.956142 | b48224a0-0e76-4d99-b59a-a30297877a6d ==============================
[0m11:55:34.956142 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:55:34.956497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:55:34.993852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b48224a0-0e76-4d99-b59a-a30297877a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821cd100>]}
[0m11:55:34.999261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b48224a0-0e76-4d99-b59a-a30297877a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82035b20>]}
[0m11:55:34.999676 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m11:55:35.003799 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:55:35.021012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:35.021295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:35.023471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b48224a0-0e76-4d99-b59a-a30297877a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c2c5f0>]}
[0m11:55:35.029190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b48224a0-0e76-4d99-b59a-a30297877a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811c2750>]}
[0m11:55:35.029441 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m11:55:35.029749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b48224a0-0e76-4d99-b59a-a30297877a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811c2510>]}
[0m11:55:35.030439 [info ] [MainThread]: 
[0m11:55:35.030819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:55:35.031397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m11:55:35.035026 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m11:55:35.035231 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m11:55:35.035406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:35.037339 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:55:35.037971 [debug] [ThreadPool]: On list_spacex_db: Close
[0m11:55:35.039053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_silver)
[0m11:55:35.039354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m11:55:35.041376 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m11:55:35.042178 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m11:55:35.042393 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m11:55:35.042603 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m11:55:35.042792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:35.043007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:35.044287 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:35.044421 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:35.044588 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m11:55:35.044830 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m11:55:35.045128 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m11:55:35.045404 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m11:55:35.046603 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:55:35.046728 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:55:35.047192 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m11:55:35.047740 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m11:55:35.048016 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m11:55:35.048216 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m11:55:35.050705 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:35.050970 [debug] [MainThread]: On master: BEGIN
[0m11:55:35.051201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:35.052432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:35.052672 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:35.052925 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:55:35.056180 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:55:35.056804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b48224a0-0e76-4d99-b59a-a30297877a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820b92e0>]}
[0m11:55:35.057148 [debug] [MainThread]: On master: ROLLBACK
[0m11:55:35.057453 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:35.057686 [debug] [MainThread]: On master: BEGIN
[0m11:55:35.058043 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:35.058277 [debug] [MainThread]: On master: COMMIT
[0m11:55:35.058517 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:35.058742 [debug] [MainThread]: On master: COMMIT
[0m11:55:35.059036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:35.059262 [debug] [MainThread]: On master: Close
[0m11:55:35.059647 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:35.060179 [info ] [MainThread]: 
[0m11:55:35.061513 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m11:55:35.061824 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m11:55:35.062222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_constellation_status)
[0m11:55:35.062472 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m11:55:35.065479 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m11:55:35.066813 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 11:55:35.062685 => 11:55:35.066737
[0m11:55:35.067087 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m11:55:35.080377 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m11:55:35.082080 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m11:55:35.082332 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m11:55:35.082571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:35.084068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:35.084291 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m11:55:35.084584 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m11:55:35.097073 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:55:35.099370 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m11:55:35.099659 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m11:55:35.100104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:35.106326 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m11:55:35.106628 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m11:55:35.106901 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m11:55:35.107431 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:35.110127 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m11:55:35.110387 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m11:55:35.110713 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:55:35.111317 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 11:55:35.067297 => 11:55:35.111254
[0m11:55:35.111555 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m11:55:35.111939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48224a0-0e76-4d99-b59a-a30297877a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810ef740>]}
[0m11:55:35.112968 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.05s]
[0m11:55:35.113412 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m11:55:35.114607 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m11:55:35.114892 [info ] [Thread-3 (]: 2 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m11:55:35.115283 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m11:55:35.115502 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m11:55:35.117325 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m11:55:35.118455 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 11:55:35.115662 => 11:55:35.118381
[0m11:55:35.118687 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m11:55:35.120062 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m11:55:35.120949 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m11:55:35.121169 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m11:55:35.121364 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:55:35.122804 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:35.123016 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m11:55:35.123355 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        CASE 
            WHEN COUNT(CASE WHEN launch_success THEN 1 END) > 0 THEN
                (SELECT current_active_satellites FROM current_status) / COUNT(CASE WHEN launch_success THEN 1 END)
            ELSE NULL
        END as actual_satellites_per_successful_launch

    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CASE 
            WHEN GREATEST(COALESCE(e.actual_satellites_per_successful_launch, 0), COALESCE(e.avg_estimated_per_launch, 0)) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch))
            ELSE NULL
        END as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CASE 
            WHEN GREATEST(COALESCE(e.actual_satellites_per_successful_launch, 0), 50) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50))
            ELSE NULL
        END as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING((42000 - s.current_active_satellites) / 70.0) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 AND GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 AND GREATEST(e.actual_satellites_per_successful_launch, 50) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count)::numeric, 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch::numeric, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month::numeric, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year::numeric, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate::numeric, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed::numeric, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed::numeric, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    CASE 
        WHEN GREATEST(COALESCE(recent_6mo_monthly_rate, 0), COALESCE(avg_launches_per_month, 0)) > 0 AND optimistic_launches_needed > 0 THEN
            ROUND((optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month))::numeric, 1)
        ELSE NULL
    END as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(COALESCE(actual_satellites_per_successful_launch, 0)::numeric, 1) as "METRIC: Actual Sats per Success Launch",
    CASE 
        WHEN recent_successful_launches > 0 THEN
            ROUND((recent_total_launches::numeric / recent_successful_launches)::numeric, 2)
        ELSE NULL
    END as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m11:55:35.128611 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:55:35.129771 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m11:55:35.129975 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp" rename to "starlink_42k_projection"
[0m11:55:35.130253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:35.131070 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m11:55:35.131274 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

        COMMENT ON TABLE "spacex_db"."gold"."starlink_42k_projection" IS 'Business intelligence table answering: When will SpaceX reach 42,000 Starlink satellites and how many launches will it take?'
      
[0m11:55:35.131525 [debug] [Thread-3 (]: SQL status: COMMENT in 0.0 seconds
[0m11:55:35.132047 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m11:55:35.132240 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m11:55:35.132396 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m11:55:35.132745 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:35.133607 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m11:55:35.133810 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
drop table if exists "spacex_db"."gold"."starlink_42k_projection__dbt_backup" cascade
[0m11:55:35.134072 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:55:35.134583 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 11:55:35.118862 => 11:55:35.134527
[0m11:55:35.134778 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m11:55:35.135163 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b48224a0-0e76-4d99-b59a-a30297877a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff796c8170>]}
[0m11:55:35.135449 [info ] [Thread-3 (]: 2 of 2 OK created sql table model gold.starlink_42k_projection ................. [[32mSELECT 1[0m in 0.02s]
[0m11:55:35.135929 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m11:55:35.137299 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:35.137522 [debug] [MainThread]: On master: BEGIN
[0m11:55:35.137711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:35.138904 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:35.139111 [debug] [MainThread]: On master: COMMIT
[0m11:55:35.139288 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:35.139437 [debug] [MainThread]: On master: COMMIT
[0m11:55:35.139631 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:35.139790 [debug] [MainThread]: On master: Close
[0m11:55:35.140104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:35.140280 [debug] [MainThread]: Connection 'list_spacex_db_silver' was properly closed.
[0m11:55:35.140443 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m11:55:35.140609 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m11:55:35.140804 [info ] [MainThread]: 
[0m11:55:35.141017 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m11:55:35.141353 [debug] [MainThread]: Command end result
[0m11:55:35.144998 [info ] [MainThread]: 
[0m11:55:35.145222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:35.145407 [info ] [MainThread]: 
[0m11:55:35.145601 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:55:35.145849 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:35.145815 after 0.20 seconds
[0m11:55:35.146069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fa9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821cc530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ec1a00>]}
[0m11:55:35.146268 [debug] [MainThread]: Flushing usage events
[0m11:55:38.371377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e9b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8924ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893a2120>]}
[0m11:55:38.372779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a87b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ac68770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a879c40>]}


============================== 11:55:38.374262 | b7127fb2-158b-436f-93a8-3cd702281860 ==============================
[0m11:55:38.374262 [info ] [MainThread]: Running with dbt=1.6.0


============================== 11:55:38.374436 | 1904c37b-7630-4a85-989d-1aed1ae23ff2 ==============================
[0m11:55:38.374436 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:55:38.374934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:55:38.375058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:38.419765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7127fb2-158b-436f-93a8-3cd702281860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f33590>]}
[0m11:55:38.419765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1904c37b-7630-4a85-989d-1aed1ae23ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ad189e0>]}
[0m11:55:38.425285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7127fb2-158b-436f-93a8-3cd702281860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8841fb90>]}
[0m11:55:38.425667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1904c37b-7630-4a85-989d-1aed1ae23ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79dffb90>]}
[0m11:55:38.425706 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m11:55:38.426056 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m11:55:38.430567 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:55:38.430602 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:55:38.450787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:38.451097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:38.452255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:38.452569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:38.453461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1904c37b-7630-4a85-989d-1aed1ae23ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9129f0>]}
[0m11:55:38.454865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7127fb2-158b-436f-93a8-3cd702281860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8843aa50>]}
[0m11:55:38.457804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7127fb2-158b-436f-93a8-3cd702281860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88466990>]}
[0m11:55:38.458444 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m11:55:38.458674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7127fb2-158b-436f-93a8-3cd702281860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893381a0>]}
[0m11:55:38.459379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1904c37b-7630-4a85-989d-1aed1ae23ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e45d30>]}
[0m11:55:38.459642 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m11:55:38.459780 [info ] [MainThread]: 
[0m11:55:38.459992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1904c37b-7630-4a85-989d-1aed1ae23ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7afd05c0>]}
[0m11:55:38.460318 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:55:38.460961 [info ] [MainThread]: 
[0m11:55:38.461449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:55:38.461515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m11:55:38.463229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m11:55:38.461927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m11:55:38.467193 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m11:55:38.467510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m11:55:38.465803 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m11:55:38.468143 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m11:55:38.468401 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m11:55:38.468613 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m11:55:38.467768 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m11:55:38.468824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:38.469031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:38.468985 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m11:55:38.469221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:38.469717 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m11:55:38.470667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:38.471690 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.471921 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m11:55:38.472043 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.472312 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m11:55:38.472505 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.472988 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m11:55:38.472545 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m11:55:38.473356 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m11:55:38.473507 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m11:55:38.473190 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.473947 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m11:55:38.473978 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:55:38.474839 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m11:55:38.474722 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:55:38.475614 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m11:55:38.476166 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m11:55:38.476316 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:55:38.476497 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:55:38.476574 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m11:55:38.477080 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m11:55:38.476727 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m11:55:38.477714 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m11:55:38.478714 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m11:55:38.479642 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m11:55:38.482338 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:38.482975 [debug] [MainThread]: On master: BEGIN
[0m11:55:38.483236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:38.484002 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:38.484264 [debug] [MainThread]: On master: BEGIN
[0m11:55:38.484492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:38.484692 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.484971 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:38.485257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:55:38.485939 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.486166 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:38.486416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:55:38.489485 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:55:38.490345 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:55:38.490786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7127fb2-158b-436f-93a8-3cd702281860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883f7c50>]}
[0m11:55:38.491011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1904c37b-7630-4a85-989d-1aed1ae23ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e99f10>]}
[0m11:55:38.491250 [debug] [MainThread]: On master: ROLLBACK
[0m11:55:38.491435 [debug] [MainThread]: On master: ROLLBACK
[0m11:55:38.491547 [debug] [MainThread]: On master: Close
[0m11:55:38.491751 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:38.492102 [debug] [MainThread]: On master: BEGIN
[0m11:55:38.492510 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.492740 [debug] [MainThread]: On master: COMMIT
[0m11:55:38.492958 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:38.493173 [debug] [MainThread]: On master: COMMIT
[0m11:55:38.492158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:38.493413 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:38.493607 [info ] [MainThread]: 
[0m11:55:38.493735 [debug] [MainThread]: On master: Close
[0m11:55:38.494882 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:38.495280 [info ] [MainThread]: 
[0m11:55:38.494975 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m11:55:38.495124 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m11:55:38.496285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_starlink)
[0m11:55:38.496592 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m11:55:38.497015 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m11:55:38.497594 [info ] [Thread-1 (]: 1 of 8 START test source_not_null_bronze_launches_data ......................... [RUN]
[0m11:55:38.497301 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m11:55:38.498370 [info ] [Thread-3 (]: 3 of 8 START test source_not_null_bronze_rockets_id ............................ [RUN]
[0m11:55:38.497173 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m11:55:38.498105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae)
[0m11:55:38.499346 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m11:55:38.495886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_launches)
[0m11:55:38.495244 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m11:55:38.495358 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m11:55:38.500213 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m11:55:38.500507 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m11:55:38.503072 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m11:55:38.501336 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb'
[0m11:55:38.500946 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae'
[0m11:55:38.504260 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m11:55:38.498813 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1'
[0m11:55:38.506259 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m11:55:38.497416 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m11:55:38.499078 [info ] [Thread-2 (]: 2 of 8 START test source_not_null_bronze_launches_id ........................... [RUN]
[0m11:55:38.508484 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb)
[0m11:55:38.508693 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m11:55:38.503915 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m11:55:38.508008 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_bronze_starlink_data ......................... [RUN]
[0m11:55:38.506122 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m11:55:38.507725 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m11:55:38.510583 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m11:55:38.511001 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed'
[0m11:55:38.512292 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m11:55:38.508782 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 11:55:38.496847 => 11:55:38.508713
[0m11:55:38.508920 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 11:55:38.501727 => 11:55:38.508854
[0m11:55:38.513151 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m11:55:38.513402 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 11:55:38.513327 => 11:55:38.513336
[0m11:55:38.513826 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m11:55:38.508588 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m11:55:38.512440 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m11:55:38.512660 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 11:55:38.506434 => 11:55:38.512587
[0m11:55:38.512920 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m11:55:38.514192 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m11:55:38.514450 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 11:55:38.499536 => 11:55:38.514381
[0m11:55:38.514094 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m11:55:38.516136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_launches, now test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1)
[0m11:55:38.514581 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 11:55:38.508856 => 11:55:38.514526
[0m11:55:38.516599 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m11:55:38.516730 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m11:55:38.515356 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 11:55:38.515287 => 11:55:38.515291
[0m11:55:38.519120 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m11:55:38.515914 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 11:55:38.504458 => 11:55:38.515849
[0m11:55:38.519927 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m11:55:38.516453 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 11:55:38.510750 => 11:55:38.516354
[0m11:55:38.520588 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m11:55:38.518535 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m11:55:38.520261 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 11:55:38.520174 => 11:55:38.520177
[0m11:55:38.519393 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m11:55:38.520852 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 11:55:38.520787 => 11:55:38.520789
[0m11:55:38.522364 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m11:55:38.515675 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m11:55:38.521974 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_starlink, now test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed)
[0m11:55:38.521580 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m11:55:38.523362 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m11:55:38.516075 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 11:55:38.512763 => 11:55:38.516012
[0m11:55:38.522669 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m11:55:38.515145 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m11:55:38.524474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m11:55:38.525147 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m11:55:38.523565 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m11:55:38.522507 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 11:55:38.516943 => 11:55:38.522450
[0m11:55:38.525738 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m11:55:38.524111 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m11:55:38.523142 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m11:55:38.522335 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m11:55:38.525404 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m11:55:38.527122 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m11:55:38.529736 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m11:55:38.532351 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: BEGIN
[0m11:55:38.523686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m11:55:38.526363 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 11:55:38.526287 => 11:55:38.526290
[0m11:55:38.532158 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m11:55:38.533345 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: BEGIN
[0m11:55:38.529365 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m11:55:38.529924 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m11:55:38.532738 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m11:55:38.533041 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m11:55:38.532937 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:55:38.532752 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m11:55:38.533537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:55:38.533969 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: BEGIN
[0m11:55:38.536692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:38.537038 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.534837 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: BEGIN
[0m11:55:38.537182 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.537944 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m11:55:38.538145 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."rockets"
where id is null



      
    ) dbt_internal_test
[0m11:55:38.537495 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m11:55:38.538770 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."launches"
where id is null



      
    ) dbt_internal_test
[0m11:55:38.533477 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m11:55:38.537729 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:55:38.538656 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m11:55:38.539132 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:55:38.538995 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 11:55:38.527117 => 11:55:38.538902
[0m11:55:38.541273 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m11:55:38.540525 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 11:55:38.531083 => 11:55:38.540445
[0m11:55:38.539323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.539391 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m11:55:38.542483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m11:55:38.539741 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:55:38.541886 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 11:55:38.534470 => 11:55:38.541793
[0m11:55:38.541884 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 11:55:38.524465 => 11:55:38.541757
[0m11:55:38.543693 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m11:55:38.543783 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: ROLLBACK
[0m11:55:38.542677 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.541571 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 11:55:38.541474 => 11:55:38.541478
[0m11:55:38.544549 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m11:55:38.543453 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 11:55:38.517048 => 11:55:38.543385
[0m11:55:38.542063 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m11:55:38.542201 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m11:55:38.545373 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."launches"
where data is null



      
    ) dbt_internal_test
[0m11:55:38.543997 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 11:55:38.543931 => 11:55:38.543935
[0m11:55:38.544271 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m11:55:38.542829 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m11:55:38.544814 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m11:55:38.544972 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: ROLLBACK
[0m11:55:38.545319 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 11:55:38.545230 => 11:55:38.545233
[0m11:55:38.544138 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: Close
[0m11:55:38.546347 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:55:38.546216 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m11:55:38.549733 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 11:55:38.522706 => 11:55:38.549667
[0m11:55:38.550092 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: ROLLBACK
[0m11:55:38.548049 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."starlink"
where data is null



      
    ) dbt_internal_test
[0m11:55:38.549221 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m11:55:38.549220 [info ] [Thread-3 (]: 3 of 8 PASS source_not_null_bronze_rockets_id .................................. [[32mPASS[0m in 0.05s]
[0m11:55:38.548345 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m11:55:38.552610 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m11:55:38.548634 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: Close
[0m11:55:38.553149 [info ] [Thread-2 (]: 2 of 8 PASS source_not_null_bronze_launches_id ................................. [[32mPASS[0m in 0.04s]
[0m11:55:38.554051 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m11:55:38.554307 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m11:55:38.547892 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m11:55:38.550998 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8, now model.spacex_analytics.starlink_constellation_status)
[0m11:55:38.550733 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: Close
[0m11:55:38.552379 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:55:38.548880 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m11:55:38.554681 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m11:55:38.555442 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m11:55:38.552613 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m11:55:38.556987 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m11:55:38.557309 [info ] [Thread-3 (]: 6 of 8 START test source_unique_bronze_launches_id ............................. [RUN]
[0m11:55:38.557774 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m11:55:38.555007 [info ] [Thread-2 (]: 5 of 8 START test source_not_null_bronze_starlink_id ........................... [RUN]
[0m11:55:38.556240 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 11:55:38.526383 => 11:55:38.556055
[0m11:55:38.558350 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m11:55:38.558027 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m11:55:38.558782 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 11:55:38.546393 => 11:55:38.558695
[0m11:55:38.559490 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m11:55:38.559937 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 11:55:38.559854 => 11:55:38.559858
[0m11:55:38.559655 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 11:55:38.552785 => 11:55:38.559591
[0m11:55:38.560716 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m11:55:38.560415 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m11:55:38.560576 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 11:55:38.556823 => 11:55:38.560512
[0m11:55:38.561385 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m11:55:38.560996 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 11:55:38.560928 => 11:55:38.560931
[0m11:55:38.561753 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 11:55:38.561677 => 11:55:38.561679
[0m11:55:38.558356 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m11:55:38.556590 [info ] [Thread-1 (]: 1 of 8 PASS source_not_null_bronze_launches_data ............................... [[32mPASS[0m in 0.06s]
[0m11:55:38.562179 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m11:55:38.562647 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m11:55:38.558686 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: ROLLBACK
[0m11:55:38.562223 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m11:55:38.562573 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m11:55:38.565722 [debug] [Thread-4 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m11:55:38.563133 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m11:55:38.566678 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m11:55:38.566684 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e, now model.spacex_analytics.starlink_42k_projection)
[0m11:55:38.566366 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m11:55:38.567210 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m11:55:38.563699 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: Close
[0m11:55:38.568581 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_bronze_starlink_data ............................... [[32mPASS[0m in 0.06s]
[0m11:55:38.570068 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m11:55:38.570018 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m11:55:38.567015 [info ] [Thread-1 (]: 7 of 8 START test source_unique_bronze_rockets_id .............................. [RUN]
[0m11:55:38.567474 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 11:55:38.559158 => 11:55:38.567391
[0m11:55:38.574815 [debug] [Thread-4 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 11:55:38.567623 => 11:55:38.574658
[0m11:55:38.575173 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m11:55:38.570448 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 11:55:38.564571 => 11:55:38.570371
[0m11:55:38.575419 [debug] [Thread-4 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 11:55:38.575352 => 11:55:38.575357
[0m11:55:38.570631 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m11:55:38.575998 [info ] [Thread-4 (]: 8 of 8 START test source_unique_bronze_starlink_id ............................. [RUN]
[0m11:55:38.576043 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m11:55:38.576418 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m11:55:38.575570 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m11:55:38.574514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m11:55:38.574841 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m11:55:38.576641 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m11:55:38.579600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:38.579979 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m11:55:38.580180 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m11:55:38.580359 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m11:55:38.580537 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m11:55:38.577945 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m11:55:38.581268 [debug] [MainThread]: Command end result
[0m11:55:38.578258 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m11:55:38.579135 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m11:55:38.584057 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m11:55:38.583183 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m11:55:38.580907 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m11:55:38.584311 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: BEGIN
[0m11:55:38.585184 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:55:38.585060 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m11:55:38.585921 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: BEGIN
[0m11:55:38.587101 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:55:38.586537 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 11:55:38.581805 => 11:55:38.586483
[0m11:55:38.586405 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 11:55:38.579341 => 11:55:38.586332
[0m11:55:38.588209 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m11:55:38.587910 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m11:55:38.587691 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.588607 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.589788 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m11:55:38.591583 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m11:55:38.591827 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m11:55:38.592077 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m11:55:38.592759 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."starlink"
where id is null



      
    ) dbt_internal_test
[0m11:55:38.593059 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."launches"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:55:38.593457 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m11:55:38.593583 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m11:55:38.594619 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:55:38.594856 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: BEGIN
[0m11:55:38.595056 [info ] [MainThread]: Building catalog
[0m11:55:38.593899 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: BEGIN
[0m11:55:38.596112 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:55:38.596372 [debug] [ThreadPool]: Acquiring new postgres connection 'spacex_db.information_schema'
[0m11:55:38.594389 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:55:38.595437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:38.594511 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:55:38.598158 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 11:55:38.577086 => 11:55:38.598069
[0m11:55:38.599881 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: ROLLBACK
[0m11:55:38.599352 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 11:55:38.578450 => 11:55:38.599282
[0m11:55:38.598637 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.600457 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m11:55:38.600708 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."starlink"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:55:38.600310 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: Close
[0m11:55:38.600954 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m11:55:38.602122 [debug] [ThreadPool]: On spacex_db.information_schema: BEGIN
[0m11:55:38.602357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:38.602424 [info ] [Thread-2 (]: 5 of 8 PASS source_not_null_bronze_starlink_id ................................. [[32mPASS[0m in 0.04s]
[0m11:55:38.602077 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:55:38.600188 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: ROLLBACK
[0m11:55:38.602576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.604555 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.604783 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m11:55:38.604799 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m11:55:38.604998 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."rockets"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:55:38.605074 [debug] [ThreadPool]: On spacex_db.information_schema: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "spacex_db.information_schema"} */

    
    

    select
        'spacex_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('silver') or upper(sch.nspname) = upper('bronze') or upper(sch.nspname) = upper('gold'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:55:38.603670 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m11:55:38.604666 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: Close
[0m11:55:38.604371 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 11:55:38.589006 => 11:55:38.604300
[0m11:55:38.607662 [debug] [ThreadPool]: SQL status: SELECT 124 in 0.0 seconds
[0m11:55:38.607926 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: ROLLBACK
[0m11:55:38.605760 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:55:38.606720 [info ] [Thread-3 (]: 6 of 8 PASS source_unique_bronze_launches_id ................................... [[32mPASS[0m in 0.05s]
[0m11:55:38.609494 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m11:55:38.608850 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 11:55:38.590013 => 11:55:38.608771
[0m11:55:38.609049 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: Close
[0m11:55:38.610291 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: ROLLBACK
[0m11:55:38.611062 [debug] [ThreadPool]: On spacex_db.information_schema: ROLLBACK
[0m11:55:38.611339 [debug] [ThreadPool]: On spacex_db.information_schema: Close
[0m11:55:38.611137 [info ] [Thread-4 (]: 8 of 8 PASS source_unique_bronze_starlink_id ................................... [[32mPASS[0m in 0.03s]
[0m11:55:38.612531 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m11:55:38.612167 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: Close
[0m11:55:38.613059 [info ] [Thread-1 (]: 7 of 8 PASS source_unique_bronze_rockets_id .................................... [[32mPASS[0m in 0.04s]
[0m11:55:38.618690 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m11:55:38.621259 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:38.621701 [debug] [MainThread]: On master: BEGIN
[0m11:55:38.621934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:38.623605 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:38.624151 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/target/catalog.json
[0m11:55:38.623956 [debug] [MainThread]: On master: COMMIT
[0m11:55:38.624644 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:38.624657 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:55:38.624609 after 0.26 seconds
[0m11:55:38.624858 [debug] [MainThread]: On master: COMMIT
[0m11:55:38.625072 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:55:38.625153 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:38.625294 [debug] [MainThread]: Connection 'spacex_db.information_schema' was properly closed.
[0m11:55:38.625378 [debug] [MainThread]: On master: Close
[0m11:55:38.625539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8902d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8902e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8924ef00>]}
[0m11:55:38.625768 [debug] [MainThread]: Flushing usage events
[0m11:55:38.625990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:38.626688 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e' was properly closed.
[0m11:55:38.626855 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m11:55:38.627018 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8' was properly closed.
[0m11:55:38.627399 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m11:55:38.628053 [info ] [MainThread]: 
[0m11:55:38.628300 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m11:55:38.629280 [debug] [MainThread]: Command end result
[0m11:55:38.640316 [info ] [MainThread]: 
[0m11:55:38.640740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:38.640950 [info ] [MainThread]: 
[0m11:55:38.641155 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:55:38.641430 [debug] [MainThread]: Command `dbt test` succeeded at 11:55:38.641392 after 0.27 seconds
[0m11:55:38.641667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9f7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ac68770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5e9b80>]}
[0m11:55:38.641910 [debug] [MainThread]: Flushing usage events
[0m11:55:44.071586 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:55:45.111275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810bb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821e7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8123ef00>]}


============================== 11:55:45.112862 | 6c0fd753-86b1-4157-9dae-c09018e58d4f ==============================
[0m11:55:45.112862 [info ] [MainThread]: Running with dbt=1.6.0
[0m11:55:45.113225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run-operation log_results --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:55:45.151699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c0fd753-86b1-4157-9dae-c09018e58d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810ba210>]}
[0m11:55:45.157216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c0fd753-86b1-4157-9dae-c09018e58d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80603a40>]}
[0m11:55:45.157658 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m11:55:45.161973 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m11:55:45.176913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:45.177203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:45.179381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c0fd753-86b1-4157-9dae-c09018e58d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8122b920>]}
[0m11:55:45.184715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c0fd753-86b1-4157-9dae-c09018e58d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8066e630>]}
[0m11:55:45.185018 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m11:55:45.185259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c0fd753-86b1-4157-9dae-c09018e58d4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8267c9e0>]}
[0m11:55:45.185622 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_results'
[0m11:55:45.185832 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m11:55:45.186043 [debug] [MainThread]: On macro_log_results: BEGIN
[0m11:55:45.186216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:45.188025 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:45.188268 [debug] [MainThread]: On macro_log_results: COMMIT
[0m11:55:45.188457 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m11:55:45.188640 [debug] [MainThread]: On macro_log_results: COMMIT
[0m11:55:45.188856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:45.193333 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m11:55:45.193581 [debug] [MainThread]: On macro_log_results: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "macro_log_results"} */

    
    SELECT 
      "🎯 ANSWER: Launches Needed" as launches_needed,
      "🎯 ANSWER: Months to 42K" as months_needed,
      "🎯 ANSWER: Est. Completion Date" as completion_date,
      "CONFIDENCE: Projection Reliability" as confidence
    FROM gold.starlink_42k_projection
    LIMIT 1
  
  
[0m11:55:45.194028 [debug] [MainThread]: Postgres adapter: Postgres error: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^

[0m11:55:45.194356 [debug] [MainThread]: Postgres adapter: Error running SQL: macro log_results
[0m11:55:45.194600 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m11:55:45.194841 [debug] [MainThread]: On macro_log_results: Close
[0m11:55:45.195211 [error] [MainThread]: Encountered an error while running operation: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^
[0m11:55:45.196932 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 73, in exception_handler
    yield
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1054, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 290, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 146, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 84, in exception_handler
    raise dbt.exceptions.DbtDatabaseError(str(e).strip()) from e
dbt.exceptions.DbtDatabaseError: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^

[0m11:55:45.198249 [debug] [MainThread]: Command `dbt run-operation` failed at 11:55:45.198206 after 0.09 seconds
[0m11:55:45.198497 [debug] [MainThread]: Connection 'macro_log_results' was properly closed.
[0m11:55:45.198779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815dc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8062e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810b9af0>]}
[0m11:55:45.199029 [debug] [MainThread]: Flushing usage events
[0m23:41:29.341972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa74ed8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa76ed670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7427740>]}


============================== 23:41:29.343988 | 1b96b4b7-dc4c-4d4c-bb08-ca3237ccd0ef ==============================
[0m23:41:29.343988 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:41:29.344372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:41:29.391577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b96b4b7-dc4c-4d4c-bb08-ca3237ccd0ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa70ad6a0>]}
[0m23:41:29.396918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b96b4b7-dc4c-4d4c-bb08-ca3237ccd0ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa649da60>]}
[0m23:41:29.397307 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:41:29.401162 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:41:29.417990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:41:29.418353 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m23:41:29.418644 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_constellation_status.sql
[0m23:41:29.437753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b96b4b7-dc4c-4d4c-bb08-ca3237ccd0ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f2bb30>]}
[0m23:41:29.443716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b96b4b7-dc4c-4d4c-bb08-ca3237ccd0ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64018b0>]}
[0m23:41:29.443975 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:41:29.444311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b96b4b7-dc4c-4d4c-bb08-ca3237ccd0ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75549b0>]}
[0m23:41:29.444972 [info ] [MainThread]: 
[0m23:41:29.445371 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:29.445951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m23:41:29.449620 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m23:41:29.449852 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m23:41:29.450031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:29.453597 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:41:29.454190 [debug] [ThreadPool]: On list_spacex_db: Close
[0m23:41:29.454892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold)
[0m23:41:29.456982 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:41:29.457256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m23:41:29.457416 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:41:29.458125 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:41:29.458448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:29.458707 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:41:29.459522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:29.460716 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:41:29.461104 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:41:29.461370 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:41:29.461721 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:41:29.461967 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:41:29.462199 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:41:29.463378 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:41:29.463976 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:41:29.464449 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:41:29.464607 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:41:29.465047 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:41:29.466446 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:41:29.468612 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:29.468850 [debug] [MainThread]: On master: BEGIN
[0m23:41:29.469052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:29.470723 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:41:29.470997 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:29.471273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:41:29.475867 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:41:29.476451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b96b4b7-dc4c-4d4c-bb08-ca3237ccd0ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64e39b0>]}
[0m23:41:29.476771 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:29.477086 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:29.477327 [debug] [MainThread]: On master: BEGIN
[0m23:41:29.477692 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:41:29.477926 [debug] [MainThread]: On master: COMMIT
[0m23:41:29.478160 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:29.478393 [debug] [MainThread]: On master: COMMIT
[0m23:41:29.478692 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:41:29.478927 [debug] [MainThread]: On master: Close
[0m23:41:29.479332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:29.479997 [info ] [MainThread]: 
[0m23:41:29.481389 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m23:41:29.481562 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m23:41:29.481807 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m23:41:29.482144 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m23:41:29.482545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_42k_projection)
[0m23:41:29.482914 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_constellation_status)
[0m23:41:29.483185 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m23:41:29.483445 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m23:41:29.486783 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m23:41:29.488237 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m23:41:29.489993 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 23:41:29.487029 => 23:41:29.489910
[0m23:41:29.490216 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m23:41:29.490408 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 23:41:29.483669 => 23:41:29.490330
[0m23:41:29.502831 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m23:41:29.502988 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m23:41:29.505059 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m23:41:29.505998 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:41:29.506280 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m23:41:29.506527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:41:29.506709 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:41:29.507380 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m23:41:29.507811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:29.508806 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:41:29.509047 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:41:29.509195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:41:29.509420 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_overview AS (
    SELECT 
        COUNT(*) as total_satellites,
        COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 2) as operational_rate_pct,
        
        MIN(launch_date) as first_deployment_date,
        MAX(launch_date) as latest_deployment_date,
        MAX(extracted_at) as last_updated
        
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

orbital_characteristics AS (
    SELECT 
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_deg,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_orbital_period_min,
        ROUND(MIN(CASE WHEN is_active THEN calculated_altitude_km END), 1) as min_altitude_km,
        ROUND(MAX(CASE WHEN is_active THEN calculated_altitude_km END), 1) as max_altitude_km
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE is_active = true AND calculated_altitude_km IS NOT NULL
),

launch_summary AS (
    SELECT 
        COUNT(*) as total_starlink_missions,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_missions,
        ROUND(COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / COUNT(*), 2) as mission_success_rate_pct,
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed,
        ROUND(AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 1) as avg_satellites_per_mission
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true AND NOT is_upcoming
),

data_quality AS (
    SELECT 
        COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) as valid_records,
        COUNT(*) as total_records,
        ROUND(COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*), 2) as data_quality_score_pct
    FROM "spacex_db"."silver"."silver_starlink"
)

SELECT 
    -- Metadata
    'constellation_status' as status_type,
    CURRENT_TIMESTAMP as status_timestamp,
    
    -- Operational Status
    co.total_satellites,
    co.active_satellites,
    co.inactive_satellites,
    co.operational_rate_pct,
    
    -- Deployment Timeline
    co.first_deployment_date,
    co.latest_deployment_date,
    (CURRENT_DATE - co.first_deployment_date) as constellation_age_days,
    
    -- Orbital Profile
    oc.avg_altitude_km,
    oc.min_altitude_km,
    oc.max_altitude_km,
    oc.avg_inclination_deg,
    oc.avg_orbital_period_min,
    
    -- Launch Performance
    ls.total_starlink_missions,
    ls.successful_missions,
    ls.mission_success_rate_pct,
    ls.satellites_deployed,
    ls.avg_satellites_per_mission,
    
    -- Data Quality
    dq.data_quality_score_pct,
    dq.valid_records,
    dq.total_records,
    
    -- Freshness
    co.last_updated,
    EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - co.last_updated)) / 3600 as data_age_hours,
    
    -- Health Status
    CASE 
        WHEN co.operational_rate_pct >= 95 THEN 'Excellent'
        WHEN co.operational_rate_pct >= 90 THEN 'Good'
        WHEN co.operational_rate_pct >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as constellation_health,
    
    CASE 
        WHEN EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - co.last_updated)) / 3600 <= 24 THEN 'Fresh'
        WHEN EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - co.last_updated)) / 3600 <= 48 THEN 'Acceptable'
        ELSE 'Stale'
    END as data_freshness_status

FROM constellation_overview co
CROSS JOIN orbital_characteristics oc
CROSS JOIN launch_summary ls
CROSS JOIN data_quality dq
  );
  
[0m23:41:29.509708 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:41:29.510725 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE
),

deployment_efficiency AS (
    SELECT 
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600 as hours_since_last_update
    FROM "spacex_db"."silver"."silver_starlink"
),

projection_calculations AS (
    SELECT 
        c.*,
        l.*,
        f.*,
        e.*,
        df.*,
        
        -- Business targets
        42000 as target_satellite_count,
        42000 - c.current_active_satellites as satellites_remaining,
        
        -- Projection scenarios
        CASE 
            WHEN f.avg_launches_per_month > 0 AND e.avg_estimated_per_launch > 0 THEN
                CEILING((42000 - c.current_active_satellites) / e.avg_estimated_per_launch)
            ELSE NULL
        END as conservative_launches_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - c.current_active_satellites) / 50.0)  -- Conservative 50 sats per launch
            ELSE NULL
        END as current_pace_launches_needed,
        
        CEILING((42000 - c.current_active_satellites) / 70.0) as optimistic_launches_needed,
        
        -- Timeline projections
        CASE 
            WHEN f.avg_launches_per_month > 0 AND e.avg_estimated_per_launch > 0 THEN
                CEILING((42000 - c.current_active_satellites) / e.avg_estimated_per_launch) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - c.current_active_satellites) / 50.0) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend,
        
        -- Confidence assessment
        CASE 
            WHEN f.launches_last_24_months >= 24 AND e.recent_successful_launches >= 6 THEN 'High'
            WHEN f.launches_last_24_months >= 12 AND e.recent_successful_launches >= 3 THEN 'Medium'
            WHEN f.launches_last_24_months >= 6 THEN 'Low'
            ELSE 'Insufficient Data'
        END as projection_confidence,
        
        -- Risk assessment
        CASE 
            WHEN df.hours_since_last_update > 48 THEN 'Data Staleness'
            WHEN l.launch_success_rate_pct < 90 THEN 'Launch Reliability'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Pace Deceleration'
            WHEN (42000 - c.current_active_satellites) > c.current_active_satellites THEN 'Scale Challenge'
            ELSE 'Low Risk'
        END as primary_risk_factor
        
    FROM constellation_metrics c
    CROSS JOIN launch_performance l
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
    CROSS JOIN data_freshness df
)

SELECT 
    -- Metadata
    'starlink_constellation_projection'::varchar as analysis_type,
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current Status
    target_satellite_count,
    current_active_satellites,
    satellites_remaining,
    ROUND((current_active_satellites * 100.0 / target_satellite_count), 1) as completion_percentage,
    
    -- Historical Performance
    total_starlink_launches,
    successful_starlink_launches,
    launch_success_rate_pct,
    avg_satellites_per_successful_launch,
    
    -- Recent Activity Metrics
    launches_last_24_months,
    ROUND(avg_launches_per_month, 2) as avg_monthly_launch_rate,
    ROUND(avg_launches_per_year, 1) as avg_annual_launch_rate,
    ROUND(recent_6mo_monthly_rate, 2) as recent_monthly_launch_rate,
    launch_frequency_trend,
    
    -- Business Projections
    conservative_launches_needed,
    ROUND(conservative_months_needed, 1) as conservative_timeline_months,
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as conservative_completion_date,
    
    current_pace_launches_needed,
    ROUND(current_pace_months_needed, 1) as current_pace_timeline_months,
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as current_pace_completion_date,
    
    optimistic_launches_needed,
    ROUND(optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month), 1) as optimistic_timeline_months,
    
    -- Quality and Confidence Metrics
    projection_confidence,
    primary_risk_factor,
    ROUND(hours_since_last_update, 1) as data_age_hours,
    
    -- Technical Metrics
    total_satellites_tracked,
    inactive_satellites,
    ROUND(active_percentage, 1) as satellite_active_rate_pct,
    data_quality_percentage,
    
    -- Additional Context
    first_starlink_launch_date,
    latest_completed_launch_date,
    launches_last_30_days,
    satellites_deployed_last_30_days

FROM projection_calculations

-- Add documentation

  );
  
[0m23:41:29.515126 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 230:     ROUND(hours_since_last_update, 1) as data_age_hours,
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m23:41:29.518600 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m23:41:29.518971 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 23:41:29.503327 => 23:41:29.518890
[0m23:41:29.519462 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m23:41:29.522331 [debug] [Thread-1 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  function round(double precision, integer) does not exist
  LINE 230:     ROUND(hours_since_last_update, 1) as data_age_hours,
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m23:41:29.522716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b96b4b7-dc4c-4d4c-bb08-ca3237ccd0ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e62a80>]}
[0m23:41:29.523099 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold.starlink_42k_projection ............. [[31mERROR[0m in 0.04s]
[0m23:41:29.523487 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m23:41:29.546400 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:41:29.549205 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:41:29.549519 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m23:41:29.549971 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:29.551105 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:41:29.551310 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m23:41:29.551628 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:29.558532 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m23:41:29.558859 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:41:29.559098 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m23:41:29.559691 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:41:29.562462 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:41:29.562693 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m23:41:29.563939 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:41:29.564560 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 23:41:29.490506 => 23:41:29.564495
[0m23:41:29.564766 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m23:41:29.565138 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b96b4b7-dc4c-4d4c-bb08-ca3237ccd0ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6408e90>]}
[0m23:41:29.565489 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.08s]
[0m23:41:29.565967 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m23:41:29.567313 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:29.567535 [debug] [MainThread]: On master: BEGIN
[0m23:41:29.567714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:29.569086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:41:29.569276 [debug] [MainThread]: On master: COMMIT
[0m23:41:29.569457 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:29.569627 [debug] [MainThread]: On master: COMMIT
[0m23:41:29.569836 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:41:29.570005 [debug] [MainThread]: On master: Close
[0m23:41:29.570308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:29.570506 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m23:41:29.570667 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m23:41:29.570887 [info ] [MainThread]: 
[0m23:41:29.571190 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m23:41:29.571549 [debug] [MainThread]: Command end result
[0m23:41:29.575488 [info ] [MainThread]: 
[0m23:41:29.575727 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:41:29.575923 [info ] [MainThread]: 
[0m23:41:29.576114 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m23:41:29.576296 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m23:41:29.576484 [error] [MainThread]:   LINE 230:     ROUND(hours_since_last_update, 1) as data_age_hours,
[0m23:41:29.576656 [error] [MainThread]:                 ^
[0m23:41:29.576830 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m23:41:29.577004 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m23:41:29.577181 [info ] [MainThread]: 
[0m23:41:29.577385 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:41:29.577635 [debug] [MainThread]: Command `dbt run` failed at 23:41:29.577601 after 0.24 seconds
[0m23:41:29.577857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa752ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6fff380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6fffe90>]}
[0m23:41:29.578070 [debug] [MainThread]: Flushing usage events
[0m23:43:55.303507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8629b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8667a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866c2d50>]}


============================== 23:43:55.305391 | 235eb84a-3873-47b4-a304-bf1b87b4a5d9 ==============================
[0m23:43:55.305391 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:43:55.305767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:43:55.345903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '235eb84a-3873-47b4-a304-bf1b87b4a5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86601400>]}
[0m23:43:55.351852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '235eb84a-3873-47b4-a304-bf1b87b4a5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8580f560>]}
[0m23:43:55.352377 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:43:55.356569 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:43:55.372373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:43:55.372805 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m23:43:55.373087 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_constellation_status.sql
[0m23:43:55.391183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '235eb84a-3873-47b4-a304-bf1b87b4a5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8580c1a0>]}
[0m23:43:55.396986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '235eb84a-3873-47b4-a304-bf1b87b4a5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85773f80>]}
[0m23:43:55.397253 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:43:55.397482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '235eb84a-3873-47b4-a304-bf1b87b4a5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863b57f0>]}
[0m23:43:55.398152 [info ] [MainThread]: 
[0m23:43:55.398532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:55.399085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m23:43:55.403481 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m23:43:55.403808 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m23:43:55.404021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:55.406138 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:43:55.406748 [debug] [ThreadPool]: On list_spacex_db: Close
[0m23:43:55.407510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_silver)
[0m23:43:55.407915 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m23:43:55.410474 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:43:55.411410 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:43:55.411701 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:43:55.412019 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:43:55.412268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:55.412567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:55.414057 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:55.414370 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:43:55.414503 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:55.414682 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:43:55.414937 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:43:55.415360 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:43:55.416173 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:43:55.416350 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:43:55.417060 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:43:55.417894 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:43:55.418249 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:43:55.418460 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:43:55.421387 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:55.421662 [debug] [MainThread]: On master: BEGIN
[0m23:43:55.421889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:55.423409 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:55.423642 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:55.423894 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:55.428577 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:43:55.429224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '235eb84a-3873-47b4-a304-bf1b87b4a5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a655580>]}
[0m23:43:55.429517 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:55.429798 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:55.430002 [debug] [MainThread]: On master: BEGIN
[0m23:43:55.430355 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:55.430575 [debug] [MainThread]: On master: COMMIT
[0m23:43:55.430816 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:55.431083 [debug] [MainThread]: On master: COMMIT
[0m23:43:55.431361 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:55.431576 [debug] [MainThread]: On master: Close
[0m23:43:55.431940 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:55.432417 [info ] [MainThread]: 
[0m23:43:55.433905 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m23:43:55.434107 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m23:43:55.434334 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m23:43:55.434853 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m23:43:55.435291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_42k_projection)
[0m23:43:55.435709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_constellation_status)
[0m23:43:55.435975 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m23:43:55.436250 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m23:43:55.439342 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m23:43:55.440597 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m23:43:55.442368 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 23:43:55.436485 => 23:43:55.442208
[0m23:43:55.442613 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 23:43:55.439624 => 23:43:55.442500
[0m23:43:55.442777 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m23:43:55.443008 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m23:43:55.458655 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m23:43:55.460377 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m23:43:55.461825 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:43:55.462133 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m23:43:55.462296 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:43:55.462466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:55.462706 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m23:43:55.463174 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:55.464627 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:55.464768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:55.464924 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:43:55.465135 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:43:55.465376 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    CURRENT_TIMESTAMP as status_date,
    
    -- Current constellation
    COUNT(*) as total_satellites,
    COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
    COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
    
    -- Performance
    ROUND((COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*))::numeric, 1) as active_percentage,
    
    -- Timeline
    MIN(launch_date) as first_launch_date,
    MAX(launch_date) as latest_launch_date,
    
    -- Data quality
    MAX(extracted_at) as last_updated,
    ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 1) as data_age_hours

FROM "spacex_db"."silver"."silver_starlink"
WHERE satellite_id IS NOT NULL
  );
  
[0m23:43:55.465634 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT 
        COUNT(CASE WHEN is_active THEN 1 END) as current_satellites
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_stats AS (
    SELECT 
        COUNT(*) as total_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_launches,
        AVG(CASE WHEN launch_success THEN estimated_satellite_count END)::numeric as avg_sats_per_launch,
        
        -- Recent launch rate (last 12 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as launches_last_12_months
        
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date <= CURRENT_DATE  -- Exclude future launches
)

SELECT 
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current status
    42000 as target_satellites,
    cs.current_satellites,
    (42000 - cs.current_satellites) as satellites_needed,
    ROUND((cs.current_satellites * 100.0 / 42000)::numeric, 1) as progress_percent,
    
    -- Historical performance
    ls.total_launches as total_starlink_launches,
    ls.successful_launches,
    ROUND(ls.avg_sats_per_launch, 0) as avg_satellites_per_launch,
    
    -- Business projections
    CASE 
        WHEN ls.avg_sats_per_launch > 0 THEN
            CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch)
        ELSE NULL
    END as launches_needed,
    
    CASE 
        WHEN ls.launches_last_12_months > 0 AND ls.avg_sats_per_launch > 0 THEN
            ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / (ls.launches_last_12_months / 12.0))::numeric, 1)
        ELSE NULL
    END as months_to_completion,
    
    CASE 
        WHEN ls.launches_last_12_months > 0 AND ls.avg_sats_per_launch > 0 THEN
            (CURRENT_DATE + INTERVAL '1 month' * ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / (ls.launches_last_12_months / 12.0))::numeric, 1))::date
        ELSE NULL
    END as estimated_completion_date,
    
    -- Quality indicators
    CASE 
        WHEN ls.launches_last_12_months >= 6 THEN 'High Confidence'
        WHEN ls.launches_last_12_months >= 3 THEN 'Medium Confidence'
        ELSE 'Low Confidence'
    END as projection_confidence

FROM current_status cs
CROSS JOIN launch_stats ls
  );
  
[0m23:43:55.473711 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:55.478040 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:43:55.478233 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:55.478423 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m23:43:55.479462 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:43:55.479805 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection" rename to "starlink_42k_projection__dbt_backup"
[0m23:43:55.480001 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:55.481202 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:43:55.481371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:55.481519 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m23:43:55.482539 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:43:55.482901 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:55.483047 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp" rename to "starlink_42k_projection"
[0m23:43:55.491236 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m23:43:55.491719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:55.491882 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:43:55.492998 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m23:43:55.493406 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m23:43:55.493713 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:43:55.494133 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m23:43:55.494521 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:55.494705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:55.497724 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:43:55.498783 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:43:55.499073 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m23:43:55.499295 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
drop table if exists "spacex_db"."gold"."starlink_42k_projection__dbt_backup" cascade
[0m23:43:55.500150 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:43:55.500489 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:43:55.501297 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 23:43:55.455753 => 23:43:55.501219
[0m23:43:55.501995 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 23:43:55.443176 => 23:43:55.501933
[0m23:43:55.502272 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m23:43:55.502517 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m23:43:55.503211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '235eb84a-3873-47b4-a304-bf1b87b4a5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851b1550>]}
[0m23:43:55.502936 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '235eb84a-3873-47b4-a304-bf1b87b4a5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857a4ec0>]}
[0m23:43:55.504528 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold.starlink_42k_projection ................. [[32mSELECT 1[0m in 0.07s]
[0m23:43:55.505080 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.07s]
[0m23:43:55.505334 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m23:43:55.505652 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m23:43:55.507874 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:55.508113 [debug] [MainThread]: On master: BEGIN
[0m23:43:55.508352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:55.510149 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:55.510405 [debug] [MainThread]: On master: COMMIT
[0m23:43:55.510574 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:55.510732 [debug] [MainThread]: On master: COMMIT
[0m23:43:55.510975 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:55.511156 [debug] [MainThread]: On master: Close
[0m23:43:55.511494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:55.511670 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m23:43:55.511835 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m23:43:55.512044 [info ] [MainThread]: 
[0m23:43:55.512236 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:43:55.512585 [debug] [MainThread]: Command end result
[0m23:43:55.516241 [info ] [MainThread]: 
[0m23:43:55.516539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:43:55.516796 [info ] [MainThread]: 
[0m23:43:55.517160 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:43:55.517537 [debug] [MainThread]: Command `dbt run` succeeded at 23:43:55.517493 after 0.22 seconds
[0m23:43:55.517763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9073e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8577fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8667a390>]}
[0m23:43:55.518017 [debug] [MainThread]: Flushing usage events
[0m23:43:59.311104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927e8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e34080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9296d9a0>]}


============================== 23:43:59.312907 | 042bae9b-da2a-45e0-a39b-d667b32692d3 ==============================
[0m23:43:59.312907 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:43:59.313561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m23:43:59.317344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb445b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb458de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb480aea0>]}


============================== 23:43:59.319330 | 1a565054-0106-4ad9-87e2-3ffd3a583e97 ==============================
[0m23:43:59.319330 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:43:59.319990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:43:59.356339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '042bae9b-da2a-45e0-a39b-d667b32692d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d0dfd0>]}
[0m23:43:59.361635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a565054-0106-4ad9-87e2-3ffd3a583e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50f1640>]}
[0m23:43:59.362387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '042bae9b-da2a-45e0-a39b-d667b32692d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91d5f290>]}
[0m23:43:59.362950 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:43:59.368159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a565054-0106-4ad9-87e2-3ffd3a583e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39dca40>]}
[0m23:43:59.368208 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:43:59.368734 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:43:59.373496 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:43:59.387440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:59.387929 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:59.391311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '042bae9b-da2a-45e0-a39b-d667b32692d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c58ce0>]}
[0m23:43:59.393391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:59.393771 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:59.393868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '042bae9b-da2a-45e0-a39b-d667b32692d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91da2810>]}
[0m23:43:59.394262 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:43:59.394776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '042bae9b-da2a-45e0-a39b-d667b32692d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b8ec60>]}
[0m23:43:59.395734 [info ] [MainThread]: 
[0m23:43:59.396205 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:59.396389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a565054-0106-4ad9-87e2-3ffd3a583e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb44593d0>]}
[0m23:43:59.397537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m23:43:59.398545 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m23:43:59.405709 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:43:59.406363 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:43:59.406647 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:43:59.406841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a565054-0106-4ad9-87e2-3ffd3a583e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a227b0>]}
[0m23:43:59.407309 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:43:59.406894 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:43:59.407116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:59.407741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a565054-0106-4ad9-87e2-3ffd3a583e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45ed9a0>]}
[0m23:43:59.409239 [info ] [MainThread]: 
[0m23:43:59.407821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:59.409981 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:59.410607 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.411330 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:43:59.411087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m23:43:59.411599 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:43:59.412504 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.414734 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:43:59.415392 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:43:59.416003 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:43:59.411499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m23:43:59.416949 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:43:59.417636 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:43:59.417927 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:43:59.418726 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:43:59.419175 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:43:59.418958 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:43:59.420612 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:43:59.420233 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:43:59.420881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:59.421150 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:43:59.421561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:59.423041 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.422815 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.423708 [debug] [MainThread]: On master: BEGIN
[0m23:43:59.424046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:59.423564 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:43:59.424660 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:43:59.424891 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.425424 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:43:59.425672 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:43:59.426181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.426520 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.426828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:59.427249 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:43:59.428371 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:43:59.429636 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:43:59.429092 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:43:59.429935 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:43:59.430094 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:43:59.433697 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.433767 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:43:59.434097 [debug] [MainThread]: On master: BEGIN
[0m23:43:59.434372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:59.434747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '042bae9b-da2a-45e0-a39b-d667b32692d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91d5f020>]}
[0m23:43:59.435104 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:59.435419 [debug] [MainThread]: On master: Close
[0m23:43:59.436134 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.436779 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.436524 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:59.437335 [info ] [MainThread]: 
[0m23:43:59.437200 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:59.439394 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m23:43:59.439650 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m23:43:59.441036 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_starlink)
[0m23:43:59.439943 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:43:59.441722 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb'
[0m23:43:59.439818 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:43:59.442326 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:43:59.442378 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae'
[0m23:43:59.440637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_launches)
[0m23:43:59.443074 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m23:43:59.443179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a565054-0106-4ad9-87e2-3ffd3a583e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39dff20>]}
[0m23:43:59.443602 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:59.443910 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.444131 [debug] [MainThread]: On master: BEGIN
[0m23:43:59.444503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.444816 [debug] [MainThread]: On master: COMMIT
[0m23:43:59.445032 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.445243 [debug] [MainThread]: On master: COMMIT
[0m23:43:59.445502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:59.445710 [debug] [MainThread]: On master: Close
[0m23:43:59.441328 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m23:43:59.446089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:59.447680 [info ] [MainThread]: 
[0m23:43:59.442809 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:43:59.449585 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:43:59.450163 [info ] [Thread-1 (]: 1 of 8 START test source_not_null_bronze_launches_data ......................... [RUN]
[0m23:43:59.450675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae)
[0m23:43:59.450981 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:43:59.441992 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:43:59.449746 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:43:59.456796 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:43:59.448735 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m23:43:59.453691 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:43:59.446691 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m23:43:59.449878 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:43:59.449978 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:43:59.458795 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_bronze_starlink_data ......................... [RUN]
[0m23:43:59.459261 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 23:43:59.455408 => 23:43:59.459149
[0m23:43:59.457415 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:43:59.459884 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:43:59.458431 [info ] [Thread-3 (]: 3 of 8 START test source_not_null_bronze_rockets_id ............................ [RUN]
[0m23:43:59.459598 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 23:43:59.443296 => 23:43:59.459543
[0m23:43:59.457607 [info ] [Thread-2 (]: 2 of 8 START test source_not_null_bronze_launches_id ........................... [RUN]
[0m23:43:59.459712 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 23:43:59.447265 => 23:43:59.459664
[0m23:43:59.459305 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed'
[0m23:43:59.459447 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 23:43:59.449103 => 23:43:59.459373
[0m23:43:59.461440 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:43:59.461621 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:43:59.463426 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 23:43:59.463346 => 23:43:59.463351
[0m23:43:59.464051 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:43:59.460961 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 23:43:59.451197 => 23:43:59.460892
[0m23:43:59.465102 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:43:59.465179 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:43:59.465848 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1)
[0m23:43:59.461217 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m23:43:59.469619 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 23:43:59.469537 => 23:43:59.469541
[0m23:43:59.460815 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m23:43:59.470945 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 23:43:59.470871 => 23:43:59.470875
[0m23:43:59.460598 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1'
[0m23:43:59.471533 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:43:59.460353 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 23:43:59.460253 => 23:43:59.460264
[0m23:43:59.461202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb)
[0m23:43:59.473721 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:43:59.463678 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:43:59.471357 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:43:59.473382 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:43:59.468739 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:43:59.473695 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:43:59.476848 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:43:59.477604 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:43:59.470162 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m23:43:59.477804 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 23:43:59.461672 => 23:43:59.477733
[0m23:43:59.478540 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:43:59.478840 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:43:59.471344 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m23:43:59.479632 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:43:59.478518 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 23:43:59.471804 => 23:43:59.478355
[0m23:43:59.479247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_starlink, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m23:43:59.478250 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:43:59.480916 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: BEGIN
[0m23:43:59.474397 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:43:59.480231 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:43:59.481412 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed)
[0m23:43:59.482067 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:43:59.479960 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:43:59.482286 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:43:59.481132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:59.480463 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 23:43:59.476072 => 23:43:59.480394
[0m23:43:59.485242 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:43:59.486103 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:43:59.483311 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:43:59.483456 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:43:59.486682 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: BEGIN
[0m23:43:59.480938 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 23:43:59.475245 => 23:43:59.480861
[0m23:43:59.480242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_launches, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m23:43:59.486418 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: BEGIN
[0m23:43:59.480740 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:43:59.487683 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:43:59.487284 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:43:59.487568 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:43:59.486946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.488734 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:43:59.488494 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: BEGIN
[0m23:43:59.489223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:59.489015 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."launches"
where data is null



      
    ) dbt_internal_test
[0m23:43:59.489598 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.490139 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:43:59.490504 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."rockets"
where id is null



      
    ) dbt_internal_test
[0m23:43:59.490285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:59.485977 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:43:59.487138 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:43:59.487455 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:43:59.492210 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 23:43:59.465966 => 23:43:59.492132
[0m23:43:59.492361 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:59.492478 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.493434 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:43:59.493740 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."starlink"
where data is null



      
    ) dbt_internal_test
[0m23:43:59.492622 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: ROLLBACK
[0m23:43:59.493586 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.494602 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:43:59.490576 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:43:59.493198 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 23:43:59.481385 => 23:43:59.493131
[0m23:43:59.495176 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: ROLLBACK
[0m23:43:59.491393 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 23:43:59.491271 => 23:43:59.491278
[0m23:43:59.494639 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:43:59.494793 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."launches"
where id is null



      
    ) dbt_internal_test
[0m23:43:59.494970 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 23:43:59.482981 => 23:43:59.494900
[0m23:43:59.494482 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: Close
[0m23:43:59.495784 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:43:59.496253 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 23:43:59.487759 => 23:43:59.496164
[0m23:43:59.496078 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: Close
[0m23:43:59.496990 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:59.499284 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 23:43:59.479200 => 23:43:59.499216
[0m23:43:59.497122 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:59.497127 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:43:59.498728 [info ] [Thread-3 (]: 3 of 8 PASS source_not_null_bronze_rockets_id .................................. [[32mPASS[0m in 0.04s]
[0m23:43:59.497780 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:43:59.497548 [info ] [Thread-1 (]: 1 of 8 PASS source_not_null_bronze_launches_data ............................... [[32mPASS[0m in 0.05s]
[0m23:43:59.499422 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:43:59.499554 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: ROLLBACK
[0m23:43:59.500099 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 23:43:59.485421 => 23:43:59.500035
[0m23:43:59.501523 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 23:43:59.501436 => 23:43:59.501441
[0m23:43:59.502210 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:43:59.500698 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:43:59.502591 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:43:59.500842 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m23:43:59.501639 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: Close
[0m23:43:59.499622 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 23:43:59.491704 => 23:43:59.499553
[0m23:43:59.500300 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 23:43:59.500230 => 23:43:59.500234
[0m23:43:59.501822 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: ROLLBACK
[0m23:43:59.504344 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:43:59.505280 [debug] [Thread-4 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m23:43:59.503880 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:43:59.501070 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:43:59.502737 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:43:59.506633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m23:43:59.503189 [info ] [Thread-3 (]: 5 of 8 START test source_not_null_bronze_starlink_id ........................... [RUN]
[0m23:43:59.505572 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_bronze_starlink_data ............................... [[32mPASS[0m in 0.05s]
[0m23:43:59.507482 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:43:59.505871 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now model.spacex_analytics.starlink_constellation_status)
[0m23:43:59.506208 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 23:43:59.506134 => 23:43:59.506138
[0m23:43:59.507734 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:43:59.503493 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:43:59.507130 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m23:43:59.506446 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:43:59.506714 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: Close
[0m23:43:59.508344 [info ] [Thread-4 (]: 7 of 8 START test source_unique_bronze_rockets_id .............................. [RUN]
[0m23:43:59.510072 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m23:43:59.509058 [info ] [Thread-1 (]: 6 of 8 START test source_unique_bronze_launches_id ............................. [RUN]
[0m23:43:59.510651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m23:43:59.508805 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:43:59.506901 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:43:59.510305 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:43:59.507889 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m23:43:59.508334 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:43:59.514689 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m23:43:59.515281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8, now model.spacex_analytics.starlink_42k_projection)
[0m23:43:59.514385 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m23:43:59.510175 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:43:59.513159 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:43:59.515593 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m23:43:59.509697 [info ] [Thread-2 (]: 2 of 8 PASS source_not_null_bronze_launches_id ................................. [[32mPASS[0m in 0.05s]
[0m23:43:59.510842 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:43:59.517956 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m23:43:59.518175 [debug] [Thread-4 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 23:43:59.513489 => 23:43:59.518078
[0m23:43:59.513072 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:43:59.518913 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 23:43:59.508609 => 23:43:59.518789
[0m23:43:59.521068 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:43:59.517965 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:43:59.520764 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m23:43:59.518454 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:43:59.520476 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 23:43:59.511477 => 23:43:59.520383
[0m23:43:59.520500 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:43:59.522449 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:43:59.521468 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 23:43:59.510996 => 23:43:59.521377
[0m23:43:59.522916 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 23:43:59.522841 => 23:43:59.522845
[0m23:43:59.522001 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:43:59.521673 [debug] [Thread-4 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 23:43:59.521549 => 23:43:59.521551
[0m23:43:59.523016 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:43:59.524100 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m23:43:59.521829 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 23:43:59.516632 => 23:43:59.521773
[0m23:43:59.523332 [info ] [Thread-2 (]: 8 of 8 START test source_unique_bronze_starlink_id ............................. [RUN]
[0m23:43:59.523727 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 23:43:59.518809 => 23:43:59.523657
[0m23:43:59.525497 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m23:43:59.524250 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 23:43:59.513404 => 23:43:59.523832
[0m23:43:59.525089 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:43:59.521382 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 23:43:59.521277 => 23:43:59.521282
[0m23:43:59.525768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m23:43:59.523675 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:43:59.526663 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 23:43:59.526373 => 23:43:59.526378
[0m23:43:59.526246 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:43:59.528285 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m23:43:59.527423 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:43:59.526558 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:43:59.527483 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:43:59.527947 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:43:59.532722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:59.532949 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m23:43:59.533149 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m23:43:59.533347 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m23:43:59.529040 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:43:59.533571 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m23:43:59.530135 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:43:59.534538 [debug] [MainThread]: Command end result
[0m23:43:59.530395 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: BEGIN
[0m23:43:59.535084 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:43:59.533137 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:43:59.535679 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:43:59.536205 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:43:59.536570 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: BEGIN
[0m23:43:59.536830 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: BEGIN
[0m23:43:59.537688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:59.537896 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 23:43:59.530601 => 23:43:59.537794
[0m23:43:59.538768 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:43:59.538254 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:43:59.538086 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.540357 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:43:59.540018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.539725 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:43:59.540736 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."starlink"
where id is null



      
    ) dbt_internal_test
[0m23:43:59.540982 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:43:59.541635 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."launches"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:43:59.541261 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.541861 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:43:59.542010 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:59.542422 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:59.544673 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 23:43:59.528137 => 23:43:59.544605
[0m23:43:59.542959 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: BEGIN
[0m23:43:59.544031 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 23:43:59.524368 => 23:43:59.543935
[0m23:43:59.542618 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:43:59.544962 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: ROLLBACK
[0m23:43:59.545186 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:43:59.546005 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: Close
[0m23:43:59.545688 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."rockets"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:43:59.545433 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: ROLLBACK
[0m23:43:59.546549 [info ] [Thread-1 (]: 6 of 8 PASS source_unique_bronze_launches_id ................................... [[32mPASS[0m in 0.04s]
[0m23:43:59.547486 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:43:59.547759 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: Close
[0m23:43:59.548226 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:59.550863 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:43:59.548650 [info ] [Thread-3 (]: 5 of 8 PASS source_not_null_bronze_starlink_id ................................. [[32mPASS[0m in 0.04s]
[0m23:43:59.551217 [info ] [MainThread]: Building catalog
[0m23:43:59.549595 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.552101 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:43:59.552348 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."starlink"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:43:59.550933 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 23:43:59.529437 => 23:43:59.550846
[0m23:43:59.552703 [debug] [ThreadPool]: Acquiring new postgres connection 'spacex_db.information_schema'
[0m23:43:59.551715 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:43:59.553428 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: ROLLBACK
[0m23:43:59.554043 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:43:59.555992 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 23:43:59.538956 => 23:43:59.555923
[0m23:43:59.556204 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: ROLLBACK
[0m23:43:59.556431 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: Close
[0m23:43:59.556576 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: Close
[0m23:43:59.556363 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m23:43:59.557999 [debug] [ThreadPool]: On spacex_db.information_schema: BEGIN
[0m23:43:59.557025 [info ] [Thread-2 (]: 8 of 8 PASS source_unique_bronze_starlink_id ................................... [[32mPASS[0m in 0.03s]
[0m23:43:59.558266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:59.558591 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:43:59.557796 [info ] [Thread-4 (]: 7 of 8 PASS source_unique_bronze_rockets_id .................................... [[32mPASS[0m in 0.05s]
[0m23:43:59.559817 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.562091 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m23:43:59.562091 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:43:59.562380 [debug] [ThreadPool]: On spacex_db.information_schema: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "spacex_db.information_schema"} */

    
    

    select
        'spacex_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('gold') or upper(sch.nspname) = upper('silver') or upper(sch.nspname) = upper('bronze'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:43:59.563575 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.563776 [debug] [MainThread]: On master: BEGIN
[0m23:43:59.563962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:59.565007 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.0 seconds
[0m23:43:59.565524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.565722 [debug] [MainThread]: On master: COMMIT
[0m23:43:59.565889 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.566047 [debug] [MainThread]: On master: COMMIT
[0m23:43:59.566233 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:59.566417 [debug] [MainThread]: On master: Close
[0m23:43:59.567485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:59.567699 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m23:43:59.567808 [debug] [ThreadPool]: On spacex_db.information_schema: ROLLBACK
[0m23:43:59.567870 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8' was properly closed.
[0m23:43:59.568085 [debug] [ThreadPool]: On spacex_db.information_schema: Close
[0m23:43:59.568139 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m23:43:59.568453 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e' was properly closed.
[0m23:43:59.568687 [info ] [MainThread]: 
[0m23:43:59.569110 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m23:43:59.569761 [debug] [MainThread]: Command end result
[0m23:43:59.574033 [info ] [MainThread]: 
[0m23:43:59.574481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:43:59.574707 [info ] [MainThread]: 
[0m23:43:59.574924 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:43:59.575196 [debug] [MainThread]: Command `dbt test` succeeded at 23:43:59.575145 after 0.26 seconds
[0m23:43:59.575455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb453fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb453d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4aa6d50>]}
[0m23:43:59.575718 [debug] [MainThread]: Flushing usage events
[0m23:43:59.576854 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/target/catalog.json
[0m23:43:59.577568 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:43:59.577502 after 0.27 seconds
[0m23:43:59.577894 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:43:59.578107 [debug] [MainThread]: Connection 'spacex_db.information_schema' was properly closed.
[0m23:43:59.578369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c7a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c79b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff936a2270>]}
[0m23:43:59.578729 [debug] [MainThread]: Flushing usage events
[0m23:44:02.472208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c024a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c54e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c024d70>]}


============================== 23:44:02.473787 | 600cf443-182e-49da-b9d9-97d2384eba31 ==============================
[0m23:44:02.473787 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:44:02.474155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run-operation log_results --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:44:02.510708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '600cf443-182e-49da-b9d9-97d2384eba31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4d92b0>]}
[0m23:44:02.516200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '600cf443-182e-49da-b9d9-97d2384eba31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1486e0>]}
[0m23:44:02.516556 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:44:02.520447 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:44:02.536427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:02.536710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:02.538949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '600cf443-182e-49da-b9d9-97d2384eba31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5d81d0>]}
[0m23:44:02.544262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '600cf443-182e-49da-b9d9-97d2384eba31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b61a930>]}
[0m23:44:02.544552 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:44:02.544762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '600cf443-182e-49da-b9d9-97d2384eba31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0263c0>]}
[0m23:44:02.545123 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_results'
[0m23:44:02.545303 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m23:44:02.545461 [debug] [MainThread]: On macro_log_results: BEGIN
[0m23:44:02.545626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:44:02.547457 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:44:02.547762 [debug] [MainThread]: On macro_log_results: COMMIT
[0m23:44:02.547958 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m23:44:02.548142 [debug] [MainThread]: On macro_log_results: COMMIT
[0m23:44:02.548369 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:44:02.552959 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m23:44:02.553236 [debug] [MainThread]: On macro_log_results: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "macro_log_results"} */

    
    SELECT 
      "🎯 ANSWER: Launches Needed" as launches_needed,
      "🎯 ANSWER: Months to 42K" as months_needed,
      "🎯 ANSWER: Est. Completion Date" as completion_date,
      "CONFIDENCE: Projection Reliability" as confidence
    FROM gold.starlink_42k_projection
    LIMIT 1
  
  
[0m23:44:02.553707 [debug] [MainThread]: Postgres adapter: Postgres error: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^

[0m23:44:02.554003 [debug] [MainThread]: Postgres adapter: Error running SQL: macro log_results
[0m23:44:02.554245 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m23:44:02.554493 [debug] [MainThread]: On macro_log_results: Close
[0m23:44:02.554861 [error] [MainThread]: Encountered an error while running operation: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^
[0m23:44:02.556570 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 73, in exception_handler
    yield
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1054, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 290, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 146, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 84, in exception_handler
    raise dbt.exceptions.DbtDatabaseError(str(e).strip()) from e
dbt.exceptions.DbtDatabaseError: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^

[0m23:44:02.557931 [debug] [MainThread]: Command `dbt run-operation` failed at 23:44:02.557888 after 0.09 seconds
[0m23:44:02.558195 [debug] [MainThread]: Connection 'macro_log_results' was properly closed.
[0m23:44:02.558460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0fdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5b4aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4675f0>]}
[0m23:44:02.558775 [debug] [MainThread]: Flushing usage events
[0m23:47:11.921427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3de720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e154080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4eb7a0>]}


============================== 23:47:11.922973 | ce7adfb2-013c-4e07-99ed-9f1c23d1210b ==============================
[0m23:47:11.922973 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:47:11.923366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:47:11.959520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce7adfb2-013c-4e07-99ed-9f1c23d1210b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed9acf0>]}
[0m23:47:11.965021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce7adfb2-013c-4e07-99ed-9f1c23d1210b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5ad640>]}
[0m23:47:11.965442 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:47:11.969250 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:47:11.988494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:47:11.988779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:47:11.991104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce7adfb2-013c-4e07-99ed-9f1c23d1210b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e03b230>]}
[0m23:47:11.997407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce7adfb2-013c-4e07-99ed-9f1c23d1210b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5eeb40>]}
[0m23:47:11.997714 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:47:11.998093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce7adfb2-013c-4e07-99ed-9f1c23d1210b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e59f6b0>]}
[0m23:47:11.998807 [info ] [MainThread]: 
[0m23:47:11.999251 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:11.999846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m23:47:12.003567 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m23:47:12.003776 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m23:47:12.003946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:12.005864 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:47:12.006513 [debug] [ThreadPool]: On list_spacex_db: Close
[0m23:47:12.007202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold)
[0m23:47:12.007541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m23:47:12.009528 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:47:12.010260 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:47:12.010516 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:47:12.010727 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:47:12.010933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:12.011120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:12.012402 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:12.012700 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:47:12.012531 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:12.012951 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:47:12.013226 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:47:12.013651 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:47:12.014538 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:47:12.015439 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:47:12.015953 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:47:12.016497 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:47:12.016814 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:47:12.017048 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:47:12.019739 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:12.019981 [debug] [MainThread]: On master: BEGIN
[0m23:47:12.020198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:12.021481 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:12.021707 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:12.021930 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:47:12.025763 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:47:12.026363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce7adfb2-013c-4e07-99ed-9f1c23d1210b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d517e00>]}
[0m23:47:12.026641 [debug] [MainThread]: On master: ROLLBACK
[0m23:47:12.026914 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:12.027117 [debug] [MainThread]: On master: BEGIN
[0m23:47:12.027472 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:12.027696 [debug] [MainThread]: On master: COMMIT
[0m23:47:12.027892 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:12.028076 [debug] [MainThread]: On master: COMMIT
[0m23:47:12.028341 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:47:12.028542 [debug] [MainThread]: On master: Close
[0m23:47:12.028875 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:47:12.029258 [info ] [MainThread]: 
[0m23:47:12.030658 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m23:47:12.030852 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m23:47:12.031064 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m23:47:12.031380 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m23:47:12.031792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_42k_projection)
[0m23:47:12.032153 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_constellation_status)
[0m23:47:12.032449 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m23:47:12.032699 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m23:47:12.035701 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m23:47:12.036879 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m23:47:12.038228 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 23:47:12.035944 => 23:47:12.038157
[0m23:47:12.038464 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m23:47:12.038654 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 23:47:12.032930 => 23:47:12.038568
[0m23:47:12.052957 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m23:47:12.053214 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m23:47:12.055030 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m23:47:12.056078 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:47:12.056374 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m23:47:12.056572 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:47:12.056769 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:47:12.057068 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m23:47:12.057627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:12.059766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:12.059953 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:12.060140 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:47:12.060373 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:47:12.060635 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT 
        COUNT(CASE WHEN is_active THEN 1 END) as current_satellites
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_stats AS (
    SELECT 
        COUNT(*) as total_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_launches,
        AVG(CASE WHEN launch_success THEN estimated_satellite_count END)::numeric as avg_sats_per_launch,
        
        -- Recent launch rate (last 12 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as launches_last_12_months
        
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date <= CURRENT_DATE  -- Exclude future launches
)

SELECT 
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current status
    42000 as target_satellites,
    cs.current_satellites,
    (42000 - cs.current_satellites) as satellites_needed,
    ROUND((cs.current_satellites * 100.0 / 42000)::numeric, 1) as progress_percent,
    
    -- Historical performance
    ls.total_launches as total_starlink_launches,
    ls.successful_launches,
    ROUND(ls.avg_sats_per_launch, 0) as avg_satellites_per_launch,
    
    -- Business projections
    CASE 
        WHEN ls.avg_sats_per_launch > 0 THEN
            CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch)
        ELSE NULL
    END as launches_needed,
    
    CASE 
        WHEN ls.launches_last_12_months > 0 AND ls.avg_sats_per_launch > 0 THEN
            ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / (ls.launches_last_12_months / 12.0))::numeric, 1)
        ELSE NULL
    END as months_to_completion,
    
    CASE 
        WHEN ls.launches_last_12_months > 0 AND ls.avg_sats_per_launch > 0 THEN
            (CURRENT_DATE + INTERVAL '1 month' * ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / (ls.launches_last_12_months / 12.0))::numeric, 1))::date
        ELSE NULL
    END as estimated_completion_date,
    
    -- Quality indicators
    CASE 
        WHEN ls.launches_last_12_months >= 6 THEN 'High Confidence'
        WHEN ls.launches_last_12_months >= 3 THEN 'Medium Confidence'
        ELSE 'Low Confidence'
    END as projection_confidence

FROM current_status cs
CROSS JOIN launch_stats ls
  );
  
[0m23:47:12.060892 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    CURRENT_TIMESTAMP as status_date,
    
    -- Current constellation
    COUNT(*) as total_satellites,
    COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
    COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
    
    -- Performance
    ROUND((COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*))::numeric, 1) as active_percentage,
    
    -- Timeline
    MIN(launch_date) as first_launch_date,
    MAX(launch_date) as latest_launch_date,
    
    -- Data quality
    MAX(extracted_at) as last_updated,
    ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 1) as data_age_hours

FROM "spacex_db"."silver"."silver_starlink"
WHERE satellite_id IS NOT NULL
  );
  
[0m23:47:12.067950 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:12.070805 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:47:12.071004 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:12.071152 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m23:47:12.072251 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:47:12.072792 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:47:12.072948 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection" rename to "starlink_42k_projection__dbt_backup"
[0m23:47:12.074065 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:47:12.074437 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m23:47:12.074585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:47:12.074839 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:47:12.076153 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:47:12.084057 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m23:47:12.084442 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp" rename to "starlink_42k_projection"
[0m23:47:12.084803 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:47:12.085269 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m23:47:12.085445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:47:12.086460 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m23:47:12.086614 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:47:12.086814 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:47:12.090107 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:47:12.090517 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m23:47:12.090775 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m23:47:12.091306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:47:12.092764 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:47:12.092969 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:47:12.093193 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
drop table if exists "spacex_db"."gold"."starlink_42k_projection__dbt_backup" cascade
[0m23:47:12.093936 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 23:47:12.038756 => 23:47:12.093868
[0m23:47:12.094347 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m23:47:12.094777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce7adfb2-013c-4e07-99ed-9f1c23d1210b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d54c920>]}
[0m23:47:12.094945 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:47:12.096231 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.06s]
[0m23:47:12.096957 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 23:47:12.053774 => 23:47:12.096891
[0m23:47:12.097272 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m23:47:12.097533 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m23:47:12.099636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce7adfb2-013c-4e07-99ed-9f1c23d1210b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e039df0>]}
[0m23:47:12.100079 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold.starlink_42k_projection ................. [[32mSELECT 1[0m in 0.07s]
[0m23:47:12.100705 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m23:47:12.102007 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:12.102255 [debug] [MainThread]: On master: BEGIN
[0m23:47:12.102514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:12.104064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:12.104269 [debug] [MainThread]: On master: COMMIT
[0m23:47:12.104456 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:12.104618 [debug] [MainThread]: On master: COMMIT
[0m23:47:12.104824 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:47:12.104994 [debug] [MainThread]: On master: Close
[0m23:47:12.105294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:12.105478 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m23:47:12.105633 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m23:47:12.105847 [info ] [MainThread]: 
[0m23:47:12.106065 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:47:12.106472 [debug] [MainThread]: Command end result
[0m23:47:12.111656 [info ] [MainThread]: 
[0m23:47:12.111909 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:47:12.112087 [info ] [MainThread]: 
[0m23:47:12.112276 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:47:12.112536 [debug] [MainThread]: Command `dbt run` succeeded at 23:47:12.112498 after 0.20 seconds
[0m23:47:12.112747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e677920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9c1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7ff680>]}
[0m23:47:12.112965 [debug] [MainThread]: Flushing usage events
[0m23:47:14.907085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8728800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88ad9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d2a8d0>]}


============================== 23:47:14.909079 | bc500c6e-bd9d-4317-bf9a-fcb672a917c5 ==============================
[0m23:47:14.909079 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:47:14.909733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:47:14.911112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d8b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e6cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7edef00>]}


============================== 23:47:14.913777 | 33c323f8-b4cc-4fd1-9077-e681792edcc5 ==============================
[0m23:47:14.913777 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:47:14.914426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:47:14.953299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc500c6e-bd9d-4317-bf9a-fcb672a917c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ea9370>]}
[0m23:47:14.959253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc500c6e-bd9d-4317-bf9a-fcb672a917c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c9ca40>]}
[0m23:47:14.959579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33c323f8-b4cc-4fd1-9077-e681792edcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb72dbe90>]}
[0m23:47:14.959842 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:47:14.964733 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:47:14.965560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33c323f8-b4cc-4fd1-9077-e681792edcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb82415e0>]}
[0m23:47:14.966082 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:47:14.973181 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:47:14.982660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:47:14.983100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:47:14.986368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc500c6e-bd9d-4317-bf9a-fcb672a917c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8aced50>]}
[0m23:47:14.989604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc500c6e-bd9d-4317-bf9a-fcb672a917c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ce61e0>]}
[0m23:47:14.990065 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:47:14.990507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc500c6e-bd9d-4317-bf9a-fcb672a917c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8880b90>]}
[0m23:47:14.991789 [info ] [MainThread]: 
[0m23:47:14.992678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:14.993598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m23:47:14.996019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:47:14.996423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:47:14.998437 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:47:14.999032 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:47:14.998845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m23:47:14.999244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33c323f8-b4cc-4fd1-9077-e681792edcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb72dbb90>]}
[0m23:47:14.999286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:15.000311 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:47:15.001269 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:47:15.001493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:15.003301 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.003606 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:47:15.003848 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:47:15.004834 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.005285 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:47:15.005613 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:47:15.005793 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:47:15.006661 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:47:15.007457 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:47:15.009498 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:47:15.010138 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:47:15.010472 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:47:15.010592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33c323f8-b4cc-4fd1-9077-e681792edcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7342e40>]}
[0m23:47:15.010961 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:47:15.011443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33c323f8-b4cc-4fd1-9077-e681792edcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7342b40>]}
[0m23:47:15.012354 [info ] [MainThread]: 
[0m23:47:15.012814 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:15.013412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m23:47:15.013483 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:15.014040 [debug] [MainThread]: On master: BEGIN
[0m23:47:15.014222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:15.015911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.016141 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:15.016376 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:47:15.013735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m23:47:15.018401 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:47:15.019592 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:47:15.019309 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:47:15.019999 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:47:15.019812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:15.020166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:15.021845 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:47:15.022492 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.022788 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:47:15.022837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc500c6e-bd9d-4317-bf9a-fcb672a917c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d3a810>]}
[0m23:47:15.022667 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.023192 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:47:15.023186 [debug] [MainThread]: On master: ROLLBACK
[0m23:47:15.022994 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:47:15.023600 [debug] [MainThread]: On master: Close
[0m23:47:15.023432 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:47:15.025086 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:47:15.024888 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:47:15.026221 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:47:15.025595 [info ] [MainThread]: 
[0m23:47:15.027534 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:47:15.028630 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:47:15.029334 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m23:47:15.029922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_launches)
[0m23:47:15.029118 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:47:15.029550 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m23:47:15.030807 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_starlink)
[0m23:47:15.030614 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:47:15.030062 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:47:15.031591 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb'
[0m23:47:15.029689 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:47:15.032467 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae'
[0m23:47:15.030245 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m23:47:15.034244 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:15.034540 [debug] [MainThread]: On master: BEGIN
[0m23:47:15.034752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:15.036195 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.036439 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:15.031821 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:47:15.036710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:47:15.040856 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:47:15.031071 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m23:47:15.041655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33c323f8-b4cc-4fd1-9077-e681792edcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7388aa0>]}
[0m23:47:15.042071 [debug] [MainThread]: On master: ROLLBACK
[0m23:47:15.042371 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:15.042610 [debug] [MainThread]: On master: BEGIN
[0m23:47:15.042916 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.032759 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:47:15.043123 [debug] [MainThread]: On master: COMMIT
[0m23:47:15.043461 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:15.043690 [debug] [MainThread]: On master: COMMIT
[0m23:47:15.043947 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:47:15.044154 [debug] [MainThread]: On master: Close
[0m23:47:15.036556 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m23:47:15.041247 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:47:15.043041 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m23:47:15.045570 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:47:15.046290 [info ] [MainThread]: 
[0m23:47:15.044921 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:47:15.047435 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 23:47:15.036911 => 23:47:15.046766
[0m23:47:15.048069 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:47:15.047661 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 23:47:15.033004 => 23:47:15.047581
[0m23:47:15.048917 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m23:47:15.048933 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:47:15.047913 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 23:47:15.041532 => 23:47:15.047836
[0m23:47:15.048797 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 23:47:15.043313 => 23:47:15.048726
[0m23:47:15.048472 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 23:47:15.048389 => 23:47:15.048401
[0m23:47:15.049162 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 23:47:15.049099 => 23:47:15.049103
[0m23:47:15.049083 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:47:15.049431 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m23:47:15.049353 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:47:15.049704 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:47:15.051655 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 23:47:15.051593 => 23:47:15.051595
[0m23:47:15.049748 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:47:15.051994 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_bronze_starlink_data ......................... [RUN]
[0m23:47:15.050791 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m23:47:15.052532 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:47:15.052577 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed'
[0m23:47:15.050282 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:47:15.051405 [info ] [Thread-3 (]: 3 of 8 START test source_not_null_bronze_rockets_id ............................ [RUN]
[0m23:47:15.049600 [info ] [Thread-1 (]: 1 of 8 START test source_not_null_bronze_launches_data ......................... [RUN]
[0m23:47:15.052247 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:47:15.051012 [info ] [Thread-2 (]: 2 of 8 START test source_not_null_bronze_launches_id ........................... [RUN]
[0m23:47:15.051363 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 23:47:15.051260 => 23:47:15.051264
[0m23:47:15.054650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb)
[0m23:47:15.052976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_launches, now test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1)
[0m23:47:15.053565 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:47:15.053716 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1'
[0m23:47:15.055743 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:47:15.055756 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed)
[0m23:47:15.057660 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:47:15.059737 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:47:15.054395 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:47:15.055085 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m23:47:15.055419 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:47:15.053232 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:47:15.060254 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m23:47:15.062938 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:47:15.064362 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:47:15.062638 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:47:15.060547 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:47:15.055314 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:47:15.063105 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 23:47:15.057844 => 23:47:15.063028
[0m23:47:15.054210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae)
[0m23:47:15.066649 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:47:15.062612 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:47:15.064604 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:47:15.066454 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:47:15.065214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_starlink, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m23:47:15.066798 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:47:15.067827 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:47:15.069123 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:47:15.069342 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 23:47:15.062747 => 23:47:15.069238
[0m23:47:15.071094 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:47:15.067274 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 23:47:15.063198 => 23:47:15.067156
[0m23:47:15.071635 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:47:15.067018 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 23:47:15.066950 => 23:47:15.066954
[0m23:47:15.072258 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:47:15.067642 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 23:47:15.060781 => 23:47:15.067582
[0m23:47:15.072875 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:47:15.071405 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:47:15.072501 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:47:15.073857 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m23:47:15.075422 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:47:15.070623 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 23:47:15.055919 => 23:47:15.070561
[0m23:47:15.071867 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 23:47:15.071805 => 23:47:15.071808
[0m23:47:15.077358 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:47:15.077453 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:47:15.077177 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:47:15.077519 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 23:47:15.067864 => 23:47:15.077448
[0m23:47:15.073133 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 23:47:15.073066 => 23:47:15.073068
[0m23:47:15.071380 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 23:47:15.065187 => 23:47:15.071306
[0m23:47:15.078333 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:47:15.077043 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:47:15.078716 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:47:15.074290 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 23:47:15.069283 => 23:47:15.074197
[0m23:47:15.078531 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:47:15.079335 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:47:15.079557 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:47:15.081583 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m23:47:15.081030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m23:47:15.079607 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:47:15.082332 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:47:15.080873 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:47:15.081495 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:47:15.082843 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: BEGIN
[0m23:47:15.083061 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:47:15.082270 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:47:15.082520 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: BEGIN
[0m23:47:15.083606 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:47:15.084414 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: BEGIN
[0m23:47:15.080660 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:47:15.084804 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 23:47:15.084730 => 23:47:15.084734
[0m23:47:15.084169 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:47:15.081339 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 23:47:15.075622 => 23:47:15.081259
[0m23:47:15.085021 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:47:15.085591 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: BEGIN
[0m23:47:15.084266 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:47:15.082075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now model.spacex_analytics.starlink_42k_projection)
[0m23:47:15.086229 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m23:47:15.087617 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m23:47:15.084704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:15.085208 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:47:15.086428 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.088530 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:47:15.088737 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."rockets"
where id is null



      
    ) dbt_internal_test
[0m23:47:15.085480 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:47:15.087039 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.089646 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 23:47:15.089567 => 23:47:15.089571
[0m23:47:15.085863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:47:15.089435 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:15.088483 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m23:47:15.088130 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 23:47:15.082630 => 23:47:15.088037
[0m23:47:15.091165 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:47:15.090131 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:47:15.090917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8, now model.spacex_analytics.starlink_constellation_status)
[0m23:47:15.089868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.092439 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m23:47:15.092720 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:47:15.092980 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."launches"
where data is null



      
    ) dbt_internal_test
[0m23:47:15.092548 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.089692 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:47:15.092132 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 23:47:15.077630 => 23:47:15.091999
[0m23:47:15.093750 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: ROLLBACK
[0m23:47:15.093522 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."starlink"
where data is null



      
    ) dbt_internal_test
[0m23:47:15.093295 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:47:15.094096 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m23:47:15.094019 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: Close
[0m23:47:15.090350 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 23:47:15.086561 => 23:47:15.090264
[0m23:47:15.091623 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 23:47:15.091536 => 23:47:15.091539
[0m23:47:15.095805 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:47:15.094747 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:15.095501 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 23:47:15.092848 => 23:47:15.095436
[0m23:47:15.095215 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m23:47:15.096787 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 23:47:15.096706 => 23:47:15.096709
[0m23:47:15.096416 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m23:47:15.097449 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 23:47:15.097385 => 23:47:15.097388
[0m23:47:15.097190 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m23:47:15.097814 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m23:47:15.094299 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."launches"
where id is null



      
    ) dbt_internal_test
[0m23:47:15.095558 [info ] [Thread-3 (]: 3 of 8 PASS source_not_null_bronze_rockets_id .................................. [[32mPASS[0m in 0.04s]
[0m23:47:15.098593 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:47:15.098102 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 23:47:15.080140 => 23:47:15.098006
[0m23:47:15.100233 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: ROLLBACK
[0m23:47:15.099508 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:47:15.100939 [info ] [Thread-3 (]: 5 of 8 START test source_not_null_bronze_starlink_id ........................... [RUN]
[0m23:47:15.100642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:15.101487 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m23:47:15.099051 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:15.102251 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 23:47:15.081597 => 23:47:15.102179
[0m23:47:15.101696 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m23:47:15.102621 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m23:47:15.099946 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:15.103279 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 23:47:15.071463 => 23:47:15.103214
[0m23:47:15.102811 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m23:47:15.104107 [debug] [MainThread]: Command end result
[0m23:47:15.100771 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: Close
[0m23:47:15.106342 [info ] [Thread-1 (]: 1 of 8 PASS source_not_null_bronze_launches_data ............................... [[32mPASS[0m in 0.05s]
[0m23:47:15.101334 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m23:47:15.107062 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:47:15.102492 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: ROLLBACK
[0m23:47:15.106748 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:47:15.103521 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: ROLLBACK
[0m23:47:15.108940 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:47:15.109419 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: Close
[0m23:47:15.109635 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:47:15.110196 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: Close
[0m23:47:15.111012 [info ] [Thread-2 (]: 2 of 8 PASS source_not_null_bronze_launches_id ................................. [[32mPASS[0m in 0.06s]
[0m23:47:15.111456 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 23:47:15.107226 => 23:47:15.111387
[0m23:47:15.111774 [info ] [Thread-1 (]: 6 of 8 START test source_unique_bronze_launches_id ............................. [RUN]
[0m23:47:15.115009 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:47:15.112846 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_bronze_starlink_data ............................... [[32mPASS[0m in 0.06s]
[0m23:47:15.115264 [info ] [MainThread]: Building catalog
[0m23:47:15.115455 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:47:15.115753 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:47:15.114688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m23:47:15.116364 [debug] [ThreadPool]: Acquiring new postgres connection 'spacex_db.information_schema'
[0m23:47:15.113974 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:47:15.114227 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:47:15.116583 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:47:15.119074 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m23:47:15.119313 [debug] [ThreadPool]: On spacex_db.information_schema: BEGIN
[0m23:47:15.119519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:15.116223 [info ] [Thread-4 (]: 7 of 8 START test source_unique_bronze_rockets_id .............................. [RUN]
[0m23:47:15.120891 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m23:47:15.121096 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.121133 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:47:15.121302 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m23:47:15.120507 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:47:15.116831 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:47:15.122667 [debug] [ThreadPool]: On spacex_db.information_schema: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "spacex_db.information_schema"} */

    
    

    select
        'spacex_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('gold') or upper(sch.nspname) = upper('bronze') or upper(sch.nspname) = upper('silver'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:47:15.117945 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:47:15.122540 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:47:15.123059 [info ] [Thread-2 (]: 8 of 8 START test source_unique_bronze_starlink_id ............................. [RUN]
[0m23:47:15.123897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m23:47:15.124166 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:47:15.124814 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.0 seconds
[0m23:47:15.124562 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 23:47:15.118141 => 23:47:15.124495
[0m23:47:15.124411 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 23:47:15.121367 => 23:47:15.124339
[0m23:47:15.125965 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:47:15.126097 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:47:15.127039 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: BEGIN
[0m23:47:15.126508 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:47:15.127483 [debug] [ThreadPool]: On spacex_db.information_schema: ROLLBACK
[0m23:47:15.126313 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:47:15.128434 [debug] [ThreadPool]: On spacex_db.information_schema: Close
[0m23:47:15.127292 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:47:15.127549 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 23:47:15.124635 => 23:47:15.127491
[0m23:47:15.130395 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:47:15.129743 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:47:15.128295 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:47:15.132206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.131702 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:47:15.132955 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:47:15.133588 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."starlink"
where id is null



      
    ) dbt_internal_test
[0m23:47:15.133837 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:47:15.134794 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: BEGIN
[0m23:47:15.134992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:47:15.134563 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:47:15.134403 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:15.134690 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:47:15.136711 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: BEGIN
[0m23:47:15.136283 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 23:47:15.117172 => 23:47:15.136218
[0m23:47:15.135325 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: BEGIN
[0m23:47:15.137083 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.137262 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:47:15.137584 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: ROLLBACK
[0m23:47:15.137834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:15.140560 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/target/catalog.json
[0m23:47:15.139928 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:47:15.141639 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."rockets"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:47:15.142257 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:47:15.142183 after 0.24 seconds
[0m23:47:15.140852 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: Close
[0m23:47:15.143102 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:47:15.144044 [debug] [MainThread]: Connection 'spacex_db.information_schema' was properly closed.
[0m23:47:15.144431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88ad9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb913ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d3a960>]}
[0m23:47:15.144840 [debug] [MainThread]: Flushing usage events
[0m23:47:15.143240 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.145810 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:47:15.145095 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:15.145654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.144304 [info ] [Thread-3 (]: 5 of 8 PASS source_not_null_bronze_starlink_id ................................. [[32mPASS[0m in 0.04s]
[0m23:47:15.147810 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:47:15.147142 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 23:47:15.127627 => 23:47:15.147064
[0m23:47:15.147446 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:47:15.146343 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."starlink"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:47:15.150211 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: ROLLBACK
[0m23:47:15.151458 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: Close
[0m23:47:15.150584 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."launches"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:47:15.153364 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:15.152490 [info ] [Thread-4 (]: 7 of 8 PASS source_unique_bronze_rockets_id .................................... [[32mPASS[0m in 0.03s]
[0m23:47:15.154550 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 23:47:15.130746 => 23:47:15.154475
[0m23:47:15.155816 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: ROLLBACK
[0m23:47:15.155474 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:47:15.155287 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:47:15.156052 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: Close
[0m23:47:15.156647 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 23:47:15.128497 => 23:47:15.156571
[0m23:47:15.158510 [info ] [Thread-2 (]: 8 of 8 PASS source_unique_bronze_starlink_id ................................... [[32mPASS[0m in 0.03s]
[0m23:47:15.159197 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:47:15.158850 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: ROLLBACK
[0m23:47:15.159783 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: Close
[0m23:47:15.160176 [info ] [Thread-1 (]: 6 of 8 PASS source_unique_bronze_launches_id ................................... [[32mPASS[0m in 0.05s]
[0m23:47:15.161065 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:47:15.162309 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:15.162505 [debug] [MainThread]: On master: BEGIN
[0m23:47:15.162686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:15.163976 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:15.164216 [debug] [MainThread]: On master: COMMIT
[0m23:47:15.164450 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:15.164671 [debug] [MainThread]: On master: COMMIT
[0m23:47:15.164915 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:47:15.165106 [debug] [MainThread]: On master: Close
[0m23:47:15.165482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:15.165945 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m23:47:15.166131 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8' was properly closed.
[0m23:47:15.166305 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m23:47:15.166477 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e' was properly closed.
[0m23:47:15.166673 [info ] [MainThread]: 
[0m23:47:15.166952 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m23:47:15.167540 [debug] [MainThread]: Command end result
[0m23:47:15.171351 [info ] [MainThread]: 
[0m23:47:15.171613 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:47:15.171808 [info ] [MainThread]: 
[0m23:47:15.172008 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:47:15.172270 [debug] [MainThread]: Command `dbt test` succeeded at 23:47:15.172235 after 0.27 seconds
[0m23:47:15.172501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e6cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb838a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7efbd70>]}
[0m23:47:15.172724 [debug] [MainThread]: Flushing usage events
[0m23:47:17.795664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e39250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f0d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8533a1e0>]}


============================== 23:47:17.797169 | 17d1ec8e-c766-4507-8a92-bb13c228be4b ==============================
[0m23:47:17.797169 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:47:17.797519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run-operation log_results --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m23:47:17.835657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17d1ec8e-c766-4507-8a92-bb13c228be4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843afb60>]}
[0m23:47:17.841305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17d1ec8e-c766-4507-8a92-bb13c228be4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843ac1a0>]}
[0m23:47:17.841690 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:47:17.845701 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:47:17.862249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:47:17.862531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:47:17.864765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17d1ec8e-c766-4507-8a92-bb13c228be4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84383a10>]}
[0m23:47:17.870482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17d1ec8e-c766-4507-8a92-bb13c228be4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843edf70>]}
[0m23:47:17.870767 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:47:17.871188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17d1ec8e-c766-4507-8a92-bb13c228be4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e58380>]}
[0m23:47:17.871587 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_results'
[0m23:47:17.871839 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m23:47:17.872065 [debug] [MainThread]: On macro_log_results: BEGIN
[0m23:47:17.872286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:17.874220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:47:17.874411 [debug] [MainThread]: On macro_log_results: COMMIT
[0m23:47:17.874576 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m23:47:17.874734 [debug] [MainThread]: On macro_log_results: COMMIT
[0m23:47:17.874934 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:47:17.879482 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m23:47:17.879736 [debug] [MainThread]: On macro_log_results: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "macro_log_results"} */

    
    SELECT 
      "🎯 ANSWER: Launches Needed" as launches_needed,
      "🎯 ANSWER: Months to 42K" as months_needed,
      "🎯 ANSWER: Est. Completion Date" as completion_date,
      "CONFIDENCE: Projection Reliability" as confidence
    FROM gold.starlink_42k_projection
    LIMIT 1
  
  
[0m23:47:17.880104 [debug] [MainThread]: Postgres adapter: Postgres error: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^

[0m23:47:17.880403 [debug] [MainThread]: Postgres adapter: Error running SQL: macro log_results
[0m23:47:17.880629 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m23:47:17.880866 [debug] [MainThread]: On macro_log_results: Close
[0m23:47:17.881224 [error] [MainThread]: Encountered an error while running operation: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^
[0m23:47:17.882857 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 73, in exception_handler
    yield
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1054, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 290, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 146, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 84, in exception_handler
    raise dbt.exceptions.DbtDatabaseError(str(e).strip()) from e
dbt.exceptions.DbtDatabaseError: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^

[0m23:47:17.884105 [debug] [MainThread]: Command `dbt run-operation` failed at 23:47:17.884060 after 0.09 seconds
[0m23:47:17.884315 [debug] [MainThread]: Connection 'macro_log_results' was properly closed.
[0m23:47:17.884503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f5b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84313d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84312e70>]}
[0m23:47:17.884692 [debug] [MainThread]: Flushing usage events
[0m23:51:08.755124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb1b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80167320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff8ba40>]}


============================== 23:51:08.756652 | 4601368c-4283-4013-838f-0c9322c860fb ==============================
[0m23:51:08.756652 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:51:08.757012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:51:08.772785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4601368c-4283-4013-838f-0c9322c860fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb77080>]}
[0m23:51:08.773329 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:51:08.773687 [debug] [MainThread]: Command `dbt deps` succeeded at 23:51:08.773641 after 0.02 seconds
[0m23:51:08.773938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fc38170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff8ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ffd3e60>]}
[0m23:51:08.774178 [debug] [MainThread]: Flushing usage events
[0m23:51:10.833514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8304e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8307a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82adcb60>]}


============================== 23:51:10.835037 | c9e87c29-87b4-4870-9486-02bf9d761f74 ==============================
[0m23:51:10.835037 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:51:10.835401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models silver --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:51:10.871130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9e87c29-87b4-4870-9486-02bf9d761f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820aaf90>]}
[0m23:51:10.876639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9e87c29-87b4-4870-9486-02bf9d761f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fc4e60>]}
[0m23:51:10.877002 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:51:10.880679 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:51:10.895980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:10.896231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:10.898377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9e87c29-87b4-4870-9486-02bf9d761f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820e6000>]}
[0m23:51:10.903477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9e87c29-87b4-4870-9486-02bf9d761f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82119cd0>]}
[0m23:51:10.903772 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:51:10.903995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9e87c29-87b4-4870-9486-02bf9d761f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82bceb10>]}
[0m23:51:10.904708 [info ] [MainThread]: 
[0m23:51:10.905077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:10.905669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m23:51:10.909326 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m23:51:10.909585 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m23:51:10.909808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:10.911857 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:51:10.912459 [debug] [ThreadPool]: On list_spacex_db: Close
[0m23:51:10.913127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_silver)
[0m23:51:10.913513 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m23:51:10.915492 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:51:10.916293 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:51:10.916541 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:51:10.916767 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:51:10.916958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:10.917158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:10.918354 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:10.918609 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:51:10.918865 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:51:10.919196 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:10.920236 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:10.920380 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:51:10.921052 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:51:10.921399 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:51:10.921733 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:51:10.922825 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:10.923550 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:51:10.923845 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:51:10.926315 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:10.926563 [debug] [MainThread]: On master: BEGIN
[0m23:51:10.926783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:10.928224 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:10.928470 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:10.928783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:10.932605 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:10.933154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9e87c29-87b4-4870-9486-02bf9d761f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820c7f20>]}
[0m23:51:10.933448 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:10.933744 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:10.933971 [debug] [MainThread]: On master: BEGIN
[0m23:51:10.934330 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:10.934567 [debug] [MainThread]: On master: COMMIT
[0m23:51:10.934816 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:10.935053 [debug] [MainThread]: On master: COMMIT
[0m23:51:10.935341 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:10.935559 [debug] [MainThread]: On master: Close
[0m23:51:10.935929 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:10.936554 [info ] [MainThread]: 
[0m23:51:10.937878 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m23:51:10.938060 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m23:51:10.938277 [info ] [Thread-1 (]: 1 of 2 START sql view model silver.silver_launches ............................. [RUN]
[0m23:51:10.938632 [info ] [Thread-2 (]: 2 of 2 START sql view model silver.silver_starlink ............................. [RUN]
[0m23:51:10.939010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_launches)
[0m23:51:10.939372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_starlink)
[0m23:51:10.939724 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m23:51:10.939989 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m23:51:10.943012 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m23:51:10.944456 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m23:51:10.945995 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 23:51:10.943267 => 23:51:10.945899
[0m23:51:10.946225 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m23:51:10.946418 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 23:51:10.940230 => 23:51:10.946336
[0m23:51:10.958646 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m23:51:10.958895 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.silver_starlink"
[0m23:51:10.960154 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.silver_launches"
[0m23:51:10.963474 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m23:51:10.963750 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: BEGIN
[0m23:51:10.963902 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m23:51:10.964051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:10.964338 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: BEGIN
[0m23:51:10.964854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:10.966362 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:10.966691 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m23:51:10.966582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:10.967305 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m23:51:10.966983 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

  create view "spacex_db"."silver"."silver_starlink__dbt_tmp"
    
    
  as (
    

WITH parsed_starlink AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as satellite_id,
        data->'spaceTrack'->>'OBJECT_NAME' as satellite_name,
        data->>'launch' as launch_id,
        
        -- Launch and creation dates
        CASE 
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'LAUNCH_DATE')::date 
            ELSE NULL 
        END as launch_date,
        
        CASE 
            WHEN data->'spaceTrack'->>'CREATION_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'CREATION_DATE')::timestamp 
            ELSE NULL 
        END as tracking_creation_date,
        
        -- Satellite status determination (multiple fallback methods)
        CASE 
            -- Primary: DECAYED field
            WHEN data->'spaceTrack'->>'DECAYED' = '0' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'false' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'False' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = '1' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'true' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'True' THEN false
            -- Fallback: DECAY_DATE field
            WHEN data->'spaceTrack'->>'DECAY_DATE' IS NULL OR data->'spaceTrack'->>'DECAY_DATE' = '' THEN true
            ELSE false
        END as is_active,
        
        -- Orbital parameters (parsed to numeric types)
        CASE 
            WHEN data->'spaceTrack'->>'INCLINATION' IS NOT NULL 
            THEN (data->'spaceTrack'->>'INCLINATION')::numeric 
            ELSE NULL 
        END as inclination_deg,
        
        CASE 
            WHEN data->'spaceTrack'->>'SEMIMAJOR_AXIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'SEMIMAJOR_AXIS')::numeric 
            ELSE NULL 
        END as semimajor_axis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIOD' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIOD')::numeric 
            ELSE NULL 
        END as orbital_period_min,
        
        CASE 
            WHEN data->'spaceTrack'->>'APOAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'APOAPSIS')::numeric 
            ELSE NULL 
        END as apoapsis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIAPSIS')::numeric 
            ELSE NULL 
        END as periapsis_km,
        
        -- Current position data (if available)
        CASE 
            WHEN data->>'longitude' IS NOT NULL 
            THEN (data->>'longitude')::numeric 
            ELSE NULL 
        END as longitude,
        
        CASE 
            WHEN data->>'latitude' IS NOT NULL 
            THEN (data->>'latitude')::numeric 
            ELSE NULL 
        END as latitude,
        
        CASE 
            WHEN data->>'height_km' IS NOT NULL 
            THEN (data->>'height_km')::numeric 
            ELSE NULL 
        END as altitude_km,
        
        CASE 
            WHEN data->>'velocity_kms' IS NOT NULL 
            THEN (data->>'velocity_kms')::numeric 
            ELSE NULL 
        END as velocity_kms,
        
        -- Tracking information
        data->'spaceTrack'->>'NORAD_CAT_ID' as norad_catalog_id,
        data->'spaceTrack'->>'OBJECT_ID' as object_id,
        data->'spaceTrack'->>'DECAY_DATE' as decay_date_raw,
        
        -- Data quality assessment
        CASE 
            WHEN data->'spaceTrack'->>'OBJECT_NAME' IS NULL THEN 'missing_satellite_name'
            WHEN data->>'launch' IS NULL THEN 'missing_launch_reference'
            WHEN data->'spaceTrack'->>'DECAYED' IS NULL AND data->'spaceTrack'->>'DECAY_DATE' IS NULL THEN 'missing_status_info'
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NULL THEN 'missing_launch_date'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."starlink"
    WHERE data IS NOT NULL
)

SELECT 
    satellite_id,
    satellite_name,
    launch_id,
    launch_date,
    tracking_creation_date,
    is_active,
    inclination_deg,
    semimajor_axis_km,
    orbital_period_min,
    apoapsis_km,
    periapsis_km,
    longitude,
    latitude,
    altitude_km,
    velocity_kms,
    norad_catalog_id,
    object_id,
    decay_date_raw,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    CASE 
        WHEN semimajor_axis_km IS NOT NULL 
        THEN semimajor_axis_km - 6371.0  -- Convert to altitude above Earth's surface
        ELSE NULL 
    END as calculated_altitude_km,
    
    -- Orbital regime classification
    CASE 
        WHEN semimajor_axis_km - 6371.0 BETWEEN 160 AND 2000 THEN 'Low Earth Orbit (LEO)'
        WHEN semimajor_axis_km - 6371.0 BETWEEN 2000 AND 35786 THEN 'Medium Earth Orbit (MEO)'
        WHEN semimajor_axis_km - 6371.0 > 35786 THEN 'Geostationary Orbit (GEO)'
        ELSE 'Unknown'
    END as orbital_regime,
    
    -- Age calculation
    CASE 
        WHEN launch_date IS NOT NULL 
        THEN CURRENT_DATE - launch_date 
        ELSE NULL 
    END as satellite_age_days

FROM parsed_starlink
WHERE satellite_id IS NOT NULL

-- Add model documentation

  );
[0m23:51:10.967616 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

  create view "spacex_db"."silver"."silver_launches__dbt_tmp"
    
    
  as (
    

WITH parsed_launches AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as launch_id,
        data->>'name' as mission_name,
        
        -- Date and time parsing
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp 
            ELSE NULL 
        END as launch_date_utc,
        
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp::date 
            ELSE NULL 
        END as launch_date,
        
        -- Launch outcome
        CASE 
            WHEN (data->'success')::text = 'true' THEN true
            WHEN (data->'success')::text = 'false' THEN false
            ELSE NULL
        END as launch_success,
        
        CASE 
            WHEN (data->'upcoming')::text = 'true' THEN true
            WHEN (data->'upcoming')::text = 'false' THEN false
            ELSE NULL
        END as is_upcoming,
        
        -- Technical details
        data->>'rocket' as rocket_id,
        
        CASE 
            WHEN data->>'flight_number' IS NOT NULL 
            THEN (data->>'flight_number')::integer 
            ELSE NULL 
        END as flight_number,
        
        data->>'launchpad' as launchpad_id,
        data->>'details' as mission_details,
        
        -- Business logic: Starlink mission identification
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN true
            WHEN LOWER(data->>'name') LIKE '%starship%' AND LOWER(data->>'name') LIKE '%starlink%' THEN true
            ELSE false
        END as is_starlink_mission,
        
        -- Satellite count estimation for Starlink missions
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN
                CASE 
                    -- Early test missions
                    WHEN LOWER(data->>'name') LIKE '%demo%' 
                      OR LOWER(data->>'name') LIKE '%test%' 
                      OR data->>'name' ILIKE '%tintin%' THEN 2
                    -- V1.0 missions (60 satellites each)
                    WHEN data->>'name' ILIKE '%v1.0%' THEN 60
                    -- V2 missions (larger satellites, fewer per launch)
                    WHEN data->>'name' ILIKE '%v2%' THEN 23
                    -- Standard production batches
                    ELSE 60
                END
            ELSE 0
        END as estimated_satellite_count,
        
        -- Payload analysis
        CASE 
            WHEN data->'payloads' IS NOT NULL 
            THEN jsonb_array_length(data->'payloads') 
            ELSE 0 
        END as payload_count,
        
        -- Data quality assessment
        CASE 
            WHEN data->>'date_utc' IS NULL THEN 'missing_launch_date'
            WHEN data->>'name' IS NULL THEN 'missing_mission_name'
            WHEN (data->'success') IS NULL AND (data->'upcoming')::text = 'false' THEN 'missing_success_status'
            WHEN data->>'rocket' IS NULL THEN 'missing_rocket_info'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."launches"
    WHERE data IS NOT NULL
)

SELECT 
    launch_id,
    mission_name,
    launch_date_utc,
    launch_date,
    launch_success,
    is_upcoming,
    rocket_id,
    flight_number,
    launchpad_id,
    mission_details,
    is_starlink_mission,
    estimated_satellite_count,
    payload_count,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    EXTRACT(YEAR FROM launch_date_utc) as launch_year,
    EXTRACT(MONTH FROM launch_date_utc) as launch_month,
    EXTRACT(DOW FROM launch_date_utc) as launch_day_of_week,
    
    -- Mission type classification
    CASE 
        WHEN is_starlink_mission THEN 'Starlink'
        WHEN LOWER(mission_name) LIKE '%crew%' THEN 'Crew'
        WHEN LOWER(mission_name) LIKE '%cargo%' OR LOWER(mission_name) LIKE '%crs%' THEN 'Cargo'
        WHEN LOWER(mission_name) LIKE '%satellite%' THEN 'Commercial Satellite'
        ELSE 'Other'
    END as mission_type

FROM parsed_launches
WHERE launch_id IS NOT NULL

-- Add model documentation

  );
[0m23:51:10.969689 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:51:10.973093 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m23:51:10.970937 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:51:10.974423 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m23:51:10.973367 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
alter table "spacex_db"."silver"."silver_starlink" rename to "silver_starlink__dbt_backup"
[0m23:51:10.974696 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
alter table "spacex_db"."silver"."silver_launches" rename to "silver_launches__dbt_backup"
[0m23:51:10.975184 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:10.976460 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m23:51:10.975559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:10.977774 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m23:51:10.976728 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
alter table "spacex_db"."silver"."silver_starlink__dbt_tmp" rename to "silver_starlink"
[0m23:51:10.978044 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
alter table "spacex_db"."silver"."silver_launches__dbt_tmp" rename to "silver_launches"
[0m23:51:10.978513 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:10.978873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:10.985857 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m23:51:10.984794 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m23:51:10.986390 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

        COMMENT ON VIEW "spacex_db"."silver"."silver_starlink" IS 'Cleaned Starlink satellite data with active status determination and orbital parameters'
      
[0m23:51:10.986141 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

        COMMENT ON VIEW "spacex_db"."silver"."silver_launches" IS 'Cleaned launch data with Starlink mission identification and satellite count estimation'
      
[0m23:51:10.986803 [debug] [Thread-2 (]: SQL status: COMMENT in 0.0 seconds
[0m23:51:10.987366 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m23:51:10.987011 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m23:51:10.988014 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m23:51:10.987619 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m23:51:10.988523 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m23:51:10.988264 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m23:51:10.989111 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m23:51:10.989242 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:51:10.992052 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m23:51:10.992195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:51:10.992383 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
drop view if exists "spacex_db"."silver"."silver_starlink__dbt_backup" cascade
[0m23:51:10.993549 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m23:51:10.994250 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
drop view if exists "spacex_db"."silver"."silver_launches__dbt_backup" cascade
[0m23:51:10.994418 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:51:10.995256 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 23:51:10.946518 => 23:51:10.995192
[0m23:51:10.995398 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:51:10.995564 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: Close
[0m23:51:10.996126 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 23:51:10.959011 => 23:51:10.996069
[0m23:51:10.996553 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9e87c29-87b4-4870-9486-02bf9d761f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8203b710>]}
[0m23:51:10.997316 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: Close
[0m23:51:10.997671 [info ] [Thread-2 (]: 2 of 2 OK created sql view model silver.silver_starlink ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m23:51:10.998535 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m23:51:10.998658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9e87c29-87b4-4870-9486-02bf9d761f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82043a70>]}
[0m23:51:10.999061 [info ] [Thread-1 (]: 1 of 2 OK created sql view model silver.silver_launches ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m23:51:10.999431 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m23:51:11.000832 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:11.001033 [debug] [MainThread]: On master: BEGIN
[0m23:51:11.001193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:11.002500 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:11.002711 [debug] [MainThread]: On master: COMMIT
[0m23:51:11.002902 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:11.003121 [debug] [MainThread]: On master: COMMIT
[0m23:51:11.003387 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:11.003586 [debug] [MainThread]: On master: Close
[0m23:51:11.003914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:11.004485 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_starlink' was properly closed.
[0m23:51:11.004685 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_launches' was properly closed.
[0m23:51:11.004902 [info ] [MainThread]: 
[0m23:51:11.005173 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m23:51:11.005544 [debug] [MainThread]: Command end result
[0m23:51:11.010172 [info ] [MainThread]: 
[0m23:51:11.010425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:11.010614 [info ] [MainThread]: 
[0m23:51:11.010841 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:51:11.011106 [debug] [MainThread]: Command `dbt run` succeeded at 23:51:11.011074 after 0.18 seconds
[0m23:51:11.011335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872f7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ca5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83458c20>]}
[0m23:51:11.011554 [debug] [MainThread]: Flushing usage events
[0m23:51:14.070328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa569b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa577fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5817fe0>]}


============================== 23:51:14.071828 | 1e8033b1-9a68-47ec-beaf-21d168031b6c ==============================
[0m23:51:14.071828 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:51:14.072193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:51:14.108567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e8033b1-9a68-47ec-beaf-21d168031b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56cc6e0>]}
[0m23:51:14.114109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e8033b1-9a68-47ec-beaf-21d168031b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa577fd70>]}
[0m23:51:14.114494 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:51:14.118220 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:51:14.134152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:14.134409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:14.136620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e8033b1-9a68-47ec-beaf-21d168031b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5699c70>]}
[0m23:51:14.141554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e8033b1-9a68-47ec-beaf-21d168031b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c62630>]}
[0m23:51:14.141808 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:51:14.142038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e8033b1-9a68-47ec-beaf-21d168031b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c62330>]}
[0m23:51:14.142706 [info ] [MainThread]: 
[0m23:51:14.143109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:14.143681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m23:51:14.147615 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m23:51:14.147932 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m23:51:14.148185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:14.150417 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:51:14.151036 [debug] [ThreadPool]: On list_spacex_db: Close
[0m23:51:14.151734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_silver)
[0m23:51:14.152047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m23:51:14.154042 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:51:14.154787 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:51:14.155062 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:51:14.155307 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:51:14.155569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:14.155793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:14.157293 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:14.157650 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:51:14.157783 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:14.157955 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:51:14.158263 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:51:14.158663 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:51:14.159443 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:14.159626 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:14.160131 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:51:14.160787 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:51:14.161086 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:51:14.161276 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:51:14.164156 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:14.164413 [debug] [MainThread]: On master: BEGIN
[0m23:51:14.164652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:14.166068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:14.166308 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:14.166586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:14.170483 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:14.171048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e8033b1-9a68-47ec-beaf-21d168031b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56cca40>]}
[0m23:51:14.171344 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:14.171624 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:14.171840 [debug] [MainThread]: On master: BEGIN
[0m23:51:14.172176 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:14.172454 [debug] [MainThread]: On master: COMMIT
[0m23:51:14.172679 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:14.172901 [debug] [MainThread]: On master: COMMIT
[0m23:51:14.173178 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:14.173409 [debug] [MainThread]: On master: Close
[0m23:51:14.173767 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:14.174373 [info ] [MainThread]: 
[0m23:51:14.175725 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m23:51:14.175891 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m23:51:14.176470 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m23:51:14.176128 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m23:51:14.176865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_constellation_status)
[0m23:51:14.177196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_42k_projection)
[0m23:51:14.177437 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m23:51:14.177786 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m23:51:14.180618 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m23:51:14.181896 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m23:51:14.183250 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 23:51:14.178000 => 23:51:14.183170
[0m23:51:14.183512 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m23:51:14.183728 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 23:51:14.180867 => 23:51:14.183623
[0m23:51:14.195636 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m23:51:14.201300 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m23:51:14.199946 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m23:51:14.202547 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:51:14.202794 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m23:51:14.202954 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:51:14.203092 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:14.203332 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m23:51:14.203769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:14.206283 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:14.206473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:14.206836 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:51:14.206618 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:51:14.207366 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    CURRENT_TIMESTAMP as status_date,
    
    -- Current constellation
    COUNT(*) as total_satellites,
    COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
    COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
    
    -- Performance
    ROUND((COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*))::numeric, 1) as active_percentage,
    
    -- Timeline
    MIN(launch_date) as first_launch_date,
    MAX(launch_date) as latest_launch_date,
    
    -- Data quality
    MAX(extracted_at) as last_updated,
    ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 1) as data_age_hours

FROM "spacex_db"."silver"."silver_starlink"
WHERE satellite_id IS NOT NULL
  );
  
[0m23:51:14.207083 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT 
        COUNT(CASE WHEN is_active THEN 1 END) as current_satellites
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_stats AS (
    SELECT 
        COUNT(*) as total_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_launches,
        AVG(CASE WHEN launch_success THEN estimated_satellite_count END)::numeric as avg_sats_per_launch,
        
        -- Recent launch rate (last 12 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as launches_last_12_months
        
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date <= CURRENT_DATE  -- Exclude future launches
)

SELECT 
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current status
    42000 as target_satellites,
    cs.current_satellites,
    (42000 - cs.current_satellites) as satellites_needed,
    ROUND((cs.current_satellites * 100.0 / 42000)::numeric, 1) as progress_percent,
    
    -- Historical performance
    ls.total_launches as total_starlink_launches,
    ls.successful_launches,
    ROUND(ls.avg_sats_per_launch, 0) as avg_satellites_per_launch,
    
    -- Business projections
    CASE 
        WHEN ls.avg_sats_per_launch > 0 THEN
            CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch)
        ELSE NULL
    END as launches_needed,
    
    CASE 
        WHEN ls.launches_last_12_months > 0 AND ls.avg_sats_per_launch > 0 THEN
            ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / (ls.launches_last_12_months / 12.0))::numeric, 1)
        ELSE NULL
    END as months_to_completion,
    
    CASE 
        WHEN ls.launches_last_12_months > 0 AND ls.avg_sats_per_launch > 0 THEN
            (CURRENT_DATE + INTERVAL '1 month' * ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / (ls.launches_last_12_months / 12.0))::numeric, 1))::date
        ELSE NULL
    END as estimated_completion_date,
    
    -- Quality indicators
    CASE 
        WHEN ls.launches_last_12_months >= 6 THEN 'High Confidence'
        WHEN ls.launches_last_12_months >= 3 THEN 'Medium Confidence'
        ELSE 'Low Confidence'
    END as projection_confidence

FROM current_status cs
CROSS JOIN launch_stats ls
  );
  
[0m23:51:14.213347 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:51:14.215904 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:51:14.216169 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m23:51:14.216481 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:14.217497 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:51:14.217636 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:51:14.217776 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m23:51:14.218855 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:51:14.219195 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:14.219363 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection" rename to "starlink_42k_projection__dbt_backup"
[0m23:51:14.226206 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m23:51:14.226522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:14.226681 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:51:14.227797 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:51:14.228056 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m23:51:14.228357 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp" rename to "starlink_42k_projection"
[0m23:51:14.228867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:51:14.229076 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:51:14.229774 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m23:51:14.232687 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m23:51:14.232958 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:51:14.233184 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m23:51:14.233421 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m23:51:14.234089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:51:14.234225 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:51:14.235107 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m23:51:14.235744 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 23:51:14.183969 => 23:51:14.235681
[0m23:51:14.236002 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
drop table if exists "spacex_db"."gold"."starlink_42k_projection__dbt_backup" cascade
[0m23:51:14.236229 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m23:51:14.236714 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8033b1-9a68-47ec-beaf-21d168031b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4bbc920>]}
[0m23:51:14.237107 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:51:14.238039 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.06s]
[0m23:51:14.238806 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 23:51:14.200055 => 23:51:14.238752
[0m23:51:14.239103 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m23:51:14.239336 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m23:51:14.240452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8033b1-9a68-47ec-beaf-21d168031b6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b997f0>]}
[0m23:51:14.241132 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold.starlink_42k_projection ................. [[32mSELECT 1[0m in 0.06s]
[0m23:51:14.241448 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m23:51:14.242596 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:14.242815 [debug] [MainThread]: On master: BEGIN
[0m23:51:14.242997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:14.244433 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:14.244648 [debug] [MainThread]: On master: COMMIT
[0m23:51:14.244831 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:14.245006 [debug] [MainThread]: On master: COMMIT
[0m23:51:14.245216 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:14.245408 [debug] [MainThread]: On master: Close
[0m23:51:14.245711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:14.246221 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m23:51:14.246414 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m23:51:14.246622 [info ] [MainThread]: 
[0m23:51:14.246888 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m23:51:14.247232 [debug] [MainThread]: Command end result
[0m23:51:14.251549 [info ] [MainThread]: 
[0m23:51:14.251802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:14.251995 [info ] [MainThread]: 
[0m23:51:14.252197 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:51:14.252463 [debug] [MainThread]: Command `dbt run` succeeded at 23:51:14.252429 after 0.19 seconds
[0m23:51:14.252706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63c2630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5df1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5a4e7e0>]}
[0m23:51:14.252924 [debug] [MainThread]: Flushing usage events
[0m23:51:17.119389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8db620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa5df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa2a8d0>]}


============================== 23:51:17.121363 | 1d5d21f7-94ac-45e3-83be-d011d1e0dc2d ==============================
[0m23:51:17.121363 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:51:17.121976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:51:17.142971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d746fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5a8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5ea630>]}


============================== 23:51:17.145041 | 671983c3-1dac-48d2-a7e5-f4ccc64af941 ==============================
[0m23:51:17.145041 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:51:17.145567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:51:17.165217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d5d21f7-94ac-45e3-83be-d011d1e0dc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8ffa40>]}
[0m23:51:17.171117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d5d21f7-94ac-45e3-83be-d011d1e0dc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e4c1a0>]}
[0m23:51:17.173572 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:51:17.178089 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:51:17.187899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '671983c3-1dac-48d2-a7e5-f4ccc64af941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d99b590>]}
[0m23:51:17.195189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '671983c3-1dac-48d2-a7e5-f4ccc64af941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb6f230>]}
[0m23:51:17.195621 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:51:17.196644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:17.196971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:17.199459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d5d21f7-94ac-45e3-83be-d011d1e0dc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af46420>]}
[0m23:51:17.200280 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:51:17.202151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d5d21f7-94ac-45e3-83be-d011d1e0dc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e92b10>]}
[0m23:51:17.202446 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:51:17.202902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d5d21f7-94ac-45e3-83be-d011d1e0dc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e927b0>]}
[0m23:51:17.203806 [info ] [MainThread]: 
[0m23:51:17.204342 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:17.204937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m23:51:17.205376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m23:51:17.210507 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:51:17.209431 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:51:17.210864 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:51:17.211566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:17.211254 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:51:17.212262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:17.214778 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.215470 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:51:17.215348 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.217423 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:51:17.215765 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:51:17.217660 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:51:17.219157 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:17.219750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:17.219943 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:51:17.220037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:17.220453 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:17.221069 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:51:17.220705 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:51:17.221367 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:51:17.223713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '671983c3-1dac-48d2-a7e5-f4ccc64af941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9daa98b0>]}
[0m23:51:17.224545 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:17.224805 [debug] [MainThread]: On master: BEGIN
[0m23:51:17.225023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:17.227386 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.227725 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:17.228059 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:17.231469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '671983c3-1dac-48d2-a7e5-f4ccc64af941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbb5e80>]}
[0m23:51:17.231766 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:51:17.233386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '671983c3-1dac-48d2-a7e5-f4ccc64af941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc439e0>]}
[0m23:51:17.233389 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:17.234271 [info ] [MainThread]: 
[0m23:51:17.234786 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:51:17.234947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d5d21f7-94ac-45e3-83be-d011d1e0dc2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89edba10>]}
[0m23:51:17.235205 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:17.235478 [debug] [MainThread]: On master: Close
[0m23:51:17.235705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m23:51:17.236092 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:17.236515 [info ] [MainThread]: 
[0m23:51:17.238852 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m23:51:17.239008 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m23:51:17.239126 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:51:17.241640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m23:51:17.239233 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:51:17.242294 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb'
[0m23:51:17.241828 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:51:17.243372 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:51:17.243431 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m23:51:17.243056 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:51:17.244049 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m23:51:17.243745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:17.244263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:17.247174 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.247385 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.247895 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m23:51:17.247586 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m23:51:17.248443 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m23:51:17.248184 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m23:51:17.241360 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae'
[0m23:51:17.250511 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:17.240651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_launches)
[0m23:51:17.250668 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:17.240986 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_starlink)
[0m23:51:17.252152 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m23:51:17.251305 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m23:51:17.252348 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m23:51:17.252734 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m23:51:17.252969 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m23:51:17.251400 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:51:17.251827 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m23:51:17.250730 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:51:17.254093 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m23:51:17.259142 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:17.257185 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:51:17.259523 [debug] [MainThread]: On master: BEGIN
[0m23:51:17.258919 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m23:51:17.260050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:17.260659 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 23:51:17.243615 => 23:51:17.260490
[0m23:51:17.261020 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:51:17.261494 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 23:51:17.261392 => 23:51:17.261404
[0m23:51:17.262166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.262455 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:17.260858 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 23:51:17.252418 => 23:51:17.260778
[0m23:51:17.262746 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:51:17.262842 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m23:51:17.261886 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 23:51:17.254628 => 23:51:17.261785
[0m23:51:17.262513 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:51:17.262019 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 23:51:17.257483 => 23:51:17.261968
[0m23:51:17.264223 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m23:51:17.263498 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:51:17.263873 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:51:17.263226 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 23:51:17.263134 => 23:51:17.263139
[0m23:51:17.265848 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m23:51:17.265112 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 23:51:17.265042 => 23:51:17.265045
[0m23:51:17.266722 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:51:17.264739 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 23:51:17.264667 => 23:51:17.264670
[0m23:51:17.267125 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:51:17.268302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '671983c3-1dac-48d2-a7e5-f4ccc64af941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc09f40>]}
[0m23:51:17.266068 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:51:17.268662 [debug] [MainThread]: On master: ROLLBACK
[0m23:51:17.265479 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1)
[0m23:51:17.269558 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:51:17.269419 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:17.267667 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m23:51:17.271660 [debug] [MainThread]: On master: BEGIN
[0m23:51:17.271787 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:51:17.272119 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.272428 [debug] [MainThread]: On master: COMMIT
[0m23:51:17.267022 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:51:17.272679 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:17.272900 [debug] [MainThread]: On master: COMMIT
[0m23:51:17.271352 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:51:17.273183 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:17.268969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_starlink, now test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed)
[0m23:51:17.273419 [debug] [MainThread]: On master: Close
[0m23:51:17.273523 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:51:17.276934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:51:17.278438 [info ] [MainThread]: 
[0m23:51:17.272981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m23:51:17.279798 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:51:17.280069 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:51:17.280238 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:51:17.279258 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:51:17.279678 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 23:51:17.269767 => 23:51:17.279599
[0m23:51:17.280375 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:51:17.272479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_launches, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m23:51:17.281701 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:51:17.280492 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:51:17.282271 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:51:17.283580 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 23:51:17.283501 => 23:51:17.283507
[0m23:51:17.281499 [info ] [Thread-1 (]: 1 of 8 START test source_not_null_bronze_launches_data ......................... [RUN]
[0m23:51:17.284190 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:51:17.282584 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:51:17.281907 [info ] [Thread-2 (]: 2 of 8 START test source_not_null_bronze_launches_id ........................... [RUN]
[0m23:51:17.282982 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 23:51:17.276796 => 23:51:17.282880
[0m23:51:17.282690 [info ] [Thread-3 (]: 3 of 8 START test source_not_null_bronze_rockets_id ............................ [RUN]
[0m23:51:17.284477 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 23:51:17.279965 => 23:51:17.284394
[0m23:51:17.288288 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1'
[0m23:51:17.288372 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:51:17.288835 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 23:51:17.288752 => 23:51:17.288757
[0m23:51:17.285090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae)
[0m23:51:17.288056 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:51:17.287757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb)
[0m23:51:17.284658 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:51:17.283287 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_bronze_starlink_data ......................... [RUN]
[0m23:51:17.287382 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:51:17.289286 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:51:17.290589 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed'
[0m23:51:17.289503 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:51:17.289812 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 23:51:17.289708 => 23:51:17.289713
[0m23:51:17.291705 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:51:17.293516 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m23:51:17.290233 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m23:51:17.293700 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 23:51:17.284967 => 23:51:17.293629
[0m23:51:17.294769 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:51:17.295008 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 23:51:17.294947 => 23:51:17.294951
[0m23:51:17.294457 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:51:17.290874 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:51:17.290039 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:51:17.294129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now model.spacex_analytics.starlink_constellation_status)
[0m23:51:17.297905 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m23:51:17.297187 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:51:17.297685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m23:51:17.295346 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:51:17.299074 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m23:51:17.299793 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:51:17.301618 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m23:51:17.288696 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:51:17.301867 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 23:51:17.295554 => 23:51:17.301734
[0m23:51:17.303715 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:51:17.305577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8, now model.spacex_analytics.starlink_42k_projection)
[0m23:51:17.290890 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:51:17.307621 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 23:51:17.298051 => 23:51:17.307528
[0m23:51:17.307823 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:51:17.308314 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m23:51:17.308618 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m23:51:17.301789 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:51:17.305013 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:51:17.308861 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 23:51:17.302338 => 23:51:17.308795
[0m23:51:17.307976 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:51:17.309045 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 23:51:17.308960 => 23:51:17.308967
[0m23:51:17.310036 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:51:17.311992 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:51:17.311903 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 23:51:17.291384 => 23:51:17.311784
[0m23:51:17.310790 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 23:51:17.310713 => 23:51:17.310716
[0m23:51:17.312679 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:51:17.311129 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:51:17.310509 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m23:51:17.313134 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m23:51:17.313455 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 23:51:17.313373 => 23:51:17.313376
[0m23:51:17.314547 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:51:17.314885 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 23:51:17.309213 => 23:51:17.314808
[0m23:51:17.316671 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m23:51:17.316909 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 23:51:17.316844 => 23:51:17.316847
[0m23:51:17.317295 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m23:51:17.312187 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 23:51:17.301931 => 23:51:17.312085
[0m23:51:17.318665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:17.318901 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m23:51:17.319107 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m23:51:17.319265 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m23:51:17.319434 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m23:51:17.320102 [debug] [MainThread]: Command end result
[0m23:51:17.312950 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 23:51:17.305478 => 23:51:17.312871
[0m23:51:17.320448 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 23:51:17.308476 => 23:51:17.320383
[0m23:51:17.320264 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:51:17.320076 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:51:17.321658 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:51:17.321832 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:51:17.322828 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:51:17.324087 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:51:17.325087 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:51:17.325842 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:51:17.326102 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:51:17.326359 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: BEGIN
[0m23:51:17.326593 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:51:17.326826 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:51:17.327005 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: BEGIN
[0m23:51:17.327262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:17.327502 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: BEGIN
[0m23:51:17.328420 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:51:17.328044 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:17.327780 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: BEGIN
[0m23:51:17.328986 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:51:17.329761 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:51:17.330453 [info ] [MainThread]: Building catalog
[0m23:51:17.331121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.332113 [debug] [ThreadPool]: Acquiring new postgres connection 'spacex_db.information_schema'
[0m23:51:17.332180 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m23:51:17.331993 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.332308 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.333844 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m23:51:17.334030 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."launches"
where id is null



      
    ) dbt_internal_test
[0m23:51:17.333658 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m23:51:17.332534 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.333445 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."launches"
where data is null



      
    ) dbt_internal_test
[0m23:51:17.335182 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:51:17.335560 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m23:51:17.335801 [debug] [ThreadPool]: On spacex_db.information_schema: BEGIN
[0m23:51:17.335980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:17.336333 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 23:51:17.313057 => 23:51:17.336236
[0m23:51:17.334691 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:51:17.334308 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."starlink"
where data is null



      
    ) dbt_internal_test
[0m23:51:17.334525 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m23:51:17.337913 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."rockets"
where id is null



      
    ) dbt_internal_test
[0m23:51:17.337427 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 23:51:17.321986 => 23:51:17.337359
[0m23:51:17.336649 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: ROLLBACK
[0m23:51:17.338596 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: ROLLBACK
[0m23:51:17.338867 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: Close
[0m23:51:17.339031 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.340085 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m23:51:17.339922 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:51:17.340354 [debug] [ThreadPool]: On spacex_db.information_schema: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "spacex_db.information_schema"} */

    
    

    select
        'spacex_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('gold') or upper(sch.nspname) = upper('bronze') or upper(sch.nspname) = upper('silver'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:51:17.340498 [info ] [Thread-1 (]: 1 of 8 PASS source_not_null_bronze_launches_data ............................... [[32mPASS[0m in 0.06s]
[0m23:51:17.339245 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: Close
[0m23:51:17.341093 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 23:51:17.324436 => 23:51:17.341018
[0m23:51:17.341225 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:51:17.343435 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 23:51:17.323295 => 23:51:17.343373
[0m23:51:17.343843 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.0 seconds
[0m23:51:17.344012 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: ROLLBACK
[0m23:51:17.342831 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: ROLLBACK
[0m23:51:17.341538 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m23:51:17.344777 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:51:17.345266 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_bronze_starlink_id ........................... [RUN]
[0m23:51:17.345029 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: Close
[0m23:51:17.346133 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_bronze_starlink_data ............................... [[32mPASS[0m in 0.06s]
[0m23:51:17.342655 [info ] [Thread-2 (]: 2 of 8 PASS source_not_null_bronze_launches_id ................................. [[32mPASS[0m in 0.05s]
[0m23:51:17.346861 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m23:51:17.344596 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: Close
[0m23:51:17.347679 [info ] [Thread-3 (]: 3 of 8 PASS source_not_null_bronze_rockets_id .................................. [[32mPASS[0m in 0.06s]
[0m23:51:17.345724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m23:51:17.347123 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:51:17.348459 [debug] [ThreadPool]: On spacex_db.information_schema: ROLLBACK
[0m23:51:17.346576 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m23:51:17.348769 [debug] [ThreadPool]: On spacex_db.information_schema: Close
[0m23:51:17.348059 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m23:51:17.348337 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:51:17.348567 [info ] [Thread-2 (]: 6 of 8 START test source_unique_bronze_launches_id ............................. [RUN]
[0m23:51:17.348949 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:51:17.349915 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:51:17.352051 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:51:17.353590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m23:51:17.354179 [info ] [Thread-4 (]: 7 of 8 START test source_unique_bronze_rockets_id .............................. [RUN]
[0m23:51:17.357032 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/target/catalog.json
[0m23:51:17.354480 [info ] [Thread-3 (]: 8 of 8 START test source_unique_bronze_starlink_id ............................. [RUN]
[0m23:51:17.357574 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:51:17.357508 after 0.24 seconds
[0m23:51:17.356821 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:51:17.357978 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:51:17.358370 [debug] [MainThread]: Connection 'spacex_db.information_schema' was properly closed.
[0m23:51:17.358611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa5df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2f4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883d89b0>]}
[0m23:51:17.358831 [debug] [MainThread]: Flushing usage events
[0m23:51:17.357193 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m23:51:17.357641 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m23:51:17.357826 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 23:51:17.350146 => 23:51:17.357751
[0m23:51:17.360768 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:51:17.361127 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:51:17.361381 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:51:17.361726 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:51:17.367138 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:51:17.366199 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:51:17.364700 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:51:17.367508 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 23:51:17.358071 => 23:51:17.367432
[0m23:51:17.368209 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:51:17.369053 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:51:17.369216 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:51:17.369381 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 23:51:17.364953 => 23:51:17.369323
[0m23:51:17.369937 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:51:17.369734 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: BEGIN
[0m23:51:17.369569 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 23:51:17.363489 => 23:51:17.369504
[0m23:51:17.370726 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:51:17.370993 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:51:17.371118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:17.371372 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:51:17.373797 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:51:17.372299 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:51:17.371859 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: BEGIN
[0m23:51:17.374262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.374432 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: BEGIN
[0m23:51:17.374680 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:51:17.374911 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m23:51:17.375564 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."starlink"
where id is null



      
    ) dbt_internal_test
[0m23:51:17.375195 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:51:17.375054 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:51:17.376329 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: BEGIN
[0m23:51:17.376600 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:51:17.376732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:51:17.377648 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 23:51:17.366485 => 23:51:17.377579
[0m23:51:17.377805 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.378782 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m23:51:17.378981 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."launches"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:17.378185 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: ROLLBACK
[0m23:51:17.378467 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.379467 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.379702 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: Close
[0m23:51:17.380866 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_bronze_starlink_id ................................. [[32mPASS[0m in 0.04s]
[0m23:51:17.381314 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m23:51:17.380469 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m23:51:17.380126 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m23:51:17.380235 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:51:17.381987 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."rockets"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:17.382232 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."starlink"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:51:17.382827 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 23:51:17.368403 => 23:51:17.382768
[0m23:51:17.383649 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: ROLLBACK
[0m23:51:17.384054 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: Close
[0m23:51:17.384494 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:51:17.385727 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 23:51:17.372399 => 23:51:17.385638
[0m23:51:17.386037 [info ] [Thread-2 (]: 6 of 8 PASS source_unique_bronze_launches_id ................................... [[32mPASS[0m in 0.03s]
[0m23:51:17.384988 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:51:17.386402 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: ROLLBACK
[0m23:51:17.386735 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m23:51:17.387313 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 23:51:17.370121 => 23:51:17.387250
[0m23:51:17.387660 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: Close
[0m23:51:17.387983 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: ROLLBACK
[0m23:51:17.388592 [info ] [Thread-4 (]: 7 of 8 PASS source_unique_bronze_rockets_id .................................... [[32mPASS[0m in 0.03s]
[0m23:51:17.389469 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m23:51:17.389209 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: Close
[0m23:51:17.390309 [info ] [Thread-3 (]: 8 of 8 PASS source_unique_bronze_starlink_id ................................... [[32mPASS[0m in 0.03s]
[0m23:51:17.390661 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m23:51:17.391874 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:17.392052 [debug] [MainThread]: On master: BEGIN
[0m23:51:17.392206 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:17.393619 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:17.393803 [debug] [MainThread]: On master: COMMIT
[0m23:51:17.394025 [debug] [MainThread]: Using postgres connection "master"
[0m23:51:17.394170 [debug] [MainThread]: On master: COMMIT
[0m23:51:17.394394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:17.394561 [debug] [MainThread]: On master: Close
[0m23:51:17.394842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:17.395034 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e' was properly closed.
[0m23:51:17.395243 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8' was properly closed.
[0m23:51:17.395476 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m23:51:17.395642 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m23:51:17.395831 [info ] [MainThread]: 
[0m23:51:17.396020 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m23:51:17.396589 [debug] [MainThread]: Command end result
[0m23:51:17.400592 [info ] [MainThread]: 
[0m23:51:17.400844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:51:17.401028 [info ] [MainThread]: 
[0m23:51:17.401215 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:51:17.401468 [debug] [MainThread]: Command `dbt test` succeeded at 23:51:17.401429 after 0.27 seconds
[0m23:51:17.401669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e434b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc66120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dafa3c0>]}
[0m23:51:17.401856 [debug] [MainThread]: Flushing usage events
[0m23:51:19.868445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4bcb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d5e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4f7d9a0>]}


============================== 23:51:19.870007 | 5d61d676-ff4e-485e-8d55-4cb9b2b7738f ==============================
[0m23:51:19.870007 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:51:19.870362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation log_results --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:51:19.906487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d61d676-ff4e-485e-8d55-4cb9b2b7738f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4bf84d0>]}
[0m23:51:19.912086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d61d676-ff4e-485e-8d55-4cb9b2b7738f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb414b8c0>]}
[0m23:51:19.912463 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:51:19.916250 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:51:19.932175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:19.932409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:19.934564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d61d676-ff4e-485e-8d55-4cb9b2b7738f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4f43bf0>]}
[0m23:51:19.939871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d61d676-ff4e-485e-8d55-4cb9b2b7738f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb417fbf0>]}
[0m23:51:19.940128 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m23:51:19.940353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d61d676-ff4e-485e-8d55-4cb9b2b7738f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a92180>]}
[0m23:51:19.940722 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_results'
[0m23:51:19.940958 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m23:51:19.941116 [debug] [MainThread]: On macro_log_results: BEGIN
[0m23:51:19.941280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:19.943198 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:51:19.943477 [debug] [MainThread]: On macro_log_results: COMMIT
[0m23:51:19.943678 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m23:51:19.943871 [debug] [MainThread]: On macro_log_results: COMMIT
[0m23:51:19.944092 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:51:19.948634 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m23:51:19.948859 [debug] [MainThread]: On macro_log_results: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "macro_log_results"} */

    
    SELECT 
      "🎯 ANSWER: Launches Needed" as launches_needed,
      "🎯 ANSWER: Months to 42K" as months_needed,
      "🎯 ANSWER: Est. Completion Date" as completion_date,
      "CONFIDENCE: Projection Reliability" as confidence
    FROM gold.starlink_42k_projection
    LIMIT 1
  
  
[0m23:51:19.949228 [debug] [MainThread]: Postgres adapter: Postgres error: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^

[0m23:51:19.949524 [debug] [MainThread]: Postgres adapter: Error running SQL: macro log_results
[0m23:51:19.949715 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m23:51:19.949907 [debug] [MainThread]: On macro_log_results: Close
[0m23:51:19.950239 [error] [MainThread]: Encountered an error while running operation: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^
[0m23:51:19.951986 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 73, in exception_handler
    yield
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1054, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 290, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 146, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 84, in exception_handler
    raise dbt.exceptions.DbtDatabaseError(str(e).strip()) from e
dbt.exceptions.DbtDatabaseError: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^

[0m23:51:19.957289 [debug] [MainThread]: Command `dbt run-operation` failed at 23:51:19.957243 after 0.09 seconds
[0m23:51:19.957562 [debug] [MainThread]: Connection 'macro_log_results' was properly closed.
[0m23:51:19.957809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5049f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb416cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb416fc80>]}
[0m23:51:19.958101 [debug] [MainThread]: Flushing usage events
[0m00:23:42.434966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87bab770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ccfe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895e6930>]}


============================== 00:23:42.436798 | 9001014e-48a3-4da8-bdd1-d652704d9ddf ==============================
[0m00:23:42.436798 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:23:42.437166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:42.458154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9001014e-48a3-4da8-bdd1-d652704d9ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c8bc50>]}
[0m00:23:42.458892 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:23:42.459280 [debug] [MainThread]: Command `dbt deps` succeeded at 00:23:42.459231 after 0.03 seconds
[0m00:23:42.459549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88580170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ccfe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c8bc50>]}
[0m00:23:42.459792 [debug] [MainThread]: Flushing usage events
[0m00:23:44.520536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb44a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c290770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb44890>]}


============================== 00:23:44.522047 | 8d612b23-0680-418e-ac82-c230aa874894 ==============================
[0m00:23:44.522047 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:23:44.522375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models silver --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:23:44.559882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d612b23-0680-418e-ac82-c230aa874894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b09faa0>]}
[0m00:23:44.565186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d612b23-0680-418e-ac82-c230aa874894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c147440>]}
[0m00:23:44.565608 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:23:44.569583 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:23:44.586993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:23:44.587344 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m00:23:44.602677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d612b23-0680-418e-ac82-c230aa874894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b0d5af0>]}
[0m00:23:44.608043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d612b23-0680-418e-ac82-c230aa874894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b02d5b0>]}
[0m00:23:44.608317 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:23:44.608621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d612b23-0680-418e-ac82-c230aa874894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b03c980>]}
[0m00:23:44.609327 [info ] [MainThread]: 
[0m00:23:44.609706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:23:44.610263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m00:23:44.613682 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m00:23:44.613908 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m00:23:44.614091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:44.616179 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:23:44.616788 [debug] [ThreadPool]: On list_spacex_db: Close
[0m00:23:44.617510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold)
[0m00:23:44.619837 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:23:44.617856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m00:23:44.620842 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:23:44.620099 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:23:44.621337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:44.621103 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:23:44.621701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:44.622948 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:23:44.623203 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:23:44.623606 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:23:44.623820 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:23:44.624928 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:44.625086 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:23:44.625690 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:23:44.625968 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:23:44.626307 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:23:44.627822 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:44.628342 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:23:44.628595 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:23:44.630430 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:44.630694 [debug] [MainThread]: On master: BEGIN
[0m00:23:44.630932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:44.632233 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:44.632452 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:44.632682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:23:44.636760 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:44.637325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d612b23-0680-418e-ac82-c230aa874894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c987dd0>]}
[0m00:23:44.637625 [debug] [MainThread]: On master: ROLLBACK
[0m00:23:44.637911 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:44.638150 [debug] [MainThread]: On master: BEGIN
[0m00:23:44.638497 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:44.638709 [debug] [MainThread]: On master: COMMIT
[0m00:23:44.638912 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:44.639124 [debug] [MainThread]: On master: COMMIT
[0m00:23:44.639405 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:23:44.639622 [debug] [MainThread]: On master: Close
[0m00:23:44.639969 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:23:44.640345 [info ] [MainThread]: 
[0m00:23:44.641736 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m00:23:44.641911 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m00:23:44.642130 [info ] [Thread-1 (]: 1 of 2 START sql view model silver.silver_launches ............................. [RUN]
[0m00:23:44.642450 [info ] [Thread-2 (]: 2 of 2 START sql view model silver.silver_starlink ............................. [RUN]
[0m00:23:44.642845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_launches)
[0m00:23:44.643207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_starlink)
[0m00:23:44.643498 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m00:23:44.643755 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m00:23:44.646693 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m00:23:44.648080 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m00:23:44.649669 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 00:23:44.646952 => 00:23:44.649586
[0m00:23:44.649937 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m00:23:44.650162 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 00:23:44.644006 => 00:23:44.650075
[0m00:23:44.661651 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.silver_starlink"
[0m00:23:44.661816 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m00:23:44.663377 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.silver_launches"
[0m00:23:44.664396 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m00:23:44.664713 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: BEGIN
[0m00:23:44.664971 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:23:44.665144 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m00:23:44.665632 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: BEGIN
[0m00:23:44.665873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:44.667049 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:44.667538 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m00:23:44.667676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:44.667893 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

  create view "spacex_db"."silver"."silver_starlink__dbt_tmp"
    
    
  as (
    

WITH parsed_starlink AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as satellite_id,
        data->'spaceTrack'->>'OBJECT_NAME' as satellite_name,
        data->>'launch' as launch_id,
        
        -- Launch and creation dates
        CASE 
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'LAUNCH_DATE')::date 
            ELSE NULL 
        END as launch_date,
        
        CASE 
            WHEN data->'spaceTrack'->>'CREATION_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'CREATION_DATE')::timestamp 
            ELSE NULL 
        END as tracking_creation_date,
        
        -- Satellite status determination (multiple fallback methods)
        CASE 
            -- Primary: DECAYED field
            WHEN data->'spaceTrack'->>'DECAYED' = '0' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'false' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'False' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = '1' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'true' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'True' THEN false
            -- Fallback: DECAY_DATE field
            WHEN data->'spaceTrack'->>'DECAY_DATE' IS NULL OR data->'spaceTrack'->>'DECAY_DATE' = '' THEN true
            ELSE false
        END as is_active,
        
        -- Orbital parameters (parsed to numeric types)
        CASE 
            WHEN data->'spaceTrack'->>'INCLINATION' IS NOT NULL 
            THEN (data->'spaceTrack'->>'INCLINATION')::numeric 
            ELSE NULL 
        END as inclination_deg,
        
        CASE 
            WHEN data->'spaceTrack'->>'SEMIMAJOR_AXIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'SEMIMAJOR_AXIS')::numeric 
            ELSE NULL 
        END as semimajor_axis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIOD' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIOD')::numeric 
            ELSE NULL 
        END as orbital_period_min,
        
        CASE 
            WHEN data->'spaceTrack'->>'APOAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'APOAPSIS')::numeric 
            ELSE NULL 
        END as apoapsis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIAPSIS')::numeric 
            ELSE NULL 
        END as periapsis_km,
        
        -- Current position data (if available)
        CASE 
            WHEN data->>'longitude' IS NOT NULL 
            THEN (data->>'longitude')::numeric 
            ELSE NULL 
        END as longitude,
        
        CASE 
            WHEN data->>'latitude' IS NOT NULL 
            THEN (data->>'latitude')::numeric 
            ELSE NULL 
        END as latitude,
        
        CASE 
            WHEN data->>'height_km' IS NOT NULL 
            THEN (data->>'height_km')::numeric 
            ELSE NULL 
        END as altitude_km,
        
        CASE 
            WHEN data->>'velocity_kms' IS NOT NULL 
            THEN (data->>'velocity_kms')::numeric 
            ELSE NULL 
        END as velocity_kms,
        
        -- Tracking information
        data->'spaceTrack'->>'NORAD_CAT_ID' as norad_catalog_id,
        data->'spaceTrack'->>'OBJECT_ID' as object_id,
        data->'spaceTrack'->>'DECAY_DATE' as decay_date_raw,
        
        -- Data quality assessment
        CASE 
            WHEN data->'spaceTrack'->>'OBJECT_NAME' IS NULL THEN 'missing_satellite_name'
            WHEN data->>'launch' IS NULL THEN 'missing_launch_reference'
            WHEN data->'spaceTrack'->>'DECAYED' IS NULL AND data->'spaceTrack'->>'DECAY_DATE' IS NULL THEN 'missing_status_info'
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NULL THEN 'missing_launch_date'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."starlink"
    WHERE data IS NOT NULL
)

SELECT 
    satellite_id,
    satellite_name,
    launch_id,
    launch_date,
    tracking_creation_date,
    is_active,
    inclination_deg,
    semimajor_axis_km,
    orbital_period_min,
    apoapsis_km,
    periapsis_km,
    longitude,
    latitude,
    altitude_km,
    velocity_kms,
    norad_catalog_id,
    object_id,
    decay_date_raw,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    CASE 
        WHEN semimajor_axis_km IS NOT NULL 
        THEN semimajor_axis_km - 6371.0  -- Convert to altitude above Earth's surface
        ELSE NULL 
    END as calculated_altitude_km,
    
    -- Orbital regime classification
    CASE 
        WHEN semimajor_axis_km - 6371.0 BETWEEN 160 AND 2000 THEN 'Low Earth Orbit (LEO)'
        WHEN semimajor_axis_km - 6371.0 BETWEEN 2000 AND 35786 THEN 'Medium Earth Orbit (MEO)'
        WHEN semimajor_axis_km - 6371.0 > 35786 THEN 'Geostationary Orbit (GEO)'
        ELSE 'Unknown'
    END as orbital_regime,
    
    -- Age calculation
    CASE 
        WHEN launch_date IS NOT NULL 
        THEN CURRENT_DATE - launch_date 
        ELSE NULL 
    END as satellite_age_days

FROM parsed_starlink
WHERE satellite_id IS NOT NULL

-- Add model documentation

  );
[0m00:23:44.668217 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m00:23:44.668634 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

  create view "spacex_db"."silver"."silver_launches__dbt_tmp"
    
    
  as (
    

WITH parsed_launches AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as launch_id,
        data->>'name' as mission_name,
        
        -- Date and time parsing
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp 
            ELSE NULL 
        END as launch_date_utc,
        
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp::date 
            ELSE NULL 
        END as launch_date,
        
        -- Launch outcome
        CASE 
            WHEN (data->'success')::text = 'true' THEN true
            WHEN (data->'success')::text = 'false' THEN false
            ELSE NULL
        END as launch_success,
        
        CASE 
            WHEN (data->'upcoming')::text = 'true' THEN true
            WHEN (data->'upcoming')::text = 'false' THEN false
            ELSE NULL
        END as is_upcoming,
        
        -- Technical details
        data->>'rocket' as rocket_id,
        
        CASE 
            WHEN data->>'flight_number' IS NOT NULL 
            THEN (data->>'flight_number')::integer 
            ELSE NULL 
        END as flight_number,
        
        data->>'launchpad' as launchpad_id,
        data->>'details' as mission_details,
        
        -- Business logic: Starlink mission identification
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN true
            WHEN LOWER(data->>'name') LIKE '%starship%' AND LOWER(data->>'name') LIKE '%starlink%' THEN true
            ELSE false
        END as is_starlink_mission,
        
        -- Satellite count estimation for Starlink missions
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN
                CASE 
                    -- Early test missions
                    WHEN LOWER(data->>'name') LIKE '%demo%' 
                      OR LOWER(data->>'name') LIKE '%test%' 
                      OR data->>'name' ILIKE '%tintin%' THEN 2
                    -- V1.0 missions (60 satellites each)
                    WHEN data->>'name' ILIKE '%v1.0%' THEN 60
                    -- V2 missions (larger satellites, fewer per launch)
                    WHEN data->>'name' ILIKE '%v2%' THEN 23
                    -- Standard production batches
                    ELSE 60
                END
            ELSE 0
        END as estimated_satellite_count,
        
        -- Payload analysis
        CASE 
            WHEN data->'payloads' IS NOT NULL 
            THEN jsonb_array_length(data->'payloads') 
            ELSE 0 
        END as payload_count,
        
        -- Data quality assessment
        CASE 
            WHEN data->>'date_utc' IS NULL THEN 'missing_launch_date'
            WHEN data->>'name' IS NULL THEN 'missing_mission_name'
            WHEN (data->'success') IS NULL AND (data->'upcoming')::text = 'false' THEN 'missing_success_status'
            WHEN data->>'rocket' IS NULL THEN 'missing_rocket_info'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."launches"
    WHERE data IS NOT NULL
)

SELECT 
    launch_id,
    mission_name,
    launch_date_utc,
    launch_date,
    launch_success,
    is_upcoming,
    rocket_id,
    flight_number,
    launchpad_id,
    mission_details,
    is_starlink_mission,
    estimated_satellite_count,
    payload_count,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    EXTRACT(YEAR FROM launch_date_utc) as launch_year,
    EXTRACT(MONTH FROM launch_date_utc) as launch_month,
    EXTRACT(DOW FROM launch_date_utc) as launch_day_of_week,
    
    -- Mission type classification
    CASE 
        WHEN is_starlink_mission THEN 'Starlink'
        WHEN LOWER(mission_name) LIKE '%crew%' THEN 'Crew'
        WHEN LOWER(mission_name) LIKE '%cargo%' OR LOWER(mission_name) LIKE '%crs%' THEN 'Cargo'
        WHEN LOWER(mission_name) LIKE '%satellite%' THEN 'Commercial Satellite'
        ELSE 'Other'
    END as mission_type

FROM parsed_launches
WHERE launch_id IS NOT NULL

-- Add model documentation

  );
[0m00:23:44.671634 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:23:44.671775 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:23:44.674426 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m00:23:44.675444 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m00:23:44.675720 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
alter table "spacex_db"."silver"."silver_starlink" rename to "silver_starlink__dbt_backup"
[0m00:23:44.675962 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
alter table "spacex_db"."silver"."silver_launches" rename to "silver_launches__dbt_backup"
[0m00:23:44.676501 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:44.676695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:44.677564 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m00:23:44.678587 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m00:23:44.678827 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
alter table "spacex_db"."silver"."silver_starlink__dbt_tmp" rename to "silver_starlink"
[0m00:23:44.679059 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
alter table "spacex_db"."silver"."silver_launches__dbt_tmp" rename to "silver_launches"
[0m00:23:44.679634 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:44.679763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:44.685642 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m00:23:44.687371 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

        COMMENT ON VIEW "spacex_db"."silver"."silver_starlink" IS 'Cleaned Starlink satellite data with active status determination and orbital parameters'
      
[0m00:23:44.686618 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m00:23:44.688339 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

        COMMENT ON VIEW "spacex_db"."silver"."silver_launches" IS 'Cleaned launch data with Starlink mission identification and satellite count estimation'
      
[0m00:23:44.688230 [debug] [Thread-2 (]: SQL status: COMMENT in 0.0 seconds
[0m00:23:44.688941 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m00:23:44.689077 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m00:23:44.689649 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m00:23:44.689243 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m00:23:44.690191 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m00:23:44.689910 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m00:23:44.690589 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m00:23:44.690775 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:23:44.691140 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:23:44.693790 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m00:23:44.695288 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m00:23:44.695691 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
drop view if exists "spacex_db"."silver"."silver_starlink__dbt_backup" cascade
[0m00:23:44.695965 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
drop view if exists "spacex_db"."silver"."silver_launches__dbt_backup" cascade
[0m00:23:44.697292 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:23:44.697454 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:23:44.698139 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 00:23:44.650265 => 00:23:44.698069
[0m00:23:44.698797 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 00:23:44.662257 => 00:23:44.698731
[0m00:23:44.699091 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: Close
[0m00:23:44.699315 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: Close
[0m00:23:44.699773 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d612b23-0680-418e-ac82-c230aa874894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aaac440>]}
[0m00:23:44.700157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d612b23-0680-418e-ac82-c230aa874894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa70da0>]}
[0m00:23:44.701154 [info ] [Thread-2 (]: 2 of 2 OK created sql view model silver.silver_starlink ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m00:23:44.701635 [info ] [Thread-1 (]: 1 of 2 OK created sql view model silver.silver_launches ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m00:23:44.702082 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m00:23:44.702400 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m00:23:44.704545 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:44.704779 [debug] [MainThread]: On master: BEGIN
[0m00:23:44.704962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:23:44.706354 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:44.706577 [debug] [MainThread]: On master: COMMIT
[0m00:23:44.706773 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:44.706959 [debug] [MainThread]: On master: COMMIT
[0m00:23:44.707192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:23:44.707384 [debug] [MainThread]: On master: Close
[0m00:23:44.707697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:44.708183 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_starlink' was properly closed.
[0m00:23:44.708366 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_launches' was properly closed.
[0m00:23:44.708574 [info ] [MainThread]: 
[0m00:23:44.709019 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m00:23:44.709534 [debug] [MainThread]: Command end result
[0m00:23:44.713602 [info ] [MainThread]: 
[0m00:23:44.713861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:23:44.714070 [info ] [MainThread]: 
[0m00:23:44.714293 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:23:44.714569 [debug] [MainThread]: Command `dbt run` succeeded at 00:23:44.714532 after 0.20 seconds
[0m00:23:44.714798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c290770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1b19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8d6cf0>]}
[0m00:23:44.715039 [debug] [MainThread]: Flushing usage events
[0m00:23:47.187431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b43b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8aef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c382330>]}


============================== 00:23:47.188942 | 370efa93-4d51-42f3-b52f-76542a37bd93 ==============================
[0m00:23:47.188942 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:23:47.189324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:47.224309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '370efa93-4d51-42f3-b52f-76542a37bd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a997f80>]}
[0m00:23:47.229932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '370efa93-4d51-42f3-b52f-76542a37bd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9bea20>]}
[0m00:23:47.230436 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:23:47.234240 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:23:47.253940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:47.254237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:47.256435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '370efa93-4d51-42f3-b52f-76542a37bd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc48dd0>]}
[0m00:23:47.261905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '370efa93-4d51-42f3-b52f-76542a37bd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9ff320>]}
[0m00:23:47.262302 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:23:47.262835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370efa93-4d51-42f3-b52f-76542a37bd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a997aa0>]}
[0m00:23:47.263569 [info ] [MainThread]: 
[0m00:23:47.264003 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:23:47.264727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m00:23:47.268472 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m00:23:47.268690 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m00:23:47.268870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:47.270824 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:23:47.271437 [debug] [ThreadPool]: On list_spacex_db: Close
[0m00:23:47.272109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_silver)
[0m00:23:47.272586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m00:23:47.274498 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:23:47.275287 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:23:47.275539 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:23:47.275757 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:23:47.275971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:47.276181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:47.277728 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:23:47.278224 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:23:47.277877 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:23:47.278875 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:23:47.278579 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:23:47.279134 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:23:47.281117 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:47.281747 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:23:47.281226 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:47.282509 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:23:47.282137 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:23:47.282801 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:23:47.284764 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:47.285048 [debug] [MainThread]: On master: BEGIN
[0m00:23:47.285290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:47.286582 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:47.286832 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:47.287102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:23:47.290785 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:47.291322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370efa93-4d51-42f3-b52f-76542a37bd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa3f2c0>]}
[0m00:23:47.291638 [debug] [MainThread]: On master: ROLLBACK
[0m00:23:47.291915 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:47.292141 [debug] [MainThread]: On master: BEGIN
[0m00:23:47.292473 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:47.292686 [debug] [MainThread]: On master: COMMIT
[0m00:23:47.292909 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:47.293133 [debug] [MainThread]: On master: COMMIT
[0m00:23:47.293390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:23:47.293598 [debug] [MainThread]: On master: Close
[0m00:23:47.293941 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:23:47.294399 [info ] [MainThread]: 
[0m00:23:47.295739 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m00:23:47.295916 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m00:23:47.296124 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m00:23:47.296433 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m00:23:47.296816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_42k_projection)
[0m00:23:47.297204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_constellation_status)
[0m00:23:47.297510 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m00:23:47.297772 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m00:23:47.300619 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m00:23:47.301782 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m00:23:47.303175 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 00:23:47.300854 => 00:23:47.303102
[0m00:23:47.303459 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m00:23:47.303637 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 00:23:47.298026 => 00:23:47.303559
[0m00:23:47.316743 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m00:23:47.316910 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m00:23:47.318551 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m00:23:47.319632 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:23:47.319935 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m00:23:47.320206 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:23:47.320375 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:23:47.320783 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m00:23:47.321119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:47.321956 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:47.322177 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:23:47.322395 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    CURRENT_TIMESTAMP as status_date,
    
    -- Current constellation
    COUNT(*) as total_satellites,
    COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
    COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
    
    -- Performance
    ROUND((COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*))::numeric, 1) as active_percentage,
    
    -- Timeline
    MIN(launch_date) as first_launch_date,
    MAX(launch_date) as latest_launch_date,
    
    -- Data quality
    MAX(extracted_at) as last_updated,
    ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 1) as data_age_hours

FROM "spacex_db"."silver"."silver_starlink"
WHERE satellite_id IS NOT NULL
  );
  
[0m00:23:47.324078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:47.324336 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:23:47.324607 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT 
        COUNT(CASE WHEN is_active THEN 1 END) as current_satellites
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_stats AS (
    SELECT 
        COUNT(*) as total_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_launches,
        AVG(CASE WHEN launch_success THEN estimated_satellite_count END)::numeric as avg_sats_per_launch,
        
        -- Use the most recent 2 years of available data (2021-2022)
        COUNT(CASE WHEN launch_date >= '2021-01-01' AND launch_success THEN 1 END) as recent_launches,
        
        -- Calculate monthly launch rate from available data
        CASE 
            WHEN MAX(launch_date) IS NOT NULL AND MIN(launch_date) IS NOT NULL THEN
                COUNT(CASE WHEN launch_success THEN 1 END) / 
                GREATEST(1, EXTRACT(MONTH FROM AGE(MAX(launch_date), MIN(launch_date))))
            ELSE 0
        END as avg_monthly_launch_rate,
        
        -- Get data timeline for context
        MIN(launch_date) as first_launch,
        MAX(launch_date) as latest_launch
        
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date IS NOT NULL
)

SELECT 
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current status
    42000 as target_satellites,
    cs.current_satellites,
    (42000 - cs.current_satellites) as satellites_needed,
    ROUND((cs.current_satellites * 100.0 / 42000)::numeric, 1) as progress_percent,
    
    -- Historical performance
    ls.total_launches as total_starlink_launches,
    ls.successful_launches,
    ROUND(ls.avg_sats_per_launch, 0) as avg_satellites_per_launch,
    ls.recent_launches as launches_2021_2022,
    
    -- Business projections
    CASE 
        WHEN ls.avg_sats_per_launch > 0 THEN
            CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch)
        ELSE NULL
    END as launches_needed,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1)
        ELSE NULL
    END as months_to_completion,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            (CURRENT_DATE + INTERVAL '1 month' * ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1))::date
        ELSE NULL
    END as estimated_completion_date,
    
    -- Confidence and context
    CASE 
        WHEN ls.recent_launches >= 10 THEN 'High Confidence'
        WHEN ls.recent_launches >= 5 THEN 'Medium Confidence'
        ELSE 'Low Confidence'
    END as projection_confidence,
    
    -- Data context
    ls.first_launch as data_start_date,
    ls.latest_launch as data_end_date,
    '2022 API data - projections based on historical performance' as data_note

FROM current_status cs
CROSS JOIN launch_stats ls
  );
  
[0m00:23:47.328057 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:23:47.332282 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:23:47.332429 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:23:47.332567 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m00:23:47.333640 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:23:47.334001 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection" rename to "starlink_42k_projection__dbt_backup"
[0m00:23:47.334174 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:47.334439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:47.335319 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:23:47.336362 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:23:47.336599 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m00:23:47.336839 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp" rename to "starlink_42k_projection"
[0m00:23:47.337137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:47.337365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:23:47.344033 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:23:47.344706 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m00:23:47.345006 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:23:47.345290 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:23:47.345554 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:23:47.345824 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m00:23:47.346749 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:23:47.346930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:23:47.349517 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:23:47.350479 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:23:47.350706 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m00:23:47.350952 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
drop table if exists "spacex_db"."gold"."starlink_42k_projection__dbt_backup" cascade
[0m00:23:47.351838 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:23:47.351969 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:23:47.352507 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 00:23:47.303745 => 00:23:47.352445
[0m00:23:47.353124 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 00:23:47.317378 => 00:23:47.353071
[0m00:23:47.353338 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m00:23:47.353558 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m00:23:47.354000 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '370efa93-4d51-42f3-b52f-76542a37bd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a95ea50>]}
[0m00:23:47.355354 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.06s]
[0m00:23:47.355118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '370efa93-4d51-42f3-b52f-76542a37bd93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8be5b080>]}
[0m00:23:47.356085 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold.starlink_42k_projection ................. [[32mSELECT 1[0m in 0.06s]
[0m00:23:47.355804 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m00:23:47.356402 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m00:23:47.358317 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:47.358517 [debug] [MainThread]: On master: BEGIN
[0m00:23:47.358672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:23:47.359878 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:47.360104 [debug] [MainThread]: On master: COMMIT
[0m00:23:47.360294 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:47.360483 [debug] [MainThread]: On master: COMMIT
[0m00:23:47.360703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:23:47.360889 [debug] [MainThread]: On master: Close
[0m00:23:47.361195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:47.361647 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m00:23:47.361833 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m00:23:47.362077 [info ] [MainThread]: 
[0m00:23:47.362330 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m00:23:47.362678 [debug] [MainThread]: Command end result
[0m00:23:47.367426 [info ] [MainThread]: 
[0m00:23:47.367710 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:23:47.367922 [info ] [MainThread]: 
[0m00:23:47.368148 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:23:47.368422 [debug] [MainThread]: Command `dbt run` succeeded at 00:23:47.368385 after 0.19 seconds
[0m00:23:47.368645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba92ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0d18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b96e900>]}
[0m00:23:47.368887 [debug] [MainThread]: Flushing usage events
[0m00:23:50.147567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26ca2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa282ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a7d9a0>]}


============================== 00:23:50.149612 | b345b1fd-2a2e-4d2b-9b1f-eecc11215fc5 ==============================
[0m00:23:50.149612 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:23:50.150187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:50.149358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba23bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3bef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba239130>]}


============================== 00:23:50.151119 | 97d4bd3d-1694-4409-9a61-de922a50eed2 ==============================
[0m00:23:50.151119 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:23:50.151448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:50.192841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97d4bd3d-1694-4409-9a61-de922a50eed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9793e00>]}
[0m00:23:50.192851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b345b1fd-2a2e-4d2b-9b1f-eecc11215fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a7dfd0>]}
[0m00:23:50.198524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97d4bd3d-1694-4409-9a61-de922a50eed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba23b920>]}
[0m00:23:50.198652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b345b1fd-2a2e-4d2b-9b1f-eecc11215fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c4f140>]}
[0m00:23:50.199115 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:23:50.199013 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:23:50.203593 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:23:50.203628 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:23:50.223073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:50.223394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:50.223787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:50.225646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b345b1fd-2a2e-4d2b-9b1f-eecc11215fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b897f0>]}
[0m00:23:50.225802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:50.228044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b345b1fd-2a2e-4d2b-9b1f-eecc11215fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c96840>]}
[0m00:23:50.228334 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:23:50.228710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b345b1fd-2a2e-4d2b-9b1f-eecc11215fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c961e0>]}
[0m00:23:50.228836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97d4bd3d-1694-4409-9a61-de922a50eed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba2c6a80>]}
[0m00:23:50.229625 [info ] [MainThread]: 
[0m00:23:50.230102 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:23:50.231363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m00:23:50.231756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m00:23:50.236157 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:23:50.237017 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:23:50.237305 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:23:50.237549 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:23:50.237753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:50.238264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:50.238811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97d4bd3d-1694-4409-9a61-de922a50eed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb97e3020>]}
[0m00:23:50.239607 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:23:50.240905 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.240921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97d4bd3d-1694-4409-9a61-de922a50eed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba26a900>]}
[0m00:23:50.241163 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:23:50.241636 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:23:50.242444 [info ] [MainThread]: 
[0m00:23:50.241337 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.242938 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:50.243677 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:23:50.243399 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:23:50.244783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m00:23:50.244168 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:23:50.245261 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:23:50.245010 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:23:50.247909 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:50.248510 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:23:50.249105 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:23:50.250523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m00:23:50.252044 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:50.252329 [debug] [MainThread]: On master: BEGIN
[0m00:23:50.252530 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:50.252414 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:23:50.253660 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:23:50.253223 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:23:50.254199 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:23:50.253932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:50.254636 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.254415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:50.254971 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:50.255431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:23:50.256664 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.257032 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:23:50.256890 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.257470 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:23:50.257255 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:23:50.257675 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:23:50.259647 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:50.259678 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:50.260319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b345b1fd-2a2e-4d2b-9b1f-eecc11215fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ce7b90>]}
[0m00:23:50.258805 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:50.260793 [debug] [MainThread]: On master: ROLLBACK
[0m00:23:50.261050 [debug] [MainThread]: On master: Close
[0m00:23:50.260563 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:23:50.261293 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:23:50.261731 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:23:50.261947 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:23:50.262634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:23:50.263142 [info ] [MainThread]: 
[0m00:23:50.265058 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:50.266009 [debug] [MainThread]: On master: BEGIN
[0m00:23:50.266246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:50.266990 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m00:23:50.267678 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.267350 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:23:50.267916 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:50.267210 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m00:23:50.268439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:23:50.267455 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:23:50.269096 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb'
[0m00:23:50.269336 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:23:50.272337 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:23:50.274427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97d4bd3d-1694-4409-9a61-de922a50eed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb97d7f20>]}
[0m00:23:50.274709 [debug] [MainThread]: On master: ROLLBACK
[0m00:23:50.274967 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:50.275199 [debug] [MainThread]: On master: BEGIN
[0m00:23:50.275481 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.268696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_starlink)
[0m00:23:50.275735 [debug] [MainThread]: On master: COMMIT
[0m00:23:50.267751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_launches)
[0m00:23:50.276097 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:50.268223 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae'
[0m00:23:50.276510 [debug] [MainThread]: On master: COMMIT
[0m00:23:50.275363 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m00:23:50.276833 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:23:50.275904 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m00:23:50.277118 [debug] [MainThread]: On master: Close
[0m00:23:50.276315 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m00:23:50.278413 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:23:50.279627 [info ] [MainThread]: 
[0m00:23:50.276681 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:23:50.278559 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m00:23:50.280054 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m00:23:50.280401 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 00:23:50.269535 => 00:23:50.280326
[0m00:23:50.282516 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:23:50.281672 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m00:23:50.282700 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:23:50.282731 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:23:50.283773 [info ] [Thread-2 (]: 2 of 8 START test source_not_null_bronze_launches_id ........................... [RUN]
[0m00:23:50.283105 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 00:23:50.277257 => 00:23:50.283002
[0m00:23:50.284322 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m00:23:50.283009 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:23:50.284852 [info ] [Thread-3 (]: 3 of 8 START test source_not_null_bronze_rockets_id ............................ [RUN]
[0m00:23:50.283934 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 00:23:50.283647 => 00:23:50.283657
[0m00:23:50.283521 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 00:23:50.278813 => 00:23:50.283446
[0m00:23:50.283175 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:23:50.285663 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m00:23:50.285863 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_bronze_starlink_data ......................... [RUN]
[0m00:23:50.284683 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 00:23:50.284619 => 00:23:50.284624
[0m00:23:50.283352 [info ] [Thread-1 (]: 1 of 8 START test source_not_null_bronze_launches_data ......................... [RUN]
[0m00:23:50.286674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae)
[0m00:23:50.285432 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:23:50.284538 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 00:23:50.280479 => 00:23:50.284480
[0m00:23:50.284339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb)
[0m00:23:50.285957 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 00:23:50.285900 => 00:23:50.285902
[0m00:23:50.287644 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:23:50.287961 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m00:23:50.288253 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:23:50.288727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_launches, now test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed)
[0m00:23:50.286433 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m00:23:50.287033 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:23:50.287539 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:23:50.289925 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 00:23:50.289862 => 00:23:50.289865
[0m00:23:50.289200 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:23:50.290666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_starlink, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m00:23:50.288957 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:23:50.292442 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m00:23:50.289522 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1)
[0m00:23:50.292755 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:23:50.285640 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1'
[0m00:23:50.294315 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:23:50.290346 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:23:50.290864 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:23:50.286250 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed'
[0m00:23:50.296747 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m00:23:50.295241 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:23:50.286896 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:23:50.294910 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m00:23:50.296964 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 00:23:50.291026 => 00:23:50.296896
[0m00:23:50.298030 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:23:50.297570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m00:23:50.298609 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:23:50.299018 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m00:23:50.296300 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m00:23:50.297114 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:23:50.298505 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 00:23:50.292957 => 00:23:50.298451
[0m00:23:50.298265 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 00:23:50.298199 => 00:23:50.298203
[0m00:23:50.301549 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:23:50.301903 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:23:50.300893 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m00:23:50.294166 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m00:23:50.301739 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 00:23:50.295553 => 00:23:50.301647
[0m00:23:50.302221 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m00:23:50.301149 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:23:50.302569 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 00:23:50.297699 => 00:23:50.302496
[0m00:23:50.303617 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 00:23:50.298767 => 00:23:50.303544
[0m00:23:50.303268 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 00:23:50.294504 => 00:23:50.303186
[0m00:23:50.304234 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:23:50.303330 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:23:50.302224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m00:23:50.303779 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 00:23:50.303697 => 00:23:50.303700
[0m00:23:50.305287 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:23:50.304659 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 00:23:50.304587 => 00:23:50.304590
[0m00:23:50.304863 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:23:50.304012 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:23:50.308045 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 00:23:50.307967 => 00:23:50.307971
[0m00:23:50.306181 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:23:50.307729 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m00:23:50.305545 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:23:50.309167 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m00:23:50.308698 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m00:23:50.303942 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:23:50.308430 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:23:50.310634 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m00:23:50.310132 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e, now model.spacex_analytics.starlink_42k_projection)
[0m00:23:50.310350 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 00:23:50.306424 => 00:23:50.310286
[0m00:23:50.309439 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:23:50.312453 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m00:23:50.312883 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m00:23:50.309881 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 00:23:50.300522 => 00:23:50.309793
[0m00:23:50.311267 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m00:23:50.311738 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m00:23:50.304380 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 00:23:50.288113 => 00:23:50.304323
[0m00:23:50.313304 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:23:50.311490 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:23:50.310962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8, now model.spacex_analytics.starlink_constellation_status)
[0m00:23:50.314831 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m00:23:50.316599 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 00:23:50.316530 => 00:23:50.316534
[0m00:23:50.316791 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 00:23:50.311666 => 00:23:50.316698
[0m00:23:50.317006 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m00:23:50.317555 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:23:50.313904 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:23:50.317948 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m00:23:50.317777 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:23:50.319866 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m00:23:50.318786 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m00:23:50.320186 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m00:23:50.319152 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 00:23:50.313536 => 00:23:50.319060
[0m00:23:50.320341 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m00:23:50.321531 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m00:23:50.321702 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: BEGIN
[0m00:23:50.320496 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 00:23:50.320420 => 00:23:50.320430
[0m00:23:50.321439 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: BEGIN
[0m00:23:50.321242 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m00:23:50.321971 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 00:23:50.321842 => 00:23:50.321846
[0m00:23:50.322095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:50.322245 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m00:23:50.322521 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:23:50.322283 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 00:23:50.317970 => 00:23:50.322205
[0m00:23:50.322717 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: BEGIN
[0m00:23:50.324262 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:23:50.322620 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:23:50.323063 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m00:23:50.323371 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: BEGIN
[0m00:23:50.324493 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m00:23:50.325482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:23:50.325596 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 00:23:50.325519 => 00:23:50.325522
[0m00:23:50.325282 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.326672 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m00:23:50.326457 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.324764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.327348 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m00:23:50.327561 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."launches"
where data is null



      
    ) dbt_internal_test
[0m00:23:50.327160 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m00:23:50.326889 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."rockets"
where id is null



      
    ) dbt_internal_test
[0m00:23:50.327121 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m00:23:50.330259 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."starlink"
where data is null



      
    ) dbt_internal_test
[0m00:23:50.329913 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:23:50.330116 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:23:50.332594 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 00:23:50.304502 => 00:23:50.332500
[0m00:23:50.327865 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.333186 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m00:23:50.332874 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: ROLLBACK
[0m00:23:50.334017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:50.331864 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 00:23:50.311834 => 00:23:50.331780
[0m00:23:50.334318 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m00:23:50.334512 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m00:23:50.334531 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: ROLLBACK
[0m00:23:50.333700 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:23:50.334690 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m00:23:50.335147 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m00:23:50.334366 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: Close
[0m00:23:50.336082 [debug] [MainThread]: Command end result
[0m00:23:50.333994 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."launches"
where id is null



      
    ) dbt_internal_test
[0m00:23:50.334859 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: Close
[0m00:23:50.335509 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 00:23:50.316400 => 00:23:50.335437
[0m00:23:50.339112 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: ROLLBACK
[0m00:23:50.338495 [info ] [Thread-1 (]: 1 of 8 PASS source_not_null_bronze_launches_data ............................... [[32mPASS[0m in 0.05s]
[0m00:23:50.337074 [info ] [Thread-3 (]: 3 of 8 PASS source_not_null_bronze_rockets_id .................................. [[32mPASS[0m in 0.05s]
[0m00:23:50.339395 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:23:50.340915 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 00:23:50.319200 => 00:23:50.340855
[0m00:23:50.341414 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: ROLLBACK
[0m00:23:50.340291 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:23:50.339713 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: Close
[0m00:23:50.339952 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:23:50.342652 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:23:50.342991 [info ] [Thread-1 (]: 6 of 8 START test source_unique_bronze_launches_id ............................. [RUN]
[0m00:23:50.343492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m00:23:50.341714 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: Close
[0m00:23:50.341921 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:23:50.342452 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_bronze_starlink_data ............................... [[32mPASS[0m in 0.06s]
[0m00:23:50.343769 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:23:50.348825 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m00:23:50.349078 [info ] [MainThread]: Building catalog
[0m00:23:50.344863 [info ] [Thread-3 (]: 5 of 8 START test source_not_null_bronze_starlink_id ........................... [RUN]
[0m00:23:50.349584 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m00:23:50.349975 [debug] [ThreadPool]: Acquiring new postgres connection 'spacex_db.information_schema'
[0m00:23:50.350136 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:23:50.352956 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m00:23:50.353274 [debug] [ThreadPool]: On spacex_db.information_schema: BEGIN
[0m00:23:50.353460 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m00:23:50.353488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:50.345213 [info ] [Thread-2 (]: 2 of 8 PASS source_not_null_bronze_launches_id ................................. [[32mPASS[0m in 0.06s]
[0m00:23:50.345618 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:23:50.349207 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m00:23:50.354225 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:23:50.355508 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.355435 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:23:50.355746 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m00:23:50.354564 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:23:50.356018 [debug] [ThreadPool]: On spacex_db.information_schema: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "spacex_db.information_schema"} */

    
    

    select
        'spacex_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('gold') or upper(sch.nspname) = upper('silver') or upper(sch.nspname) = upper('bronze'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m00:23:50.355237 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 00:23:50.352057 => 00:23:50.355091
[0m00:23:50.356874 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:23:50.356313 [info ] [Thread-4 (]: 7 of 8 START test source_unique_bronze_rockets_id .............................. [RUN]
[0m00:23:50.356516 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 00:23:50.345899 => 00:23:50.356432
[0m00:23:50.358541 [debug] [ThreadPool]: SQL status: SELECT 91 in 0.0 seconds
[0m00:23:50.355958 [info ] [Thread-2 (]: 8 of 8 START test source_unique_bronze_starlink_id ............................. [RUN]
[0m00:23:50.361100 [debug] [ThreadPool]: On spacex_db.information_schema: ROLLBACK
[0m00:23:50.361175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m00:23:50.361369 [debug] [ThreadPool]: On spacex_db.information_schema: Close
[0m00:23:50.361570 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:23:50.358780 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:23:50.358072 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m00:23:50.358501 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m00:23:50.365918 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:23:50.365429 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m00:23:50.364347 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m00:23:50.367433 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m00:23:50.369634 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m00:23:50.370645 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: BEGIN
[0m00:23:50.370909 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:23:50.371091 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m00:23:50.372819 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: BEGIN
[0m00:23:50.373397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:50.371258 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 00:23:50.361753 => 00:23:50.371192
[0m00:23:50.373028 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/target/catalog.json
[0m00:23:50.374206 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:23:50.374146 after 0.23 seconds
[0m00:23:50.372454 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 00:23:50.366158 => 00:23:50.372392
[0m00:23:50.374688 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:23:50.373796 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:23:50.374972 [debug] [MainThread]: Connection 'spacex_db.information_schema' was properly closed.
[0m00:23:50.375336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c3cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa282ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2bfe7e0>]}
[0m00:23:50.375555 [debug] [MainThread]: Flushing usage events
[0m00:23:50.375957 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m00:23:50.374911 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:23:50.374408 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.376198 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.378170 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m00:23:50.378554 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m00:23:50.379082 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m00:23:50.380267 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."launches"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:23:50.380019 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."starlink"
where id is null



      
    ) dbt_internal_test
[0m00:23:50.379290 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m00:23:50.380767 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: BEGIN
[0m00:23:50.380976 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:23:50.381553 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:23:50.381228 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m00:23:50.382632 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: BEGIN
[0m00:23:50.382401 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 00:23:50.357162 => 00:23:50.382322
[0m00:23:50.381680 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:23:50.382833 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.382999 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:23:50.383242 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: ROLLBACK
[0m00:23:50.383863 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 00:23:50.364610 => 00:23:50.383797
[0m00:23:50.384802 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: ROLLBACK
[0m00:23:50.384657 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: Close
[0m00:23:50.384130 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m00:23:50.385523 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."starlink"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:23:50.385406 [info ] [Thread-3 (]: 5 of 8 PASS source_not_null_bronze_starlink_id ................................. [[32mPASS[0m in 0.04s]
[0m00:23:50.386231 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:23:50.385693 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: Close
[0m00:23:50.386970 [info ] [Thread-1 (]: 6 of 8 PASS source_unique_bronze_launches_id ................................... [[32mPASS[0m in 0.04s]
[0m00:23:50.387588 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:23:50.387340 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.388179 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m00:23:50.388407 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."rockets"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:23:50.388947 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:23:50.389611 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 00:23:50.376581 => 00:23:50.389543
[0m00:23:50.389890 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: ROLLBACK
[0m00:23:50.390067 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:23:50.390247 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: Close
[0m00:23:50.390775 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 00:23:50.375128 => 00:23:50.390714
[0m00:23:50.391208 [info ] [Thread-4 (]: 7 of 8 PASS source_unique_bronze_rockets_id .................................... [[32mPASS[0m in 0.03s]
[0m00:23:50.391748 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: ROLLBACK
[0m00:23:50.392061 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:23:50.392354 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: Close
[0m00:23:50.393091 [info ] [Thread-2 (]: 8 of 8 PASS source_unique_bronze_starlink_id ................................... [[32mPASS[0m in 0.03s]
[0m00:23:50.393771 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:23:50.395319 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:50.395523 [debug] [MainThread]: On master: BEGIN
[0m00:23:50.395721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:23:50.397267 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:50.397536 [debug] [MainThread]: On master: COMMIT
[0m00:23:50.397767 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:50.398370 [debug] [MainThread]: On master: COMMIT
[0m00:23:50.398631 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:23:50.398837 [debug] [MainThread]: On master: Close
[0m00:23:50.399202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:50.399563 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m00:23:50.399948 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8' was properly closed.
[0m00:23:50.400308 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e' was properly closed.
[0m00:23:50.400755 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m00:23:50.400990 [info ] [MainThread]: 
[0m00:23:50.401217 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m00:23:50.402117 [debug] [MainThread]: Command end result
[0m00:23:50.409266 [info ] [MainThread]: 
[0m00:23:50.409684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:23:50.409900 [info ] [MainThread]: 
[0m00:23:50.410120 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m00:23:50.410396 [debug] [MainThread]: Command `dbt test` succeeded at 00:23:50.410355 after 0.27 seconds
[0m00:23:50.410626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8676e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba9fe8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa30b90>]}
[0m00:23:50.410851 [debug] [MainThread]: Flushing usage events
[0m00:23:52.403481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dda9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dedd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e22a1e0>]}


============================== 00:23:52.405033 | d7f53483-f78f-4ead-a9a6-e7f83465d05b ==============================
[0m00:23:52.405033 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:23:52.405433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run-operation log_results --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:23:52.440904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7f53483-f78f-4ead-a9a6-e7f83465d05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de41ee0>]}
[0m00:23:52.446219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7f53483-f78f-4ead-a9a6-e7f83465d05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d32c1a0>]}
[0m00:23:52.446564 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:23:52.450209 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:23:52.465641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:52.465894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:52.467955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7f53483-f78f-4ead-a9a6-e7f83465d05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d303560>]}
[0m00:23:52.473097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7f53483-f78f-4ead-a9a6-e7f83465d05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d36d730>]}
[0m00:23:52.473363 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:23:52.473578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7f53483-f78f-4ead-a9a6-e7f83465d05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de2eea0>]}
[0m00:23:52.473940 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_results'
[0m00:23:52.474140 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m00:23:52.474308 [debug] [MainThread]: On macro_log_results: BEGIN
[0m00:23:52.474466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:52.476529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:23:52.476759 [debug] [MainThread]: On macro_log_results: COMMIT
[0m00:23:52.476940 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m00:23:52.477113 [debug] [MainThread]: On macro_log_results: COMMIT
[0m00:23:52.477363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:23:52.481884 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m00:23:52.482102 [debug] [MainThread]: On macro_log_results: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "macro_log_results"} */

    
    SELECT 
      "🎯 ANSWER: Launches Needed" as launches_needed,
      "🎯 ANSWER: Months to 42K" as months_needed,
      "🎯 ANSWER: Est. Completion Date" as completion_date,
      "CONFIDENCE: Projection Reliability" as confidence
    FROM gold.starlink_42k_projection
    LIMIT 1
  
  
[0m00:23:52.482480 [debug] [MainThread]: Postgres adapter: Postgres error: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^

[0m00:23:52.482745 [debug] [MainThread]: Postgres adapter: Error running SQL: macro log_results
[0m00:23:52.482940 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m00:23:52.483145 [debug] [MainThread]: On macro_log_results: Close
[0m00:23:52.483471 [error] [MainThread]: Encountered an error while running operation: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^
[0m00:23:52.485244 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 73, in exception_handler
    yield
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1054, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 290, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 146, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 84, in exception_handler
    raise dbt.exceptions.DbtDatabaseError(str(e).strip()) from e
dbt.exceptions.DbtDatabaseError: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^

[0m00:23:52.486351 [debug] [MainThread]: Command `dbt run-operation` failed at 00:23:52.486298 after 0.09 seconds
[0m00:23:52.486572 [debug] [MainThread]: Connection 'macro_log_results' was properly closed.
[0m00:23:52.486771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e15daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddaa480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dda98b0>]}
[0m00:23:52.486974 [debug] [MainThread]: Flushing usage events
[0m00:26:41.229838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb028bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb028a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0288f80>]}


============================== 00:26:41.231521 | 4118fda2-67b3-427c-97b2-f11c40b1973b ==============================
[0m00:26:41.231521 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:26:41.231905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:26:41.267784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4118fda2-67b3-427c-97b2-f11c40b1973b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02bcdd0>]}
[0m00:26:41.273163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4118fda2-67b3-427c-97b2-f11c40b1973b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a92d80>]}
[0m00:26:41.273539 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:26:41.277342 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:26:41.291654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:26:41.292021 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m00:26:41.308881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4118fda2-67b3-427c-97b2-f11c40b1973b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0289d00>]}
[0m00:26:41.313693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4118fda2-67b3-427c-97b2-f11c40b1973b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7885c0>]}
[0m00:26:41.313921 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:26:41.314128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4118fda2-67b3-427c-97b2-f11c40b1973b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf788800>]}
[0m00:26:41.314775 [info ] [MainThread]: 
[0m00:26:41.315143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:26:41.315640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m00:26:41.319044 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m00:26:41.319278 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m00:26:41.319463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:41.321411 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:26:41.321999 [debug] [ThreadPool]: On list_spacex_db: Close
[0m00:26:41.322628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold)
[0m00:26:41.322913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m00:26:41.324930 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:26:41.325679 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:26:41.325927 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:26:41.326153 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:26:41.326349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:26:41.326525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:41.327999 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:26:41.328217 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:26:41.328527 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:26:41.328671 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:26:41.328995 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:26:41.329207 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:26:41.329760 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:26:41.330399 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:26:41.330558 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:26:41.330806 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:26:41.331343 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:26:41.332486 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:26:41.334428 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:41.334645 [debug] [MainThread]: On master: BEGIN
[0m00:26:41.334840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:26:41.336300 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:41.336534 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:41.336787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:26:41.340648 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:26:41.341215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4118fda2-67b3-427c-97b2-f11c40b1973b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1297b00>]}
[0m00:26:41.341481 [debug] [MainThread]: On master: ROLLBACK
[0m00:26:41.341762 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:41.341992 [debug] [MainThread]: On master: BEGIN
[0m00:26:41.342344 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:41.342571 [debug] [MainThread]: On master: COMMIT
[0m00:26:41.342785 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:41.343005 [debug] [MainThread]: On master: COMMIT
[0m00:26:41.343277 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:26:41.343488 [debug] [MainThread]: On master: Close
[0m00:26:41.343829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:26:41.344073 [info ] [MainThread]: 
[0m00:26:41.345529 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m00:26:41.345708 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m00:26:41.345938 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m00:26:41.346295 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m00:26:41.346713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_42k_projection)
[0m00:26:41.347061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_constellation_status)
[0m00:26:41.347331 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m00:26:41.347575 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m00:26:41.350526 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m00:26:41.351649 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m00:26:41.352965 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 00:26:41.350742 => 00:26:41.352881
[0m00:26:41.353268 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m00:26:41.353455 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 00:26:41.347797 => 00:26:41.353368
[0m00:26:41.366808 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m00:26:41.366689 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m00:26:41.368260 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m00:26:41.369586 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:26:41.369867 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m00:26:41.370062 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:26:41.370206 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:26:41.370480 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m00:26:41.370962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:26:41.372133 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:26:41.372293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:26:41.372454 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:26:41.372701 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:26:41.372937 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    CURRENT_TIMESTAMP as status_date,
    
    -- Current constellation
    COUNT(*) as total_satellites,
    COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
    COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
    
    -- Performance
    ROUND((COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*))::numeric, 1) as active_percentage,
    
    -- Timeline
    MIN(launch_date) as first_launch_date,
    MAX(launch_date) as latest_launch_date,
    
    -- Data quality
    MAX(extracted_at) as last_updated,
    ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 1) as data_age_hours

FROM "spacex_db"."silver"."silver_starlink"
WHERE satellite_id IS NOT NULL
  );
  
[0m00:26:41.373228 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH data_timeline AS (
    -- Dynamically determine the data range
    SELECT 
        MIN(launch_date) as first_launch_date,
        MAX(launch_date) as latest_launch_date,
        -- Define "recent" as the last 30% of the available data timeline
        MAX(launch_date) - (MAX(launch_date) - MIN(launch_date)) * 0.3 as recent_period_start
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date IS NOT NULL
),

current_status AS (
    SELECT 
        COUNT(CASE WHEN is_active THEN 1 END) as current_satellites
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_stats AS (
    SELECT 
        dt.first_launch_date,
        dt.latest_launch_date,
        dt.recent_period_start,
        
        COUNT(*) as total_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_launches,
        AVG(CASE WHEN launch_success THEN estimated_satellite_count END)::numeric as avg_sats_per_launch,
        
        -- Dynamic recent launches (last 30% of timeline)
        COUNT(CASE WHEN launch_date >= dt.recent_period_start AND launch_success THEN 1 END) as recent_launches,
        
        -- Calculate launch rate from the entire available dataset
        CASE 
            WHEN dt.latest_launch_date > dt.first_launch_date THEN
                COUNT(CASE WHEN launch_success THEN 1 END)::numeric / 
                GREATEST(1, EXTRACT(MONTH FROM AGE(dt.latest_launch_date, dt.first_launch_date)))
            ELSE 0
        END as avg_monthly_launch_rate
        
    FROM "spacex_db"."silver"."silver_launches" l
    CROSS JOIN data_timeline dt
    WHERE l.is_starlink_mission = true
      AND l.launch_date IS NOT NULL
    GROUP BY dt.first_launch_date, dt.latest_launch_date, dt.recent_period_start
)

SELECT 
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current status
    42000 as target_satellites,
    cs.current_satellites,
    (42000 - cs.current_satellites) as satellites_needed,
    ROUND((cs.current_satellites * 100.0 / 42000)::numeric, 1) as progress_percent,
    
    -- Historical performance
    ls.total_launches,
    ls.successful_launches,
    ROUND(ls.avg_sats_per_launch, 0) as avg_satellites_per_launch,
    ROUND(ls.avg_monthly_launch_rate, 2) as avg_monthly_launch_rate,
    
    -- Business projections
    CASE 
        WHEN ls.avg_sats_per_launch > 0 THEN
            CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch)
        ELSE NULL
    END as launches_needed,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1)
        ELSE NULL
    END as months_to_completion,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            (CURRENT_DATE + INTERVAL '1 month' * ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1))::date
        ELSE NULL
    END as estimated_completion_date,
    
    -- Dynamic confidence based on data availability
    CASE 
        WHEN ls.recent_launches >= 10 THEN 'High Confidence'
        WHEN ls.recent_launches >= 5 THEN 'Medium Confidence'
        WHEN ls.total_launches >= 20 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as projection_confidence,
    
    -- Data context (no hardcoding!)
    ls.first_launch_date as analysis_period_start,
    ls.latest_launch_date as analysis_period_end,
    ls.recent_period_start as recent_period_definition,
    'Projections based on complete historical dataset' as methodology_note

FROM current_status cs
CROSS JOIN launch_stats ls
  );
  
[0m00:26:41.375994 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: date - numeric
LINE 20:         MAX(launch_date) - (MAX(launch_date) - MIN(launch_da...
                                  ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m00:26:41.376256 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m00:26:41.376544 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 00:26:41.367092 => 00:26:41.376471
[0m00:26:41.376739 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m00:26:41.378282 [debug] [Thread-1 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  operator does not exist: date - numeric
  LINE 20:         MAX(launch_date) - (MAX(launch_date) - MIN(launch_da...
                                    ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m00:26:41.378803 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:26:41.379332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4118fda2-67b3-427c-97b2-f11c40b1973b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0289d90>]}
[0m00:26:41.382462 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:26:41.382785 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold.starlink_42k_projection ............. [[31mERROR[0m in 0.03s]
[0m00:26:41.383206 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m00:26:41.383513 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m00:26:41.384188 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:26:41.385244 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:26:41.385463 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m00:26:41.385810 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:26:41.392626 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:26:41.392909 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:26:41.393141 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:26:41.393534 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:26:41.396318 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:26:41.396565 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m00:26:41.397482 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:26:41.398203 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 00:26:41.353559 => 00:26:41.398136
[0m00:26:41.398449 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m00:26:41.398830 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4118fda2-67b3-427c-97b2-f11c40b1973b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1a7fb0>]}
[0m00:26:41.400137 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.05s]
[0m00:26:41.400436 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m00:26:41.401704 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:41.401899 [debug] [MainThread]: On master: BEGIN
[0m00:26:41.402078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:26:41.403379 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:41.403584 [debug] [MainThread]: On master: COMMIT
[0m00:26:41.403754 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:41.403914 [debug] [MainThread]: On master: COMMIT
[0m00:26:41.404129 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:26:41.404289 [debug] [MainThread]: On master: Close
[0m00:26:41.404581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:26:41.404741 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m00:26:41.404890 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m00:26:41.405070 [info ] [MainThread]: 
[0m00:26:41.405241 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m00:26:41.405569 [debug] [MainThread]: Command end result
[0m00:26:41.409074 [info ] [MainThread]: 
[0m00:26:41.409298 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:26:41.409483 [info ] [MainThread]: 
[0m00:26:41.409665 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m00:26:41.409840 [error] [MainThread]:   operator does not exist: date - numeric
[0m00:26:41.410022 [error] [MainThread]:   LINE 20:         MAX(launch_date) - (MAX(launch_date) - MIN(launch_da...
[0m00:26:41.410190 [error] [MainThread]:                                     ^
[0m00:26:41.410362 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m00:26:41.410533 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m00:26:41.410726 [info ] [MainThread]: 
[0m00:26:41.410919 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:26:41.411180 [debug] [MainThread]: Command `dbt run` failed at 00:26:41.411146 after 0.19 seconds
[0m00:26:41.411395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0790110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03ece90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb089a870>]}
[0m00:26:41.411580 [debug] [MainThread]: Flushing usage events
[0m00:28:32.780170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e9ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fb4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922c2330>]}


============================== 00:28:32.781706 | e67f71c4-1fe1-4e3a-9012-9804fee97981 ==============================
[0m00:28:32.781706 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:28:32.782063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:28:32.817513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e67f71c4-1fe1-4e3a-9012-9804fee97981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f224b0>]}
[0m00:28:32.822985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e67f71c4-1fe1-4e3a-9012-9804fee97981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fe80e0>]}
[0m00:28:32.823390 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:28:32.827157 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:28:32.842337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:28:32.842677 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m00:28:32.857973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e67f71c4-1fe1-4e3a-9012-9804fee97981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91429fa0>]}
[0m00:28:32.863055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e67f71c4-1fe1-4e3a-9012-9804fee97981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91388a70>]}
[0m00:28:32.863387 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:28:32.863603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e67f71c4-1fe1-4e3a-9012-9804fee97981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913e7950>]}
[0m00:28:32.864265 [info ] [MainThread]: 
[0m00:28:32.864618 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:28:32.865141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m00:28:32.868707 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m00:28:32.868963 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m00:28:32.869180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:32.871107 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:28:32.871691 [debug] [ThreadPool]: On list_spacex_db: Close
[0m00:28:32.872362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold)
[0m00:28:32.874580 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:28:32.872701 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m00:28:32.874791 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:28:32.875502 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:28:32.875743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:32.875953 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:28:32.876323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:32.877433 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:28:32.877653 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:28:32.877790 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:28:32.878022 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:28:32.878240 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:28:32.878521 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:28:32.879634 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:28:32.880250 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:28:32.881017 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:28:32.881208 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:28:32.881631 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:28:32.882641 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:28:32.884437 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:32.884675 [debug] [MainThread]: On master: BEGIN
[0m00:28:32.884885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:28:32.886050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:28:32.886301 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:32.886569 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:28:32.890475 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:28:32.891033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e67f71c4-1fe1-4e3a-9012-9804fee97981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91382840>]}
[0m00:28:32.891295 [debug] [MainThread]: On master: ROLLBACK
[0m00:28:32.891586 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:32.891808 [debug] [MainThread]: On master: BEGIN
[0m00:28:32.892145 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:28:32.892393 [debug] [MainThread]: On master: COMMIT
[0m00:28:32.892637 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:32.892865 [debug] [MainThread]: On master: COMMIT
[0m00:28:32.893172 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:28:32.893398 [debug] [MainThread]: On master: Close
[0m00:28:32.893742 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:28:32.894247 [info ] [MainThread]: 
[0m00:28:32.895545 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m00:28:32.895745 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m00:28:32.895966 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m00:28:32.896280 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m00:28:32.896679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_42k_projection)
[0m00:28:32.897019 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_constellation_status)
[0m00:28:32.897287 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m00:28:32.897553 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m00:28:32.900581 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m00:28:32.901729 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m00:28:32.903204 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 00:28:32.900836 => 00:28:32.903122
[0m00:28:32.903479 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m00:28:32.903673 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 00:28:32.897773 => 00:28:32.903583
[0m00:28:32.914166 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m00:28:32.916866 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m00:28:32.918215 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m00:28:32.919451 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:32.919684 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m00:28:32.919835 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:28:32.919967 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:28:32.920213 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m00:28:32.920624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:32.921937 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:28:32.922173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:28:32.922313 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:32.922547 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:28:32.922774 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    CURRENT_TIMESTAMP as status_date,
    
    -- Current constellation
    COUNT(*) as total_satellites,
    COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
    COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
    
    -- Performance
    ROUND((COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*))::numeric, 1) as active_percentage,
    
    -- Timeline
    MIN(launch_date) as first_launch_date,
    MAX(launch_date) as latest_launch_date,
    
    -- Data quality
    MAX(extracted_at) as last_updated,
    ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 1) as data_age_hours

FROM "spacex_db"."silver"."silver_starlink"
WHERE satellite_id IS NOT NULL
  );
  
[0m00:28:32.923081 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT 
        COUNT(CASE WHEN is_active THEN 1 END) as current_satellites
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

data_context AS (
    SELECT 
        MIN(launch_date) as first_launch_date,
        MAX(launch_date) as latest_launch_date,
        -- Calculate total days in dataset
        EXTRACT(DAY FROM (MAX(launch_date) - MIN(launch_date))) as total_days
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date IS NOT NULL
),

launch_stats AS (
    SELECT 
        dc.first_launch_date,
        dc.latest_launch_date,
        dc.total_days,
        
        COUNT(*) as total_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_launches,
        AVG(CASE WHEN launch_success THEN estimated_satellite_count END)::numeric as avg_sats_per_launch,
        
        -- Use last 2 years as "recent" (more reliable than percentage)
        COUNT(CASE WHEN launch_date >= dc.latest_launch_date - INTERVAL '2 years' AND launch_success THEN 1 END) as recent_launches,
        
        -- Calculate monthly launch rate from entire dataset
        CASE 
            WHEN dc.total_days > 0 THEN
                (COUNT(CASE WHEN launch_success THEN 1 END)::numeric * 30.0) / dc.total_days
            ELSE 0
        END as avg_monthly_launch_rate
        
    FROM "spacex_db"."silver"."silver_launches" l
    CROSS JOIN data_context dc
    WHERE l.is_starlink_mission = true
      AND l.launch_date IS NOT NULL
    GROUP BY dc.first_launch_date, dc.latest_launch_date, dc.total_days
)

SELECT 
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current status
    42000 as target_satellites,
    cs.current_satellites,
    (42000 - cs.current_satellites) as satellites_needed,
    ROUND((cs.current_satellites * 100.0 / 42000)::numeric, 1) as progress_percent,
    
    -- Historical performance
    ls.total_launches,
    ls.successful_launches,
    ROUND(ls.avg_sats_per_launch, 0) as avg_satellites_per_launch,
    ROUND(ls.avg_monthly_launch_rate, 2) as avg_monthly_launch_rate,
    
    -- Business projections
    CASE 
        WHEN ls.avg_sats_per_launch > 0 THEN
            CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch)
        ELSE NULL
    END as launches_needed,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1)
        ELSE NULL
    END as months_to_completion,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            (CURRENT_DATE + (CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate || ' months')::INTERVAL)::date
        ELSE NULL
    END as estimated_completion_date,
    
    -- Confidence assessment
    CASE 
        WHEN ls.recent_launches >= 10 THEN 'High Confidence'
        WHEN ls.recent_launches >= 5 THEN 'Medium Confidence'
        WHEN ls.total_launches >= 20 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as projection_confidence,
    
    -- Data context
    ls.first_launch_date as analysis_period_start,
    ls.latest_launch_date as analysis_period_end,
    ROUND(ls.total_days::numeric, 0) as dataset_span_days,
    'Based on ' || ls.total_launches || ' historical Starlink launches' as methodology_note

FROM current_status cs
CROSS JOIN launch_stats ls
  );
  
[0m00:28:32.925618 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function pg_catalog.date_part(unknown, integer) does not exist
LINE 26:         EXTRACT(DAY FROM (MAX(launch_date) - MIN(launch_date...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:28:32.927419 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m00:28:32.927770 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 00:28:32.916997 => 00:28:32.927694
[0m00:28:32.928106 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:28:32.928441 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m00:28:32.931437 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:32.931863 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m00:28:32.932664 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:28:32.933705 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:32.933909 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m00:28:32.934263 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:28:32.941123 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:28:32.941717 [debug] [Thread-1 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  function pg_catalog.date_part(unknown, integer) does not exist
  LINE 26:         EXTRACT(DAY FROM (MAX(launch_date) - MIN(launch_date...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m00:28:32.941882 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:32.942257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e67f71c4-1fe1-4e3a-9012-9804fee97981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913b0140>]}
[0m00:28:32.942555 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:28:32.942959 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold.starlink_42k_projection ............. [[31mERROR[0m in 0.05s]
[0m00:28:32.943597 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m00:28:32.943766 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:28:32.947007 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:32.947265 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m00:28:32.948112 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:28:32.948774 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 00:28:32.903768 => 00:28:32.948713
[0m00:28:32.949023 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m00:28:32.949394 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e67f71c4-1fe1-4e3a-9012-9804fee97981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90da7e00>]}
[0m00:28:32.950330 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.05s]
[0m00:28:32.950680 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m00:28:32.951961 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:32.952205 [debug] [MainThread]: On master: BEGIN
[0m00:28:32.952416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:28:32.953772 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:28:32.954001 [debug] [MainThread]: On master: COMMIT
[0m00:28:32.954190 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:32.954414 [debug] [MainThread]: On master: COMMIT
[0m00:28:32.954640 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:28:32.954834 [debug] [MainThread]: On master: Close
[0m00:28:32.955176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:32.955649 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m00:28:32.955844 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m00:28:32.956071 [info ] [MainThread]: 
[0m00:28:32.956330 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m00:28:32.956678 [debug] [MainThread]: Command end result
[0m00:28:32.960689 [info ] [MainThread]: 
[0m00:28:32.960973 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:28:32.961201 [info ] [MainThread]: 
[0m00:28:32.961402 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m00:28:32.961595 [error] [MainThread]:   function pg_catalog.date_part(unknown, integer) does not exist
[0m00:28:32.961783 [error] [MainThread]:   LINE 26:         EXTRACT(DAY FROM (MAX(launch_date) - MIN(launch_date...
[0m00:28:32.961958 [error] [MainThread]:                    ^
[0m00:28:32.962140 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m00:28:32.962314 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m00:28:32.962490 [info ] [MainThread]: 
[0m00:28:32.962683 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:28:32.962923 [debug] [MainThread]: Command `dbt run` failed at 00:28:32.962887 after 0.19 seconds
[0m00:28:32.963151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96667140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c28440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922c2330>]}
[0m00:28:32.963357 [debug] [MainThread]: Flushing usage events
[0m00:28:46.874475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f49f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93452330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9744cc80>]}


============================== 00:28:46.876073 | e6192e5a-effa-4b66-a007-85f4e7d9c023 ==============================
[0m00:28:46.876073 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:28:46.876470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:28:46.913878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6192e5a-effa-4b66-a007-85f4e7d9c023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9347c7a0>]}
[0m00:28:46.919433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6192e5a-effa-4b66-a007-85f4e7d9c023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f98c20>]}
[0m00:28:46.919844 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:28:46.924271 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:28:46.945889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:28:46.946296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:28:46.948723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6192e5a-effa-4b66-a007-85f4e7d9c023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f7ec30>]}
[0m00:28:46.954479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6192e5a-effa-4b66-a007-85f4e7d9c023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92512930>]}
[0m00:28:46.954759 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:28:46.955151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6192e5a-effa-4b66-a007-85f4e7d9c023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93450470>]}
[0m00:28:46.955886 [info ] [MainThread]: 
[0m00:28:46.956342 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:28:46.956952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m00:28:46.960683 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m00:28:46.960909 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m00:28:46.961112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:46.963083 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:28:46.963674 [debug] [ThreadPool]: On list_spacex_db: Close
[0m00:28:46.964338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_silver)
[0m00:28:46.964657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m00:28:46.966669 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:28:46.967462 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:28:46.967693 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:28:46.967916 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:28:46.968120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:46.968321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:46.969606 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:28:46.969944 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:28:46.970087 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:28:46.970263 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:28:46.970526 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:28:46.971024 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:28:46.971813 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:28:46.972001 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:28:46.972528 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:28:46.973085 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:28:46.973400 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:28:46.973582 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:28:46.976232 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:46.976490 [debug] [MainThread]: On master: BEGIN
[0m00:28:46.976712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:28:46.978009 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:28:46.978244 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:46.978477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:28:46.982259 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:28:46.982830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6192e5a-effa-4b66-a007-85f4e7d9c023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93978110>]}
[0m00:28:46.983138 [debug] [MainThread]: On master: ROLLBACK
[0m00:28:46.983421 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:46.983621 [debug] [MainThread]: On master: BEGIN
[0m00:28:46.984011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:28:46.984230 [debug] [MainThread]: On master: COMMIT
[0m00:28:46.984431 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:46.984628 [debug] [MainThread]: On master: COMMIT
[0m00:28:46.984877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:28:46.985070 [debug] [MainThread]: On master: Close
[0m00:28:46.985432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:28:46.985827 [info ] [MainThread]: 
[0m00:28:46.987275 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m00:28:46.987455 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m00:28:46.987677 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m00:28:46.988026 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m00:28:46.988424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_42k_projection)
[0m00:28:46.988783 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_constellation_status)
[0m00:28:46.989112 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m00:28:46.989391 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m00:28:46.992549 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m00:28:46.993811 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m00:28:46.995275 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 00:28:46.992853 => 00:28:46.995191
[0m00:28:46.995554 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m00:28:46.995755 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 00:28:46.989650 => 00:28:46.995655
[0m00:28:47.008700 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m00:28:47.009383 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m00:28:47.010669 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m00:28:47.012055 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:47.012291 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m00:28:47.012517 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:28:47.012701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:28:47.012945 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m00:28:47.013403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:47.015211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:28:47.015362 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:28:47.015711 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:28:47.016059 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:47.016498 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT 
        COUNT(CASE WHEN is_active THEN 1 END) as current_satellites
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

data_context AS (
    SELECT 
        MIN(launch_date) as first_launch_date,
        MAX(launch_date) as latest_launch_date,
        -- Calculate total days in dataset
        EXTRACT(DAY FROM (MAX(launch_date) - MIN(launch_date))) as total_days
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date IS NOT NULL
),

launch_stats AS (
    SELECT 
        dc.first_launch_date,
        dc.latest_launch_date,
        dc.total_days,
        
        COUNT(*) as total_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_launches,
        AVG(CASE WHEN launch_success THEN estimated_satellite_count END)::numeric as avg_sats_per_launch,
        
        -- Use last 2 years as "recent" (more reliable than percentage)
        COUNT(CASE WHEN launch_date >= dc.latest_launch_date - INTERVAL '2 years' AND launch_success THEN 1 END) as recent_launches,
        
        -- Calculate monthly launch rate from entire dataset
        CASE 
            WHEN dc.total_days > 0 THEN
                (COUNT(CASE WHEN launch_success THEN 1 END)::numeric * 30.0) / dc.total_days
            ELSE 0
        END as avg_monthly_launch_rate
        
    FROM "spacex_db"."silver"."silver_launches" l
    CROSS JOIN data_context dc
    WHERE l.is_starlink_mission = true
      AND l.launch_date IS NOT NULL
    GROUP BY dc.first_launch_date, dc.latest_launch_date, dc.total_days
)

SELECT 
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current status
    42000 as target_satellites,
    cs.current_satellites,
    (42000 - cs.current_satellites) as satellites_needed,
    ROUND((cs.current_satellites * 100.0 / 42000)::numeric, 1) as progress_percent,
    
    -- Historical performance
    ls.total_launches,
    ls.successful_launches,
    ROUND(ls.avg_sats_per_launch, 0) as avg_satellites_per_launch,
    ROUND(ls.avg_monthly_launch_rate, 2) as avg_monthly_launch_rate,
    
    -- Business projections
    CASE 
        WHEN ls.avg_sats_per_launch > 0 THEN
            CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch)
        ELSE NULL
    END as launches_needed,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1)
        ELSE NULL
    END as months_to_completion,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            (CURRENT_DATE + (CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate || ' months')::INTERVAL)::date
        ELSE NULL
    END as estimated_completion_date,
    
    -- Confidence assessment
    CASE 
        WHEN ls.recent_launches >= 10 THEN 'High Confidence'
        WHEN ls.recent_launches >= 5 THEN 'Medium Confidence'
        WHEN ls.total_launches >= 20 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as projection_confidence,
    
    -- Data context
    ls.first_launch_date as analysis_period_start,
    ls.latest_launch_date as analysis_period_end,
    ROUND(ls.total_days::numeric, 0) as dataset_span_days,
    'Based on ' || ls.total_launches || ' historical Starlink launches' as methodology_note

FROM current_status cs
CROSS JOIN launch_stats ls
  );
  
[0m00:28:47.016840 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    CURRENT_TIMESTAMP as status_date,
    
    -- Current constellation
    COUNT(*) as total_satellites,
    COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
    COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
    
    -- Performance
    ROUND((COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*))::numeric, 1) as active_percentage,
    
    -- Timeline
    MIN(launch_date) as first_launch_date,
    MAX(launch_date) as latest_launch_date,
    
    -- Data quality
    MAX(extracted_at) as last_updated,
    ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 1) as data_age_hours

FROM "spacex_db"."silver"."silver_starlink"
WHERE satellite_id IS NOT NULL
  );
  
[0m00:28:47.018549 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function pg_catalog.date_part(unknown, integer) does not exist
LINE 26:         EXTRACT(DAY FROM (MAX(launch_date) - MIN(launch_date...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:28:47.020118 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m00:28:47.020537 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 00:28:47.009509 => 00:28:47.020448
[0m00:28:47.022096 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m00:28:47.023637 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:28:47.026078 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:47.026391 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m00:28:47.027222 [debug] [Thread-1 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  function pg_catalog.date_part(unknown, integer) does not exist
  LINE 26:         EXTRACT(DAY FROM (MAX(launch_date) - MIN(launch_date...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m00:28:47.027387 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:28:47.027623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6192e5a-effa-4b66-a007-85f4e7d9c023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9246c920>]}
[0m00:28:47.028556 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:47.028908 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold.starlink_42k_projection ............. [[31mERROR[0m in 0.04s]
[0m00:28:47.029182 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m00:28:47.029605 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m00:28:47.029986 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:28:47.037306 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:28:47.037728 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:47.038021 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:28:47.038763 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:28:47.041454 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:28:47.041693 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m00:28:47.042450 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:28:47.043078 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 00:28:46.995853 => 00:28:47.043016
[0m00:28:47.043299 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m00:28:47.043670 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6192e5a-effa-4b66-a007-85f4e7d9c023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9246cbf0>]}
[0m00:28:47.044143 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.05s]
[0m00:28:47.044444 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m00:28:47.045766 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:47.045960 [debug] [MainThread]: On master: BEGIN
[0m00:28:47.046160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:28:47.047947 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:28:47.048275 [debug] [MainThread]: On master: COMMIT
[0m00:28:47.048523 [debug] [MainThread]: Using postgres connection "master"
[0m00:28:47.048754 [debug] [MainThread]: On master: COMMIT
[0m00:28:47.049054 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:28:47.049297 [debug] [MainThread]: On master: Close
[0m00:28:47.049651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:47.050213 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m00:28:47.050457 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m00:28:47.050680 [info ] [MainThread]: 
[0m00:28:47.051003 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m00:28:47.051378 [debug] [MainThread]: Command end result
[0m00:28:47.055352 [info ] [MainThread]: 
[0m00:28:47.055633 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:28:47.055841 [info ] [MainThread]: 
[0m00:28:47.056055 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m00:28:47.056253 [error] [MainThread]:   function pg_catalog.date_part(unknown, integer) does not exist
[0m00:28:47.056444 [error] [MainThread]:   LINE 26:         EXTRACT(DAY FROM (MAX(launch_date) - MIN(launch_date...
[0m00:28:47.056634 [error] [MainThread]:                    ^
[0m00:28:47.056832 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m00:28:47.057010 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m00:28:47.057190 [info ] [MainThread]: 
[0m00:28:47.057400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:28:47.057670 [debug] [MainThread]: Command `dbt run` failed at 00:28:47.057633 after 0.19 seconds
[0m00:28:47.057896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93385940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9347fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932ff740>]}
[0m00:28:47.058145 [debug] [MainThread]: Flushing usage events
[0m00:29:35.071092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf808800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf98d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc98770>]}


============================== 00:29:35.072600 | e7ed277c-4ba8-446a-aa41-58cdca2e34e2 ==============================
[0m00:29:35.072600 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:29:35.072964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:29:35.109106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7ed277c-4ba8-446a-aa41-58cdca2e34e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf893260>]}
[0m00:29:35.114911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7ed277c-4ba8-446a-aa41-58cdca2e34e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed7ea20>]}
[0m00:29:35.115419 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:29:35.119551 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:29:35.141168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:29:35.141613 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m00:29:35.158499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7ed277c-4ba8-446a-aa41-58cdca2e34e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed00200>]}
[0m00:29:35.164173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7ed277c-4ba8-446a-aa41-58cdca2e34e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaece2ff0>]}
[0m00:29:35.164451 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:29:35.164686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ed277c-4ba8-446a-aa41-58cdca2e34e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf892390>]}
[0m00:29:35.165455 [info ] [MainThread]: 
[0m00:29:35.165844 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:29:35.166427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m00:29:35.170045 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m00:29:35.170277 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m00:29:35.170518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:35.172618 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:29:35.173243 [debug] [ThreadPool]: On list_spacex_db: Close
[0m00:29:35.173965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold)
[0m00:29:35.174414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m00:29:35.176636 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:29:35.177522 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:29:35.177884 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:29:35.178180 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:29:35.178481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:35.178748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:35.180633 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:29:35.180917 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:29:35.181077 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:29:35.181235 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:29:35.181539 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:29:35.182820 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:29:35.183016 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:29:35.183678 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:29:35.184836 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:29:35.185022 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:29:35.185496 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:29:35.186923 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:29:35.188796 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:35.189033 [debug] [MainThread]: On master: BEGIN
[0m00:29:35.189243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:35.190716 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:29:35.190986 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:35.191268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:29:35.195200 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:29:35.195796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ed277c-4ba8-446a-aa41-58cdca2e34e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeced700>]}
[0m00:29:35.196077 [debug] [MainThread]: On master: ROLLBACK
[0m00:29:35.196395 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:35.196630 [debug] [MainThread]: On master: BEGIN
[0m00:29:35.197041 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:29:35.197286 [debug] [MainThread]: On master: COMMIT
[0m00:29:35.197525 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:35.197758 [debug] [MainThread]: On master: COMMIT
[0m00:29:35.198055 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:29:35.198285 [debug] [MainThread]: On master: Close
[0m00:29:35.198671 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:29:35.199182 [info ] [MainThread]: 
[0m00:29:35.200607 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m00:29:35.200798 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m00:29:35.201047 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m00:29:35.201365 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m00:29:35.201754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_42k_projection)
[0m00:29:35.202126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_constellation_status)
[0m00:29:35.202411 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m00:29:35.202677 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m00:29:35.205751 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m00:29:35.206914 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m00:29:35.208449 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 00:29:35.206031 => 00:29:35.208368
[0m00:29:35.208735 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m00:29:35.208932 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 00:29:35.202919 => 00:29:35.208851
[0m00:29:35.221491 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m00:29:35.222411 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m00:29:35.223702 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m00:29:35.225268 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:29:35.225559 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m00:29:35.225721 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:29:35.225877 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:29:35.226496 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m00:29:35.227345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:35.228720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:35.228973 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:29:35.229304 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:35.229510 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT 
        COUNT(CASE WHEN is_active THEN 1 END) as current_satellites
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_stats AS (
    SELECT 
        MIN(launch_date) as first_launch_date,
        MAX(launch_date) as latest_launch_date,
        
        COUNT(*) as total_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_launches,
        AVG(CASE WHEN launch_success THEN estimated_satellite_count END)::numeric as avg_sats_per_launch,
        
        -- Simple approach: count launches in 2022 (most recent complete year)
        COUNT(CASE WHEN EXTRACT(YEAR FROM launch_date) = 2022 AND launch_success THEN 1 END) as launches_2022,
        
        -- Calculate monthly rate from successful launches over total timeline
        -- Using simple division: successful launches / months between first and last launch
        CASE 
            WHEN MAX(launch_date) > MIN(launch_date) THEN
                COUNT(CASE WHEN launch_success THEN 1 END)::numeric / 
                (DATE_PART('year', MAX(launch_date)) - DATE_PART('year', MIN(launch_date))) / 12.0
            ELSE 0
        END as avg_monthly_launch_rate
        
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date IS NOT NULL
)

SELECT 
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current status
    42000 as target_satellites,
    cs.current_satellites,
    (42000 - cs.current_satellites) as satellites_needed,
    ROUND((cs.current_satellites * 100.0 / 42000)::numeric, 1) as progress_percent,
    
    -- Historical performance
    ls.total_launches,
    ls.successful_launches,
    ROUND(ls.avg_sats_per_launch, 0) as avg_satellites_per_launch,
    ROUND(ls.avg_monthly_launch_rate, 2) as avg_monthly_launch_rate,
    ls.launches_2022,
    
    -- Business projections
    CASE 
        WHEN ls.avg_sats_per_launch > 0 THEN
            CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch)
        ELSE NULL
    END as launches_needed,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1)
        ELSE NULL
    END as months_to_completion,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            (CURRENT_DATE + (ROUND((CEILING((42000 - cs.current_satellites) / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1) || ' months')::INTERVAL)::date
        ELSE NULL
    END as estimated_completion_date,
    
    -- Confidence assessment
    CASE 
        WHEN ls.launches_2022 >= 5 THEN 'Medium Confidence'
        WHEN ls.total_launches >= 20 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as projection_confidence,
    
    -- Data context
    ls.first_launch_date,
    ls.latest_launch_date,
    'Projection based on ' || ls.successful_launches || ' successful launches from ' || 
    EXTRACT(YEAR FROM ls.first_launch_date) || ' to ' || EXTRACT(YEAR FROM ls.latest_launch_date) as data_summary

FROM current_status cs
CROSS JOIN launch_stats ls
  );
  
[0m00:29:35.229895 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:29:35.230302 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    CURRENT_TIMESTAMP as status_date,
    
    -- Current constellation
    COUNT(*) as total_satellites,
    COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
    COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
    
    -- Performance
    ROUND((COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*))::numeric, 1) as active_percentage,
    
    -- Timeline
    MIN(launch_date) as first_launch_date,
    MAX(launch_date) as latest_launch_date,
    
    -- Data quality
    MAX(extracted_at) as last_updated,
    ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 1) as data_age_hours

FROM "spacex_db"."silver"."silver_starlink"
WHERE satellite_id IS NOT NULL
  );
  
[0m00:29:35.231934 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 60:     ROUND(ls.avg_monthly_launch_rate, 2) as avg_monthly_laun...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:29:35.232192 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m00:29:35.234222 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 00:29:35.222548 => 00:29:35.234134
[0m00:29:35.234465 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m00:29:35.235887 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:35.238754 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:29:35.239014 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m00:29:35.239389 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:29:35.240024 [debug] [Thread-1 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  function round(double precision, integer) does not exist
  LINE 60:     ROUND(ls.avg_monthly_launch_rate, 2) as avg_monthly_laun...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m00:29:35.240900 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:29:35.241231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ed277c-4ba8-446a-aa41-58cdca2e34e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7413d0>]}
[0m00:29:35.241376 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m00:29:35.241692 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold.starlink_42k_projection ............. [[31mERROR[0m in 0.04s]
[0m00:29:35.242029 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:29:35.242234 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m00:29:35.249571 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:29:35.250292 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:29:35.250641 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:29:35.251457 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:29:35.254318 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:29:35.254544 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m00:29:35.255304 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:29:35.255965 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 00:29:35.209113 => 00:29:35.255904
[0m00:29:35.256213 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m00:29:35.256601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ed277c-4ba8-446a-aa41-58cdca2e34e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed08920>]}
[0m00:29:35.257619 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.05s]
[0m00:29:35.257939 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m00:29:35.259355 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:35.259593 [debug] [MainThread]: On master: BEGIN
[0m00:29:35.259822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:29:35.261234 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:29:35.261482 [debug] [MainThread]: On master: COMMIT
[0m00:29:35.261691 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:35.261885 [debug] [MainThread]: On master: COMMIT
[0m00:29:35.262115 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:29:35.262301 [debug] [MainThread]: On master: Close
[0m00:29:35.262611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:35.263134 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m00:29:35.263371 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m00:29:35.263583 [info ] [MainThread]: 
[0m00:29:35.263838 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m00:29:35.264209 [debug] [MainThread]: Command end result
[0m00:29:35.267968 [info ] [MainThread]: 
[0m00:29:35.268217 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:29:35.268420 [info ] [MainThread]: 
[0m00:29:35.268625 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m00:29:35.268819 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m00:29:35.269015 [error] [MainThread]:   LINE 60:     ROUND(ls.avg_monthly_launch_rate, 2) as avg_monthly_laun...
[0m00:29:35.269197 [error] [MainThread]:                ^
[0m00:29:35.269374 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m00:29:35.269547 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m00:29:35.269726 [info ] [MainThread]: 
[0m00:29:35.269922 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:29:35.270181 [debug] [MainThread]: Command `dbt run` failed at 00:29:35.270147 after 0.20 seconds
[0m00:29:35.270404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e772c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0646780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0491730>]}
[0m00:29:35.270612 [debug] [MainThread]: Flushing usage events
[0m00:31:55.707236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff919d6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915fa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91684c80>]}


============================== 00:31:55.708792 | 263a5d54-f2e3-4298-a2dd-026d0769ad4d ==============================
[0m00:31:55.708792 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:31:55.709155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:31:55.744032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '263a5d54-f2e3-4298-a2dd-026d0769ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907cfda0>]}
[0m00:31:55.749403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '263a5d54-f2e3-4298-a2dd-026d0769ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9124af60>]}
[0m00:31:55.749761 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:31:55.754881 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:31:55.771820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:31:55.772246 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m00:31:55.787348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '263a5d54-f2e3-4298-a2dd-026d0769ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9074dac0>]}
[0m00:31:55.793064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '263a5d54-f2e3-4298-a2dd-026d0769ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907489e0>]}
[0m00:31:55.793376 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:31:55.793707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '263a5d54-f2e3-4298-a2dd-026d0769ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90748b60>]}
[0m00:31:55.794408 [info ] [MainThread]: 
[0m00:31:55.794805 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:55.795363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m00:31:55.798849 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m00:31:55.799087 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m00:31:55.799295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:55.801386 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:31:55.801921 [debug] [ThreadPool]: On list_spacex_db: Close
[0m00:31:55.802550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_silver)
[0m00:31:55.802874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m00:31:55.804856 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:31:55.805653 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:31:55.805900 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:31:55.806131 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:31:55.806332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:55.806541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:55.808496 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:55.808853 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:55.809014 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:31:55.809295 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:31:55.809535 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:31:55.809835 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:31:55.810901 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:31:55.811626 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:31:55.811931 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:31:55.812081 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:31:55.812548 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:31:55.813571 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:31:55.815680 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:55.815913 [debug] [MainThread]: On master: BEGIN
[0m00:31:55.816128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:55.817352 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:55.817585 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:55.817851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:31:55.821549 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:31:55.822110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '263a5d54-f2e3-4298-a2dd-026d0769ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90858fe0>]}
[0m00:31:55.822383 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:55.822673 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:55.822965 [debug] [MainThread]: On master: BEGIN
[0m00:31:55.823337 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:55.823579 [debug] [MainThread]: On master: COMMIT
[0m00:31:55.823808 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:55.824057 [debug] [MainThread]: On master: COMMIT
[0m00:31:55.824333 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:31:55.824555 [debug] [MainThread]: On master: Close
[0m00:31:55.824935 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:55.825447 [info ] [MainThread]: 
[0m00:31:55.826829 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m00:31:55.827034 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m00:31:55.827262 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m00:31:55.827591 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m00:31:55.827975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_42k_projection)
[0m00:31:55.828364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_constellation_status)
[0m00:31:55.828649 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m00:31:55.828917 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m00:31:55.831777 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m00:31:55.832874 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m00:31:55.834331 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 00:31:55.832026 => 00:31:55.834248
[0m00:31:55.834610 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m00:31:55.834811 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 00:31:55.829168 => 00:31:55.834713
[0m00:31:55.847493 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m00:31:55.847662 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m00:31:55.849206 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m00:31:55.850257 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:31:55.850563 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m00:31:55.850859 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:55.851056 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:31:55.851785 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m00:31:55.852019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:55.852701 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:55.852926 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:31:55.853128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:55.853279 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    CURRENT_TIMESTAMP as status_date,
    
    -- Current constellation
    COUNT(*) as total_satellites,
    COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
    COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
    
    -- Performance
    ROUND((COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*))::numeric, 1) as active_percentage,
    
    -- Timeline
    MIN(launch_date) as first_launch_date,
    MAX(launch_date) as latest_launch_date,
    
    -- Data quality
    MAX(extracted_at) as last_updated,
    ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 1) as data_age_hours

FROM "spacex_db"."silver"."silver_starlink"
WHERE satellite_id IS NOT NULL
  );
  
[0m00:31:55.853536 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:31:55.854104 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT 
        COUNT(CASE WHEN is_active THEN 1 END) as current_satellites
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_stats AS (
    SELECT 
        MIN(launch_date) as first_launch_date,
        MAX(launch_date) as latest_launch_date,
        
        COUNT(*) as total_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_launches,
        (AVG(CASE WHEN launch_success THEN estimated_satellite_count END))::numeric as avg_sats_per_launch,
        
        -- Simple approach: count launches in 2022 (most recent complete year)
        COUNT(CASE WHEN EXTRACT(YEAR FROM launch_date) = 2022 AND launch_success THEN 1 END) as launches_2022,
        
        -- Calculate monthly rate - cast everything to numeric
        CASE 
            WHEN MAX(launch_date) > MIN(launch_date) THEN
                (COUNT(CASE WHEN launch_success THEN 1 END)::numeric) / 
                ((DATE_PART('year', MAX(launch_date)) - DATE_PART('year', MIN(launch_date)))::numeric * 12.0)
            ELSE 0::numeric
        END as avg_monthly_launch_rate
        
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date IS NOT NULL
)

SELECT 
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current status
    42000 as target_satellites,
    cs.current_satellites,
    (42000 - cs.current_satellites) as satellites_needed,
    ROUND((cs.current_satellites * 100.0 / 42000)::numeric, 1) as progress_percent,
    
    -- Historical performance
    ls.total_launches,
    ls.successful_launches,
    ROUND(ls.avg_sats_per_launch::numeric, 0) as avg_satellites_per_launch,
    ROUND(ls.avg_monthly_launch_rate::numeric, 2) as avg_monthly_launch_rate,
    ls.launches_2022,
    
    -- Business projections
    CASE 
        WHEN ls.avg_sats_per_launch > 0 THEN
            CEILING((42000 - cs.current_satellites)::numeric / ls.avg_sats_per_launch)
        ELSE NULL
    END as launches_needed,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            ROUND((CEILING((42000 - cs.current_satellites)::numeric / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1)
        ELSE NULL
    END as months_to_completion,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            (CURRENT_DATE + (ROUND((CEILING((42000 - cs.current_satellites)::numeric / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1) || ' months')::INTERVAL)::date
        ELSE NULL
    END as estimated_completion_date,
    
    -- Confidence assessment
    CASE 
        WHEN ls.launches_2022 >= 5 THEN 'Medium Confidence'
        WHEN ls.total_launches >= 20 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as projection_confidence,
    
    -- Data context
    ls.first_launch_date,
    ls.latest_launch_date,
    ('Projection based on ' || ls.successful_launches || ' successful launches from ' || 
    EXTRACT(YEAR FROM ls.first_launch_date) || ' to ' || EXTRACT(YEAR FROM ls.latest_launch_date)) as data_summary

FROM current_status cs
CROSS JOIN launch_stats ls
  );
  
[0m00:31:55.858335 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:55.861393 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:31:55.861673 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m00:31:55.861827 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:55.862107 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:31:55.862963 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:31:55.864034 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:31:55.864291 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection" rename to "starlink_42k_projection__dbt_backup"
[0m00:31:55.864524 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m00:31:55.864834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:31:55.865062 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:31:55.865923 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:31:55.872785 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:31:55.873014 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp" rename to "starlink_42k_projection"
[0m00:31:55.873309 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:31:55.873725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:31:55.873871 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m00:31:55.874648 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m00:31:55.875093 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:31:55.875363 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m00:31:55.875499 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:31:55.878349 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m00:31:55.878492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:31:55.878628 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m00:31:55.879558 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m00:31:55.880064 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
drop table if exists "spacex_db"."gold"."starlink_42k_projection__dbt_backup" cascade
[0m00:31:55.880375 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:31:55.881050 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 00:31:55.834918 => 00:31:55.880957
[0m00:31:55.881180 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:31:55.881324 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m00:31:55.881909 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 00:31:55.848081 => 00:31:55.881858
[0m00:31:55.883157 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263a5d54-f2e3-4298-a2dd-026d0769ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9073d940>]}
[0m00:31:55.883310 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m00:31:55.883644 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.05s]
[0m00:31:55.884284 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m00:31:55.884967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263a5d54-f2e3-4298-a2dd-026d0769ad4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907416a0>]}
[0m00:31:55.885275 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold.starlink_42k_projection ................. [[32mSELECT 1[0m in 0.06s]
[0m00:31:55.885684 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m00:31:55.886871 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:55.887094 [debug] [MainThread]: On master: BEGIN
[0m00:31:55.887297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:55.888564 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:55.888795 [debug] [MainThread]: On master: COMMIT
[0m00:31:55.889001 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:55.889192 [debug] [MainThread]: On master: COMMIT
[0m00:31:55.889422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:31:55.889613 [debug] [MainThread]: On master: Close
[0m00:31:55.889931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:55.890405 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m00:31:55.890589 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m00:31:55.890800 [info ] [MainThread]: 
[0m00:31:55.891070 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m00:31:55.891429 [debug] [MainThread]: Command end result
[0m00:31:55.895259 [info ] [MainThread]: 
[0m00:31:55.895513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:55.895723 [info ] [MainThread]: 
[0m00:31:55.895942 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:31:55.896226 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:55.896192 after 0.19 seconds
[0m00:31:55.896446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91886900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916eac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916ea3f0>]}
[0m00:31:55.896674 [debug] [MainThread]: Flushing usage events
[0m00:31:58.850591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ee9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a41fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a35ef00>]}


============================== 00:31:58.852540 | e82a12d3-b94c-4627-94dd-22f5c13d3bfd ==============================
[0m00:31:58.852540 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:31:58.853129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir .', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:31:58.852464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983f9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9855ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98898770>]}


============================== 00:31:58.854159 | 9d47bcd3-274b-41d1-b41a-308bb588e014 ==============================
[0m00:31:58.854159 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:31:58.854713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m00:31:58.898175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e82a12d3-b94c-4627-94dd-22f5c13d3bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8f9580>]}
[0m00:31:58.898172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d47bcd3-274b-41d1-b41a-308bb588e014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9889b470>]}
[0m00:31:58.904392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e82a12d3-b94c-4627-94dd-22f5c13d3bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8946c980>]}
[0m00:31:58.904395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d47bcd3-274b-41d1-b41a-308bb588e014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988b92e0>]}
[0m00:31:58.904947 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:31:58.905049 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:31:58.909747 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:31:58.909771 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:31:58.928867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:58.929195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:58.929818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:58.930095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:58.931534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d47bcd3-274b-41d1-b41a-308bb588e014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97994e60>]}
[0m00:31:58.932319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e82a12d3-b94c-4627-94dd-22f5c13d3bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f825d0>]}
[0m00:31:58.935104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e82a12d3-b94c-4627-94dd-22f5c13d3bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894b69c0>]}
[0m00:31:58.935445 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:31:58.935682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e82a12d3-b94c-4627-94dd-22f5c13d3bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894b6360>]}
[0m00:31:58.936738 [info ] [MainThread]: 
[0m00:31:58.937198 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:58.937360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d47bcd3-274b-41d1-b41a-308bb588e014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979c6c00>]}
[0m00:31:58.937734 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:31:58.937925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m00:31:58.938148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d47bcd3-274b-41d1-b41a-308bb588e014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979c6900>]}
[0m00:31:58.939087 [info ] [MainThread]: 
[0m00:31:58.939570 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:58.940208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m00:31:58.938268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m00:31:58.944173 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:31:58.944488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m00:31:58.944641 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:31:58.945433 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:31:58.945652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:58.942444 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:31:58.946458 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m00:31:58.945864 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:31:58.947135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:58.945689 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:31:58.947439 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m00:31:58.947057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:58.948162 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:58.947917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:58.949148 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:31:58.949810 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:31:58.950809 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:58.951232 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:31:58.951402 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:58.951679 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:58.951734 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:31:58.952222 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m00:31:58.952022 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:31:58.952016 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m00:31:58.952849 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m00:31:58.952555 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m00:31:58.953533 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:31:58.953730 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:31:58.953808 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:31:58.954738 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m00:31:58.954863 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:31:58.954744 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:31:58.955238 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:31:58.955151 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m00:31:58.956755 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:31:58.956591 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m00:31:58.958071 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m00:31:58.959532 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:58.959792 [debug] [MainThread]: On master: BEGIN
[0m00:31:58.960016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:58.960600 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:58.961061 [debug] [MainThread]: On master: BEGIN
[0m00:31:58.961281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:58.961858 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:58.962176 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:58.962424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:31:58.963272 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:58.963486 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:58.963719 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:31:58.966860 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:31:58.968461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d47bcd3-274b-41d1-b41a-308bb588e014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979954c0>]}
[0m00:31:58.969704 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:31:58.969861 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:58.970589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e82a12d3-b94c-4627-94dd-22f5c13d3bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89503290>]}
[0m00:31:58.970870 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:58.970936 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:58.971166 [debug] [MainThread]: On master: BEGIN
[0m00:31:58.971355 [debug] [MainThread]: On master: Close
[0m00:31:58.971751 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:58.972012 [debug] [MainThread]: On master: COMMIT
[0m00:31:58.972276 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:58.972534 [debug] [MainThread]: On master: COMMIT
[0m00:31:58.971914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:58.973311 [info ] [MainThread]: 
[0m00:31:58.973211 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:31:58.974060 [debug] [MainThread]: On master: Close
[0m00:31:58.974563 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:58.975082 [info ] [MainThread]: 
[0m00:31:58.976186 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m00:31:58.977003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_launches)
[0m00:31:58.976743 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:31:58.976910 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:31:58.976464 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:31:58.977050 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:31:58.978139 [info ] [Thread-3 (]: 3 of 8 START test source_not_null_bronze_rockets_id ............................ [RUN]
[0m00:31:58.976565 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:31:58.977408 [info ] [Thread-1 (]: 1 of 8 START test source_not_null_bronze_launches_data ......................... [RUN]
[0m00:31:58.976341 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m00:31:58.977742 [info ] [Thread-2 (]: 2 of 8 START test source_not_null_bronze_launches_id ........................... [RUN]
[0m00:31:58.977263 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m00:31:58.977213 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:31:58.979811 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_bronze_starlink_data ......................... [RUN]
[0m00:31:58.980260 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed'
[0m00:31:58.980490 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:31:58.978065 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae'
[0m00:31:58.983098 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:31:58.978567 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1'
[0m00:31:58.986562 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:31:58.979359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_starlink)
[0m00:31:58.987642 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m00:31:58.978973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae)
[0m00:31:58.979476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb)
[0m00:31:58.986412 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m00:31:58.988165 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m00:31:58.988447 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:31:58.978938 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb'
[0m00:31:58.990413 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:31:58.992290 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m00:31:58.988712 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:31:58.990132 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m00:31:58.992696 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m00:31:58.987340 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m00:31:58.999883 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m00:31:58.982655 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m00:31:59.000214 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 00:31:58.986776 => 00:31:59.000121
[0m00:31:59.001107 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 00:31:58.991038 => 00:31:59.000935
[0m00:31:59.001915 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:31:59.000390 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 00:31:58.980683 => 00:31:59.000318
[0m00:31:59.001524 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:31:59.002241 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 00:31:58.987861 => 00:31:59.002149
[0m00:31:59.005118 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m00:31:59.005409 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 00:31:59.005342 => 00:31:59.005347
[0m00:31:59.005854 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m00:31:59.002836 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 00:31:59.002582 => 00:31:59.002592
[0m00:31:59.006568 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:31:59.003155 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 00:31:58.983300 => 00:31:59.003097
[0m00:31:59.006099 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:31:59.003021 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 00:31:58.979659 => 00:31:59.002939
[0m00:31:59.008000 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m00:31:59.001738 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 00:31:58.989281 => 00:31:59.001661
[0m00:31:59.007173 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:31:59.008556 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 00:31:59.008490 => 00:31:59.008492
[0m00:31:59.002415 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 00:31:58.998526 => 00:31:59.002339
[0m00:31:59.002710 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:31:59.006946 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:31:59.009823 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m00:31:59.010108 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed)
[0m00:31:59.008654 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:31:59.007673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_starlink, now test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1)
[0m00:31:59.011200 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:31:59.008265 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 00:31:59.008179 => 00:31:59.008182
[0m00:31:59.008916 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:31:59.010455 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:31:59.008007 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m00:31:59.013061 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m00:31:59.013401 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m00:31:59.014297 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m00:31:59.015056 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: BEGIN
[0m00:31:59.015867 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:31:59.015738 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m00:31:59.015395 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m00:31:59.016904 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: BEGIN
[0m00:31:59.017087 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:31:59.016224 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m00:31:59.017595 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: BEGIN
[0m00:31:59.016712 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: BEGIN
[0m00:31:59.009175 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:31:59.018629 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:59.012842 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m00:31:59.013624 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m00:31:59.018030 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:59.018506 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m00:31:59.019018 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:59.018931 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:31:59.020682 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m00:31:59.018786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:59.019326 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m00:31:59.021312 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."starlink"
where data is null



      
    ) dbt_internal_test
[0m00:31:59.020406 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m00:31:59.019690 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:31:59.022052 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."rockets"
where id is null



      
    ) dbt_internal_test
[0m00:31:59.022245 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:59.022783 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m00:31:59.021079 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 00:31:59.011373 => 00:31:59.020791
[0m00:31:59.023401 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."launches"
where id is null



      
    ) dbt_internal_test
[0m00:31:59.023045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_launches, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m00:31:59.023022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:59.023958 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m00:31:59.023616 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:59.021538 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:31:59.024177 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."launches"
where data is null



      
    ) dbt_internal_test
[0m00:31:59.026073 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:59.023560 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 00:31:59.014435 => 00:31:59.023501
[0m00:31:59.025440 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 00:31:59.002891 => 00:31:59.025366
[0m00:31:59.023415 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:31:59.025578 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:59.027137 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 00:31:59.027073 => 00:31:59.027077
[0m00:31:59.024378 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:59.026130 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m00:31:59.026664 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 00:31:59.010505 => 00:31:59.026597
[0m00:31:59.026847 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:31:59.026931 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: ROLLBACK
[0m00:31:59.027526 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 00:31:59.013591 => 00:31:59.027461
[0m00:31:59.023875 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:31:59.029045 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: ROLLBACK
[0m00:31:59.028501 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: ROLLBACK
[0m00:31:59.028864 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: Close
[0m00:31:59.028264 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 00:31:59.009104 => 00:31:59.028178
[0m00:31:59.030063 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: ROLLBACK
[0m00:31:59.029382 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: Close
[0m00:31:59.031417 [info ] [Thread-1 (]: 1 of 8 PASS source_not_null_bronze_launches_data ............................... [[32mPASS[0m in 0.05s]
[0m00:31:59.027878 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:31:59.031105 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: Close
[0m00:31:59.032059 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: Close
[0m00:31:59.030393 [info ] [Thread-3 (]: 3 of 8 PASS source_not_null_bronze_rockets_id .................................. [[32mPASS[0m in 0.05s]
[0m00:31:59.033571 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m00:31:59.033837 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:31:59.032549 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:31:59.034302 [info ] [Thread-3 (]: 5 of 8 START test source_not_null_bronze_starlink_id ........................... [RUN]
[0m00:31:59.031410 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m00:31:59.031713 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 00:31:59.024581 => 00:31:59.031647
[0m00:31:59.032527 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m00:31:59.028753 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 00:31:59.028680 => 00:31:59.028683
[0m00:31:59.032903 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_bronze_starlink_data ............................... [[32mPASS[0m in 0.05s]
[0m00:31:59.034590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m00:31:59.033339 [info ] [Thread-2 (]: 2 of 8 PASS source_not_null_bronze_launches_id ................................. [[32mPASS[0m in 0.05s]
[0m00:31:59.036037 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:31:59.036216 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m00:31:59.036511 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:31:59.036915 [info ] [Thread-2 (]: 7 of 8 START test source_unique_bronze_rockets_id .............................. [RUN]
[0m00:31:59.034769 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m00:31:59.035162 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:31:59.035643 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:31:59.035515 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m00:31:59.038485 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:31:59.035894 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 00:31:59.029165 => 00:31:59.035806
[0m00:31:59.038969 [info ] [Thread-4 (]: 8 of 8 START test source_unique_bronze_starlink_id ............................. [RUN]
[0m00:31:59.035019 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:31:59.039723 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 00:31:59.039640 => 00:31:59.039645
[0m00:31:59.039494 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m00:31:59.037372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m00:31:59.038710 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:31:59.037900 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:31:59.040526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m00:31:59.038210 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m00:31:59.038186 [info ] [Thread-1 (]: 6 of 8 START test source_unique_bronze_launches_id ............................. [RUN]
[0m00:31:59.040218 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:31:59.040065 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:31:59.039229 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:31:59.045258 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 00:31:59.045178 => 00:31:59.045182
[0m00:31:59.045714 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:31:59.040249 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:31:59.042096 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:31:59.042183 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m00:31:59.042555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m00:31:59.048498 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:31:59.042680 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m00:31:59.047849 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m00:31:59.046082 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 00:31:59.036363 => 00:31:59.045995
[0m00:31:59.045855 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m00:31:59.046311 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m00:31:59.050037 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m00:31:59.050392 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 00:31:59.040476 => 00:31:59.050293
[0m00:31:59.051280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8, now model.spacex_analytics.starlink_42k_projection)
[0m00:31:59.050164 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e, now model.spacex_analytics.starlink_constellation_status)
[0m00:31:59.051523 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 00:31:59.046328 => 00:31:59.051408
[0m00:31:59.050551 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:31:59.052034 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:31:59.049728 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m00:31:59.052237 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m00:31:59.052532 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m00:31:59.052902 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:31:59.053240 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 00:31:59.053154 => 00:31:59.053159
[0m00:31:59.053251 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 00:31:59.048677 => 00:31:59.053142
[0m00:31:59.059724 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:31:59.059513 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:31:59.058104 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m00:31:59.059162 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 00:31:59.048053 => 00:31:59.059069
[0m00:31:59.056811 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m00:31:59.058942 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m00:31:59.060713 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:31:59.059490 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 00:31:59.043040 => 00:31:59.059414
[0m00:31:59.057159 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m00:31:59.061626 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 00:31:59.057115 => 00:31:59.061503
[0m00:31:59.064386 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m00:31:59.062341 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m00:31:59.063489 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 00:31:59.063401 => 00:31:59.063405
[0m00:31:59.063707 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:31:59.064851 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 00:31:59.064765 => 00:31:59.064768
[0m00:31:59.067683 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m00:31:59.067134 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:31:59.068569 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m00:31:59.065112 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m00:31:59.065858 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 00:31:59.054494 => 00:31:59.065762
[0m00:31:59.068941 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m00:31:59.070111 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m00:31:59.070515 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: BEGIN
[0m00:31:59.070921 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 00:31:59.070792 => 00:31:59.070797
[0m00:31:59.069732 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: BEGIN
[0m00:31:59.071441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:31:59.071737 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m00:31:59.070639 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m00:31:59.072689 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: BEGIN
[0m00:31:59.070371 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m00:31:59.071098 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:31:59.073004 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:31:59.073964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:59.073428 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: BEGIN
[0m00:31:59.075069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:59.074948 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m00:31:59.074575 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:59.075541 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m00:31:59.076329 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."rockets"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:31:59.075429 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m00:31:59.076138 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:59.076885 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m00:31:59.076774 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m00:31:59.076627 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:59.077530 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m00:31:59.077414 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m00:31:59.077194 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."starlink"
where id is null



      
    ) dbt_internal_test
[0m00:31:59.078759 [debug] [MainThread]: Command end result
[0m00:31:59.077769 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."starlink"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:31:59.078889 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:59.079055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:31:59.081067 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:59.082140 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:59.081911 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 00:31:59.058248 => 00:31:59.081837
[0m00:31:59.082407 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m00:31:59.083290 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 00:31:59.053612 => 00:31:59.083225
[0m00:31:59.084745 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 00:31:59.066965 => 00:31:59.084572
[0m00:31:59.086024 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: ROLLBACK
[0m00:31:59.085464 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."launches"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:31:59.085725 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: ROLLBACK
[0m00:31:59.085192 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: ROLLBACK
[0m00:31:59.086314 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: Close
[0m00:31:59.086923 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:59.087143 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: Close
[0m00:31:59.087355 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: Close
[0m00:31:59.089952 [info ] [Thread-2 (]: 7 of 8 PASS source_unique_bronze_rockets_id .................................... [[32mPASS[0m in 0.05s]
[0m00:31:59.088792 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 00:31:59.059896 => 00:31:59.088623
[0m00:31:59.089318 [info ] [Thread-3 (]: 5 of 8 PASS source_not_null_bronze_starlink_id ................................. [[32mPASS[0m in 0.05s]
[0m00:31:59.087812 [info ] [Thread-4 (]: 8 of 8 PASS source_unique_bronze_starlink_id ................................... [[32mPASS[0m in 0.05s]
[0m00:31:59.091444 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m00:31:59.090764 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: ROLLBACK
[0m00:31:59.091779 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m00:31:59.091100 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m00:31:59.092168 [info ] [MainThread]: Building catalog
[0m00:31:59.090472 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m00:31:59.092307 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: Close
[0m00:31:59.093450 [debug] [ThreadPool]: Acquiring new postgres connection 'spacex_db.information_schema'
[0m00:31:59.093712 [info ] [Thread-1 (]: 6 of 8 PASS source_unique_bronze_launches_id ................................... [[32mPASS[0m in 0.05s]
[0m00:31:59.094272 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m00:31:59.095971 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:59.096211 [debug] [MainThread]: On master: BEGIN
[0m00:31:59.096305 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m00:31:59.096383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:59.096524 [debug] [ThreadPool]: On spacex_db.information_schema: BEGIN
[0m00:31:59.096834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:59.098122 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:59.098366 [debug] [MainThread]: On master: COMMIT
[0m00:31:59.098548 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:59.098750 [debug] [MainThread]: On master: COMMIT
[0m00:31:59.099250 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:31:59.099325 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:59.099583 [debug] [MainThread]: On master: Close
[0m00:31:59.099748 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m00:31:59.100274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:59.101111 [debug] [ThreadPool]: On spacex_db.information_schema: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "spacex_db.information_schema"} */

    
    

    select
        'spacex_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('gold') or upper(sch.nspname) = upper('silver') or upper(sch.nspname) = upper('bronze'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m00:31:59.101215 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m00:31:59.101530 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8' was properly closed.
[0m00:31:59.101706 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e' was properly closed.
[0m00:31:59.101873 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m00:31:59.103186 [info ] [MainThread]: 
[0m00:31:59.103356 [debug] [ThreadPool]: SQL status: SELECT 92 in 0.0 seconds
[0m00:31:59.103529 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m00:31:59.106648 [debug] [MainThread]: Command end result
[0m00:31:59.106131 [debug] [ThreadPool]: On spacex_db.information_schema: ROLLBACK
[0m00:31:59.108480 [debug] [ThreadPool]: On spacex_db.information_schema: Close
[0m00:31:59.112907 [info ] [MainThread]: 
[0m00:31:59.113359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:59.113572 [info ] [MainThread]: 
[0m00:31:59.113915 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m00:31:59.114362 [debug] [MainThread]: Command `dbt test` succeeded at 00:31:59.114289 after 0.27 seconds
[0m00:31:59.116264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bcd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98878d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984dd160>]}
[0m00:31:59.116511 [debug] [MainThread]: Flushing usage events
[0m00:31:59.119875 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/target/catalog.json
[0m00:31:59.120321 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:31:59.120270 after 0.27 seconds
[0m00:31:59.120766 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:31:59.121037 [debug] [MainThread]: Connection 'spacex_db.information_schema' was properly closed.
[0m00:31:59.121472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a41fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a06bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae30d70>]}
[0m00:31:59.121763 [debug] [MainThread]: Flushing usage events
[0m00:32:01.993287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6fca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b772f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac6e180>]}


============================== 00:32:01.994863 | 9bf4b736-6a78-4700-942f-a0a39104c2eb ==============================
[0m00:32:01.994863 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:32:01.995287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation log_results --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:32:02.032814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bf4b736-6a78-4700-942f-a0a39104c2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad50320>]}
[0m00:32:02.038222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bf4b736-6a78-4700-942f-a0a39104c2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6ffe00>]}
[0m00:32:02.038641 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:32:02.043404 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:32:02.059314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:32:02.059610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:32:02.061782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bf4b736-6a78-4700-942f-a0a39104c2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab6f170>]}
[0m00:32:02.067069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bf4b736-6a78-4700-942f-a0a39104c2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cbb290>]}
[0m00:32:02.067316 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m00:32:02.067673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf4b736-6a78-4700-942f-a0a39104c2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6fdfa0>]}
[0m00:32:02.068050 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_results'
[0m00:32:02.068256 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m00:32:02.068430 [debug] [MainThread]: On macro_log_results: BEGIN
[0m00:32:02.068595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:32:02.070505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:32:02.070755 [debug] [MainThread]: On macro_log_results: COMMIT
[0m00:32:02.070943 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m00:32:02.071125 [debug] [MainThread]: On macro_log_results: COMMIT
[0m00:32:02.071337 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:32:02.075785 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m00:32:02.075999 [debug] [MainThread]: On macro_log_results: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "macro_log_results"} */

    
    SELECT 
      "🎯 ANSWER: Launches Needed" as launches_needed,
      "🎯 ANSWER: Months to 42K" as months_needed,
      "🎯 ANSWER: Est. Completion Date" as completion_date,
      "CONFIDENCE: Projection Reliability" as confidence
    FROM gold.starlink_42k_projection
    LIMIT 1
  
  
[0m00:32:02.076420 [debug] [MainThread]: Postgres adapter: Postgres error: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^

[0m00:32:02.076742 [debug] [MainThread]: Postgres adapter: Error running SQL: macro log_results
[0m00:32:02.076930 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m00:32:02.077126 [debug] [MainThread]: On macro_log_results: Close
[0m00:32:02.077458 [error] [MainThread]: Encountered an error while running operation: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^
[0m00:32:02.079140 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 73, in exception_handler
    yield
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1054, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 290, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 146, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 84, in exception_handler
    raise dbt.exceptions.DbtDatabaseError(str(e).strip()) from e
dbt.exceptions.DbtDatabaseError: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^

[0m00:32:02.080265 [debug] [MainThread]: Command `dbt run-operation` failed at 00:32:02.080219 after 0.09 seconds
[0m00:32:02.080466 [debug] [MainThread]: Connection 'macro_log_results' was properly closed.
[0m00:32:02.080644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca98b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a82bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c629c0>]}
[0m00:32:02.080829 [debug] [MainThread]: Flushing usage events
[0m01:58:46.984806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ceb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa315ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3337740>]}


============================== 01:58:46.986486 | 3e1a3ece-30d7-4728-b791-c74c5bc96169 ==============================
[0m01:58:46.986486 [info ] [MainThread]: Running with dbt=1.6.0
[0m01:58:46.986837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m01:58:47.007889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e1a3ece-30d7-4728-b791-c74c5bc96169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d1ffb0>]}
[0m01:58:47.008415 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:58:47.008805 [debug] [MainThread]: Command `dbt deps` succeeded at 01:58:47.008749 after 0.03 seconds
[0m01:58:47.009075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa315ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31a8b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d3be60>]}
[0m01:58:47.009327 [debug] [MainThread]: Flushing usage events
[0m01:58:48.987412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3634a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b2d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36cba40>]}


============================== 01:58:48.988945 | b273c18b-1218-4dc4-8b21-f7b4d71ce98e ==============================
[0m01:58:48.988945 [info ] [MainThread]: Running with dbt=1.6.0
[0m01:58:48.989272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models silver --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m01:58:49.031002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b273c18b-1218-4dc4-8b21-f7b4d71ce98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39db710>]}
[0m01:58:49.036637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b273c18b-1218-4dc4-8b21-f7b4d71ce98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b99700>]}
[0m01:58:49.037051 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m01:58:49.040882 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m01:58:49.058259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:58:49.058621 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m01:58:49.075439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b273c18b-1218-4dc4-8b21-f7b4d71ce98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b998b0>]}
[0m01:58:49.081277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b273c18b-1218-4dc4-8b21-f7b4d71ce98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b0fd40>]}
[0m01:58:49.081510 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m01:58:49.081729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b273c18b-1218-4dc4-8b21-f7b4d71ce98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3759e20>]}
[0m01:58:49.082426 [info ] [MainThread]: 
[0m01:58:49.082801 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:58:49.083341 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m01:58:49.086998 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m01:58:49.087252 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m01:58:49.087444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:49.089807 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m01:58:49.090422 [debug] [ThreadPool]: On list_spacex_db: Close
[0m01:58:49.091122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_silver)
[0m01:58:49.091368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m01:58:49.093522 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m01:58:49.094332 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m01:58:49.094603 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m01:58:49.094885 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m01:58:49.095146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:58:49.095408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:49.097152 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:58:49.097802 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m01:58:49.097458 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:58:49.098359 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m01:58:49.098085 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m01:58:49.098609 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m01:58:49.099989 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:49.101354 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m01:58:49.100840 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:49.102100 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m01:58:49.101718 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m01:58:49.102379 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m01:58:49.105136 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:49.105382 [debug] [MainThread]: On master: BEGIN
[0m01:58:49.105589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:58:49.106830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:49.107099 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:49.107376 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:58:49.111758 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:49.112365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b273c18b-1218-4dc4-8b21-f7b4d71ce98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2beee40>]}
[0m01:58:49.112659 [debug] [MainThread]: On master: ROLLBACK
[0m01:58:49.112959 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:49.113171 [debug] [MainThread]: On master: BEGIN
[0m01:58:49.113559 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:49.113799 [debug] [MainThread]: On master: COMMIT
[0m01:58:49.114090 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:49.114349 [debug] [MainThread]: On master: COMMIT
[0m01:58:49.114642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:58:49.114900 [debug] [MainThread]: On master: Close
[0m01:58:49.115364 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:58:49.116058 [info ] [MainThread]: 
[0m01:58:49.117426 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m01:58:49.117614 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m01:58:49.117858 [info ] [Thread-1 (]: 1 of 2 START sql view model silver.silver_launches ............................. [RUN]
[0m01:58:49.118178 [info ] [Thread-2 (]: 2 of 2 START sql view model silver.silver_starlink ............................. [RUN]
[0m01:58:49.118579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_launches)
[0m01:58:49.118949 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_starlink)
[0m01:58:49.119243 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m01:58:49.119553 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m01:58:49.124174 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m01:58:49.122676 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m01:58:49.125985 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 01:58:49.122953 => 01:58:49.125909
[0m01:58:49.126383 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m01:58:49.126274 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 01:58:49.119786 => 01:58:49.126199
[0m01:58:49.137902 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m01:58:49.138789 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.silver_starlink"
[0m01:58:49.140109 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.silver_launches"
[0m01:58:49.141475 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m01:58:49.141727 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: BEGIN
[0m01:58:49.141924 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m01:58:49.142083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:58:49.142346 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: BEGIN
[0m01:58:49.142792 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:58:49.144118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:49.144523 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m01:58:49.145337 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

  create view "spacex_db"."silver"."silver_launches__dbt_tmp"
    
    
  as (
    

WITH parsed_launches AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as launch_id,
        data->>'name' as mission_name,
        
        -- Date and time parsing
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp 
            ELSE NULL 
        END as launch_date_utc,
        
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp::date 
            ELSE NULL 
        END as launch_date,
        
        -- Launch outcome
        CASE 
            WHEN (data->'success')::text = 'true' THEN true
            WHEN (data->'success')::text = 'false' THEN false
            ELSE NULL
        END as launch_success,
        
        CASE 
            WHEN (data->'upcoming')::text = 'true' THEN true
            WHEN (data->'upcoming')::text = 'false' THEN false
            ELSE NULL
        END as is_upcoming,
        
        -- Technical details
        data->>'rocket' as rocket_id,
        
        CASE 
            WHEN data->>'flight_number' IS NOT NULL 
            THEN (data->>'flight_number')::integer 
            ELSE NULL 
        END as flight_number,
        
        data->>'launchpad' as launchpad_id,
        data->>'details' as mission_details,
        
        -- Business logic: Starlink mission identification
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN true
            WHEN LOWER(data->>'name') LIKE '%starship%' AND LOWER(data->>'name') LIKE '%starlink%' THEN true
            ELSE false
        END as is_starlink_mission,
        
        -- Satellite count estimation for Starlink missions
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN
                CASE 
                    -- Early test missions
                    WHEN LOWER(data->>'name') LIKE '%demo%' 
                      OR LOWER(data->>'name') LIKE '%test%' 
                      OR data->>'name' ILIKE '%tintin%' THEN 2
                    -- V1.0 missions (60 satellites each)
                    WHEN data->>'name' ILIKE '%v1.0%' THEN 60
                    -- V2 missions (larger satellites, fewer per launch)
                    WHEN data->>'name' ILIKE '%v2%' THEN 23
                    -- Standard production batches
                    ELSE 60
                END
            ELSE 0
        END as estimated_satellite_count,
        
        -- Payload analysis
        CASE 
            WHEN data->'payloads' IS NOT NULL 
            THEN jsonb_array_length(data->'payloads') 
            ELSE 0 
        END as payload_count,
        
        -- Data quality assessment
        CASE 
            WHEN data->>'date_utc' IS NULL THEN 'missing_launch_date'
            WHEN data->>'name' IS NULL THEN 'missing_mission_name'
            WHEN (data->'success') IS NULL AND (data->'upcoming')::text = 'false' THEN 'missing_success_status'
            WHEN data->>'rocket' IS NULL THEN 'missing_rocket_info'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."launches"
    WHERE data IS NOT NULL
)

SELECT 
    launch_id,
    mission_name,
    launch_date_utc,
    launch_date,
    launch_success,
    is_upcoming,
    rocket_id,
    flight_number,
    launchpad_id,
    mission_details,
    is_starlink_mission,
    estimated_satellite_count,
    payload_count,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    EXTRACT(YEAR FROM launch_date_utc) as launch_year,
    EXTRACT(MONTH FROM launch_date_utc) as launch_month,
    EXTRACT(DOW FROM launch_date_utc) as launch_day_of_week,
    
    -- Mission type classification
    CASE 
        WHEN is_starlink_mission THEN 'Starlink'
        WHEN LOWER(mission_name) LIKE '%crew%' THEN 'Crew'
        WHEN LOWER(mission_name) LIKE '%cargo%' OR LOWER(mission_name) LIKE '%crs%' THEN 'Cargo'
        WHEN LOWER(mission_name) LIKE '%satellite%' THEN 'Commercial Satellite'
        ELSE 'Other'
    END as mission_type

FROM parsed_launches
WHERE launch_id IS NOT NULL

-- Add model documentation

  );
[0m01:58:49.145118 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:49.145755 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m01:58:49.146036 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

  create view "spacex_db"."silver"."silver_starlink__dbt_tmp"
    
    
  as (
    

WITH parsed_starlink AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as satellite_id,
        data->'spaceTrack'->>'OBJECT_NAME' as satellite_name,
        data->>'launch' as launch_id,
        
        -- Launch and creation dates
        CASE 
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'LAUNCH_DATE')::date 
            ELSE NULL 
        END as launch_date,
        
        CASE 
            WHEN data->'spaceTrack'->>'CREATION_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'CREATION_DATE')::timestamp 
            ELSE NULL 
        END as tracking_creation_date,
        
        -- Satellite status determination (multiple fallback methods)
        CASE 
            -- Primary: DECAYED field
            WHEN data->'spaceTrack'->>'DECAYED' = '0' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'false' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'False' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = '1' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'true' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'True' THEN false
            -- Fallback: DECAY_DATE field
            WHEN data->'spaceTrack'->>'DECAY_DATE' IS NULL OR data->'spaceTrack'->>'DECAY_DATE' = '' THEN true
            ELSE false
        END as is_active,
        
        -- Orbital parameters (parsed to numeric types)
        CASE 
            WHEN data->'spaceTrack'->>'INCLINATION' IS NOT NULL 
            THEN (data->'spaceTrack'->>'INCLINATION')::numeric 
            ELSE NULL 
        END as inclination_deg,
        
        CASE 
            WHEN data->'spaceTrack'->>'SEMIMAJOR_AXIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'SEMIMAJOR_AXIS')::numeric 
            ELSE NULL 
        END as semimajor_axis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIOD' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIOD')::numeric 
            ELSE NULL 
        END as orbital_period_min,
        
        CASE 
            WHEN data->'spaceTrack'->>'APOAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'APOAPSIS')::numeric 
            ELSE NULL 
        END as apoapsis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIAPSIS')::numeric 
            ELSE NULL 
        END as periapsis_km,
        
        -- Current position data (if available)
        CASE 
            WHEN data->>'longitude' IS NOT NULL 
            THEN (data->>'longitude')::numeric 
            ELSE NULL 
        END as longitude,
        
        CASE 
            WHEN data->>'latitude' IS NOT NULL 
            THEN (data->>'latitude')::numeric 
            ELSE NULL 
        END as latitude,
        
        CASE 
            WHEN data->>'height_km' IS NOT NULL 
            THEN (data->>'height_km')::numeric 
            ELSE NULL 
        END as altitude_km,
        
        CASE 
            WHEN data->>'velocity_kms' IS NOT NULL 
            THEN (data->>'velocity_kms')::numeric 
            ELSE NULL 
        END as velocity_kms,
        
        -- Tracking information
        data->'spaceTrack'->>'NORAD_CAT_ID' as norad_catalog_id,
        data->'spaceTrack'->>'OBJECT_ID' as object_id,
        data->'spaceTrack'->>'DECAY_DATE' as decay_date_raw,
        
        -- Data quality assessment
        CASE 
            WHEN data->'spaceTrack'->>'OBJECT_NAME' IS NULL THEN 'missing_satellite_name'
            WHEN data->>'launch' IS NULL THEN 'missing_launch_reference'
            WHEN data->'spaceTrack'->>'DECAYED' IS NULL AND data->'spaceTrack'->>'DECAY_DATE' IS NULL THEN 'missing_status_info'
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NULL THEN 'missing_launch_date'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."starlink"
    WHERE data IS NOT NULL
)

SELECT 
    satellite_id,
    satellite_name,
    launch_id,
    launch_date,
    tracking_creation_date,
    is_active,
    inclination_deg,
    semimajor_axis_km,
    orbital_period_min,
    apoapsis_km,
    periapsis_km,
    longitude,
    latitude,
    altitude_km,
    velocity_kms,
    norad_catalog_id,
    object_id,
    decay_date_raw,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    CASE 
        WHEN semimajor_axis_km IS NOT NULL 
        THEN semimajor_axis_km - 6371.0  -- Convert to altitude above Earth's surface
        ELSE NULL 
    END as calculated_altitude_km,
    
    -- Orbital regime classification
    CASE 
        WHEN semimajor_axis_km - 6371.0 BETWEEN 160 AND 2000 THEN 'Low Earth Orbit (LEO)'
        WHEN semimajor_axis_km - 6371.0 BETWEEN 2000 AND 35786 THEN 'Medium Earth Orbit (MEO)'
        WHEN semimajor_axis_km - 6371.0 > 35786 THEN 'Geostationary Orbit (GEO)'
        ELSE 'Unknown'
    END as orbital_regime,
    
    -- Age calculation
    CASE 
        WHEN launch_date IS NOT NULL 
        THEN CURRENT_DATE - launch_date 
        ELSE NULL 
    END as satellite_age_days

FROM parsed_starlink
WHERE satellite_id IS NOT NULL

-- Add model documentation

  );
[0m01:58:49.149176 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:58:49.149312 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m01:58:49.153304 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m01:58:49.152291 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m01:58:49.153802 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
alter table "spacex_db"."silver"."silver_launches" rename to "silver_launches__dbt_backup"
[0m01:58:49.153562 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
alter table "spacex_db"."silver"."silver_starlink" rename to "silver_starlink__dbt_backup"
[0m01:58:49.154298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:58:49.155319 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m01:58:49.155486 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:58:49.155657 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
alter table "spacex_db"."silver"."silver_launches__dbt_tmp" rename to "silver_launches"
[0m01:58:49.156744 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m01:58:49.157143 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
alter table "spacex_db"."silver"."silver_starlink__dbt_tmp" rename to "silver_starlink"
[0m01:58:49.157268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:58:49.163158 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:58:49.164672 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m01:58:49.163680 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m01:58:49.165152 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

        COMMENT ON VIEW "spacex_db"."silver"."silver_launches" IS 'Cleaned launch data with Starlink mission identification and satellite count estimation'
      
[0m01:58:49.164922 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

        COMMENT ON VIEW "spacex_db"."silver"."silver_starlink" IS 'Cleaned Starlink satellite data with active status determination and orbital parameters'
      
[0m01:58:49.165569 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m01:58:49.166042 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m01:58:49.165683 [debug] [Thread-2 (]: SQL status: COMMENT in 0.0 seconds
[0m01:58:49.166650 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m01:58:49.166270 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m01:58:49.167097 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m01:58:49.166879 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m01:58:49.167425 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m01:58:49.168005 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:58:49.168147 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:58:49.171045 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m01:58:49.172064 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m01:58:49.172312 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
drop view if exists "spacex_db"."silver"."silver_launches__dbt_backup" cascade
[0m01:58:49.172570 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
drop view if exists "spacex_db"."silver"."silver_starlink__dbt_backup" cascade
[0m01:58:49.173895 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:58:49.174581 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 01:58:49.138931 => 01:58:49.174518
[0m01:58:49.174716 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m01:58:49.174858 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: Close
[0m01:58:49.175507 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 01:58:49.126591 => 01:58:49.175452
[0m01:58:49.176107 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: Close
[0m01:58:49.175951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b273c18b-1218-4dc4-8b21-f7b4d71ce98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2569e20>]}
[0m01:58:49.176700 [info ] [Thread-1 (]: 1 of 2 OK created sql view model silver.silver_launches ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m01:58:49.176457 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b273c18b-1218-4dc4-8b21-f7b4d71ce98e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b28080>]}
[0m01:58:49.177456 [info ] [Thread-2 (]: 2 of 2 OK created sql view model silver.silver_starlink ........................ [[32mCREATE VIEW[0m in 0.06s]
[0m01:58:49.177190 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m01:58:49.177787 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m01:58:49.182085 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:49.182315 [debug] [MainThread]: On master: BEGIN
[0m01:58:49.182535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:58:49.184055 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:49.184277 [debug] [MainThread]: On master: COMMIT
[0m01:58:49.184457 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:49.184631 [debug] [MainThread]: On master: COMMIT
[0m01:58:49.184841 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:58:49.185043 [debug] [MainThread]: On master: Close
[0m01:58:49.185362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:58:49.185964 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_starlink' was properly closed.
[0m01:58:49.186152 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_launches' was properly closed.
[0m01:58:49.186359 [info ] [MainThread]: 
[0m01:58:49.186670 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m01:58:49.187040 [debug] [MainThread]: Command end result
[0m01:58:49.195011 [info ] [MainThread]: 
[0m01:58:49.195348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:58:49.195545 [info ] [MainThread]: 
[0m01:58:49.195752 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:58:49.196018 [debug] [MainThread]: Command `dbt run` succeeded at 01:58:49.195980 after 0.21 seconds
[0m01:58:49.196267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a60b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb464e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ac6ba0>]}
[0m01:58:49.196525 [debug] [MainThread]: Flushing usage events
[0m01:58:52.004928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9fb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fcc3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9fa630>]}


============================== 01:58:52.006512 | 508854e6-721e-4db5-815a-7ef9b21b9d7e ==============================
[0m01:58:52.006512 [info ] [MainThread]: Running with dbt=1.6.0
[0m01:58:52.006852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:58:52.044320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '508854e6-721e-4db5-815a-7ef9b21b9d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea398b0>]}
[0m01:58:52.049910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '508854e6-721e-4db5-815a-7ef9b21b9d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df7f2f0>]}
[0m01:58:52.050292 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m01:58:52.053952 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m01:58:52.069039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:58:52.069295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:58:52.071526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '508854e6-721e-4db5-815a-7ef9b21b9d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee30ce0>]}
[0m01:58:52.076903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '508854e6-721e-4db5-815a-7ef9b21b9d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dfff5f0>]}
[0m01:58:52.077181 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m01:58:52.077434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '508854e6-721e-4db5-815a-7ef9b21b9d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef2d100>]}
[0m01:58:52.078110 [info ] [MainThread]: 
[0m01:58:52.078482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:58:52.079054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m01:58:52.082910 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m01:58:52.083197 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m01:58:52.083495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:52.085636 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m01:58:52.086245 [debug] [ThreadPool]: On list_spacex_db: Close
[0m01:58:52.086928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold)
[0m01:58:52.087194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m01:58:52.089224 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m01:58:52.090050 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m01:58:52.090359 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m01:58:52.090618 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m01:58:52.090891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:58:52.091134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:52.092440 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:58:52.092703 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m01:58:52.092991 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m01:58:52.093115 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:58:52.093958 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m01:58:52.094302 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m01:58:52.094207 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:52.095260 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:52.095733 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m01:58:52.096269 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m01:58:52.096628 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m01:58:52.096806 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m01:58:52.099794 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:52.100095 [debug] [MainThread]: On master: BEGIN
[0m01:58:52.100332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:58:52.101736 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:52.101994 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:52.102259 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:58:52.106653 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:52.107246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '508854e6-721e-4db5-815a-7ef9b21b9d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9faea0>]}
[0m01:58:52.107538 [debug] [MainThread]: On master: ROLLBACK
[0m01:58:52.107831 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:52.108088 [debug] [MainThread]: On master: BEGIN
[0m01:58:52.108447 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:52.108707 [debug] [MainThread]: On master: COMMIT
[0m01:58:52.108954 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:52.109179 [debug] [MainThread]: On master: COMMIT
[0m01:58:52.109495 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:58:52.109740 [debug] [MainThread]: On master: Close
[0m01:58:52.110138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:58:52.110717 [info ] [MainThread]: 
[0m01:58:52.112023 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m01:58:52.112219 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m01:58:52.112433 [info ] [Thread-1 (]: 1 of 2 START sql table model gold.starlink_42k_projection ...................... [RUN]
[0m01:58:52.112756 [info ] [Thread-2 (]: 2 of 2 START sql table model gold.starlink_constellation_status ................ [RUN]
[0m01:58:52.113135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.starlink_42k_projection)
[0m01:58:52.113506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.starlink_constellation_status)
[0m01:58:52.113782 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m01:58:52.114073 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m01:58:52.117139 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m01:58:52.118369 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m01:58:52.120123 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 01:58:52.114304 => 01:58:52.120041
[0m01:58:52.120402 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m01:58:52.120589 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 01:58:52.117466 => 01:58:52.120507
[0m01:58:52.133588 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m01:58:52.134947 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m01:58:52.136250 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m01:58:52.137920 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m01:58:52.138191 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m01:58:52.138339 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m01:58:52.138492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:58:52.138763 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m01:58:52.139358 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:58:52.140541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:52.140778 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m01:58:52.140933 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:52.141143 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT 
        COUNT(CASE WHEN is_active THEN 1 END) as current_satellites
    FROM "spacex_db"."silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_stats AS (
    SELECT 
        MIN(launch_date) as first_launch_date,
        MAX(launch_date) as latest_launch_date,
        
        COUNT(*) as total_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_launches,
        (AVG(CASE WHEN launch_success THEN estimated_satellite_count END))::numeric as avg_sats_per_launch,
        
        -- Count launches in 2022 (most recent complete year)
        COUNT(CASE WHEN EXTRACT(YEAR FROM launch_date) = 2022 AND launch_success THEN 1 END) as launches_2022,
        
        -- Calculate monthly rate - cast everything to numeric
        CASE 
            WHEN MAX(launch_date) > MIN(launch_date) THEN
                (COUNT(CASE WHEN launch_success THEN 1 END)::numeric) / 
                ((DATE_PART('year', MAX(launch_date)) - DATE_PART('year', MIN(launch_date)))::numeric * 12.0)
            ELSE 0::numeric
        END as avg_monthly_launch_rate
        
    FROM "spacex_db"."silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date IS NOT NULL
)

SELECT 
    CURRENT_TIMESTAMP as analysis_date,
    
    -- Current status
    42000 as target_satellites,
    cs.current_satellites,
    (42000 - cs.current_satellites) as satellites_needed,
    ROUND((cs.current_satellites * 100.0 / 42000)::numeric, 1) as progress_percent,
    
    -- Historical performance
    ls.total_launches,
    ls.successful_launches,
    ROUND(ls.avg_sats_per_launch::numeric, 0) as avg_satellites_per_launch,
    ROUND(ls.avg_monthly_launch_rate::numeric, 2) as avg_monthly_launch_rate,
    ls.launches_2022,
    
    -- Business projections
    CASE 
        WHEN ls.avg_sats_per_launch > 0 THEN
            CEILING((42000 - cs.current_satellites)::numeric / ls.avg_sats_per_launch)
        ELSE NULL
    END as launches_needed,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            ROUND((CEILING((42000 - cs.current_satellites)::numeric / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1)
        ELSE NULL
    END as months_to_completion,
    
    CASE 
        WHEN ls.avg_monthly_launch_rate > 0 AND ls.avg_sats_per_launch > 0 THEN
            (CURRENT_DATE + (ROUND((CEILING((42000 - cs.current_satellites)::numeric / ls.avg_sats_per_launch) / ls.avg_monthly_launch_rate)::numeric, 1) || ' months')::INTERVAL)::date
        ELSE NULL
    END as estimated_completion_date,
    
    -- Confidence assessment
    CASE 
        WHEN ls.launches_2022 >= 5 THEN 'Medium Confidence'
        WHEN ls.total_launches >= 20 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as projection_confidence,
    
    -- Data context
    ls.first_launch_date,
    ls.latest_launch_date,
    ('Projection based on ' || ls.successful_launches || ' successful launches from ' || 
    EXTRACT(YEAR FROM ls.first_launch_date) || ' to ' || EXTRACT(YEAR FROM ls.latest_launch_date)) as data_summary

FROM current_status cs
CROSS JOIN launch_stats ls
  );
  
[0m01:58:52.141438 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m01:58:52.141782 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    CURRENT_TIMESTAMP as status_date,
    
    -- Current constellation
    COUNT(*) as total_satellites,
    COUNT(CASE WHEN is_active THEN 1 END) as active_satellites,
    COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
    
    -- Performance
    ROUND((COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*))::numeric, 1) as active_percentage,
    
    -- Timeline
    MIN(launch_date) as first_launch_date,
    MAX(launch_date) as latest_launch_date,
    
    -- Data quality
    MAX(extracted_at) as last_updated,
    ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 1) as data_age_hours

FROM "spacex_db"."silver"."silver_starlink"
WHERE satellite_id IS NOT NULL
  );
  
[0m01:58:52.146429 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:58:52.148989 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m01:58:52.149146 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:58:52.149313 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m01:58:52.150396 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m01:58:52.150773 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection" rename to "starlink_42k_projection__dbt_backup"
[0m01:58:52.150911 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:58:52.151165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:58:52.152045 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m01:58:52.153079 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m01:58:52.153360 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m01:58:52.153596 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold"."starlink_42k_projection__dbt_tmp" rename to "starlink_42k_projection"
[0m01:58:52.153900 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:58:52.154114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m01:58:52.161121 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m01:58:52.161847 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m01:58:52.162212 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m01:58:52.162506 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m01:58:52.162802 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m01:58:52.163066 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m01:58:52.163696 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m01:58:52.166597 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m01:58:52.166744 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m01:58:52.166922 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold"."starlink_constellation_status__dbt_backup" cascade
[0m01:58:52.167827 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m01:58:52.168213 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
drop table if exists "spacex_db"."gold"."starlink_42k_projection__dbt_backup" cascade
[0m01:58:52.168727 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:58:52.169078 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m01:58:52.169638 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 01:58:52.135084 => 01:58:52.169577
[0m01:58:52.170231 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 01:58:52.120697 => 01:58:52.170178
[0m01:58:52.170490 [debug] [Thread-2 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m01:58:52.170701 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m01:58:52.171363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '508854e6-721e-4db5-815a-7ef9b21b9d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7defa360>]}
[0m01:58:52.171106 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '508854e6-721e-4db5-815a-7ef9b21b9d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df82390>]}
[0m01:58:52.172878 [info ] [Thread-2 (]: 2 of 2 OK created sql table model gold.starlink_constellation_status ........... [[32mSELECT 1[0m in 0.06s]
[0m01:58:52.172528 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold.starlink_42k_projection ................. [[32mSELECT 1[0m in 0.06s]
[0m01:58:52.173237 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m01:58:52.173534 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m01:58:52.175447 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:52.175697 [debug] [MainThread]: On master: BEGIN
[0m01:58:52.175907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:58:52.177265 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:52.177495 [debug] [MainThread]: On master: COMMIT
[0m01:58:52.177680 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:52.177847 [debug] [MainThread]: On master: COMMIT
[0m01:58:52.178086 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:58:52.178277 [debug] [MainThread]: On master: Close
[0m01:58:52.178592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:58:52.178773 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m01:58:52.178938 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m01:58:52.179165 [info ] [MainThread]: 
[0m01:58:52.179442 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m01:58:52.179804 [debug] [MainThread]: Command end result
[0m01:58:52.184669 [info ] [MainThread]: 
[0m01:58:52.184955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:58:52.185155 [info ] [MainThread]: 
[0m01:58:52.185355 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:58:52.185615 [debug] [MainThread]: Command `dbt run` succeeded at 01:58:52.185581 after 0.18 seconds
[0m01:58:52.185837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb10170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb8d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef2d100>]}
[0m01:58:52.186085 [debug] [MainThread]: Flushing usage events
[0m01:58:54.559471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803cb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a17c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803c9c10>]}


============================== 01:58:54.561320 | 084cabf5-85c3-47b7-8aaa-df106868f192 ==============================
[0m01:58:54.561320 [info ] [MainThread]: Running with dbt=1.6.0
[0m01:58:54.561640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m01:58:54.571668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d49fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950fef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95252240>]}


============================== 01:58:54.573523 | 0d121b89-5449-4d41-a0d3-bf14b245cdc2 ==============================
[0m01:58:54.573523 [info ] [MainThread]: Running with dbt=1.6.0
[0m01:58:54.574100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m01:58:54.604171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '084cabf5-85c3-47b7-8aaa-df106868f192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803c8cb0>]}
[0m01:58:54.610379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '084cabf5-85c3-47b7-8aaa-df106868f192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f927c80>]}
[0m01:58:54.610754 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m01:58:54.614770 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m01:58:54.615496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d121b89-5449-4d41-a0d3-bf14b245cdc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942abf80>]}
[0m01:58:54.621486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d121b89-5449-4d41-a0d3-bf14b245cdc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ecbe90>]}
[0m01:58:54.621920 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m01:58:54.626892 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m01:58:54.631897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:58:54.632210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:58:54.635415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '084cabf5-85c3-47b7-8aaa-df106868f192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f927740>]}
[0m01:58:54.642669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '084cabf5-85c3-47b7-8aaa-df106868f192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f996720>]}
[0m01:58:54.642942 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m01:58:54.643155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '084cabf5-85c3-47b7-8aaa-df106868f192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f996420>]}
[0m01:58:54.644023 [info ] [MainThread]: 
[0m01:58:54.644400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:58:54.645017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m01:58:54.646261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:58:54.646955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:58:54.649373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d121b89-5449-4d41-a0d3-bf14b245cdc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94edda60>]}
[0m01:58:54.645385 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m01:58:54.649901 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m01:58:54.650727 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m01:58:54.650974 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m01:58:54.651555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:54.651309 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m01:58:54.652090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:54.652562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d121b89-5449-4d41-a0d3-bf14b245cdc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9430eed0>]}
[0m01:58:54.653014 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m01:58:54.653409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d121b89-5449-4d41-a0d3-bf14b245cdc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9430eb70>]}
[0m01:58:54.654338 [info ] [MainThread]: 
[0m01:58:54.654831 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:58:54.655378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold'
[0m01:58:54.655672 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.657976 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m01:58:54.656287 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.658393 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m01:58:54.658195 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m01:58:54.658586 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m01:58:54.659954 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m01:58:54.660345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_silver'
[0m01:58:54.660737 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:54.662556 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m01:58:54.660529 [debug] [ThreadPool]: On list_spacex_db_gold: BEGIN
[0m01:58:54.661892 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:54.662973 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m01:58:54.663186 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m01:58:54.663260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:54.663857 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m01:58:54.664099 [debug] [ThreadPool]: On list_spacex_db_silver: BEGIN
[0m01:58:54.665274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:54.666462 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m01:58:54.666829 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.667839 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.668925 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold"
[0m01:58:54.669194 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_silver"
[0m01:58:54.669830 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:54.670112 [debug] [MainThread]: On master: BEGIN
[0m01:58:54.669487 [debug] [ThreadPool]: On list_spacex_db_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m01:58:54.669773 [debug] [ThreadPool]: On list_spacex_db_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m01:58:54.670367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:58:54.671539 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:54.671964 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:54.672504 [debug] [ThreadPool]: On list_spacex_db_gold: ROLLBACK
[0m01:58:54.673083 [debug] [ThreadPool]: On list_spacex_db_silver: ROLLBACK
[0m01:58:54.673456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.673966 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:54.673643 [debug] [ThreadPool]: On list_spacex_db_gold: Close
[0m01:58:54.673848 [debug] [ThreadPool]: On list_spacex_db_silver: Close
[0m01:58:54.674243 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:58:54.677389 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:54.677648 [debug] [MainThread]: On master: BEGIN
[0m01:58:54.677878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:58:54.679502 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.679714 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:54.679741 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:54.679998 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:58:54.680465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '084cabf5-85c3-47b7-8aaa-df106868f192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9e8230>]}
[0m01:58:54.680975 [debug] [MainThread]: On master: ROLLBACK
[0m01:58:54.681228 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:54.681441 [debug] [MainThread]: On master: BEGIN
[0m01:58:54.681782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.682044 [debug] [MainThread]: On master: COMMIT
[0m01:58:54.682262 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:54.682468 [debug] [MainThread]: On master: COMMIT
[0m01:58:54.682698 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:58:54.682930 [debug] [MainThread]: On master: Close
[0m01:58:54.683346 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:58:54.684273 [info ] [MainThread]: 
[0m01:58:54.685009 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m01:58:54.685615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d121b89-5449-4d41-a0d3-bf14b245cdc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94237da0>]}
[0m01:58:54.685893 [debug] [MainThread]: On master: ROLLBACK
[0m01:58:54.686136 [debug] [MainThread]: On master: Close
[0m01:58:54.685886 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m01:58:54.686036 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m01:58:54.686154 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m01:58:54.687111 [info ] [Thread-3 (]: 3 of 8 START test source_not_null_bronze_rockets_id ............................ [RUN]
[0m01:58:54.686880 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:58:54.687504 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1'
[0m01:58:54.687684 [info ] [MainThread]: 
[0m01:58:54.686264 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m01:58:54.686845 [info ] [Thread-2 (]: 2 of 8 START test source_not_null_bronze_launches_id ........................... [RUN]
[0m01:58:54.686519 [info ] [Thread-1 (]: 1 of 8 START test source_not_null_bronze_launches_data ......................... [RUN]
[0m01:58:54.689013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae)
[0m01:58:54.689234 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m01:58:54.689260 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m01:58:54.689910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now model.spacex_analytics.silver_launches)
[0m01:58:54.689401 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m01:58:54.690460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold, now model.spacex_analytics.silver_starlink)
[0m01:58:54.689589 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m01:58:54.691050 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae'
[0m01:58:54.689691 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m01:58:54.691652 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb'
[0m01:58:54.690133 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m01:58:54.691295 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m01:58:54.688632 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_silver, now test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb)
[0m01:58:54.687863 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m01:58:54.688192 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_bronze_starlink_data ......................... [RUN]
[0m01:58:54.699341 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed'
[0m01:58:54.699591 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m01:58:54.690688 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m01:58:54.701090 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m01:58:54.701125 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m01:58:54.695637 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m01:58:54.695091 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m01:58:54.696993 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m01:58:54.699665 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m01:58:54.698938 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m01:58:54.691921 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m01:58:54.703888 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m01:58:54.704605 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 01:58:54.699931 => 01:58:54.704425
[0m01:58:54.704958 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 01:58:54.689577 => 01:58:54.704738
[0m01:58:54.706414 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m01:58:54.706723 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 01:58:54.692109 => 01:58:54.706627
[0m01:58:54.706577 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 01:58:54.699800 => 01:58:54.706510
[0m01:58:54.707120 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m01:58:54.707518 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 01:58:54.695310 => 01:58:54.707424
[0m01:58:54.707525 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m01:58:54.708697 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m01:58:54.708917 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 01:58:54.708849 => 01:58:54.708853
[0m01:58:54.709317 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m01:58:54.707920 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m01:58:54.708235 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 01:58:54.708151 => 01:58:54.708160
[0m01:58:54.708568 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 01:58:54.704849 => 01:58:54.708473
[0m01:58:54.710560 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m01:58:54.710786 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 01:58:54.710724 => 01:58:54.710727
[0m01:58:54.711147 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m01:58:54.709547 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m01:58:54.711776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1)
[0m01:58:54.710341 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m01:58:54.712260 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m01:58:54.709881 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 01:58:54.709807 => 01:58:54.709810
[0m01:58:54.713133 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m01:58:54.711359 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m01:58:54.713821 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed)
[0m01:58:54.707800 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 01:58:54.697216 => 01:58:54.707702
[0m01:58:54.708085 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m01:58:54.711999 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m01:58:54.715049 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m01:58:54.716055 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m01:58:54.713783 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 01:58:54.702559 => 01:58:54.713713
[0m01:58:54.712638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_starlink, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m01:58:54.714168 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m01:58:54.714275 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m01:58:54.713391 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m01:58:54.713593 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m01:58:54.716909 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m01:58:54.716729 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m01:58:54.720941 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m01:58:54.719495 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m01:58:54.719270 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m01:58:54.721313 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m01:58:54.719488 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 01:58:54.714515 => 01:58:54.719415
[0m01:58:54.722074 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: BEGIN
[0m01:58:54.722199 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m01:58:54.721666 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m01:58:54.722652 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 01:58:54.722595 => 01:58:54.722598
[0m01:58:54.722837 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: BEGIN
[0m01:58:54.719726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_launches, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m01:58:54.722450 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m01:58:54.723332 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m01:58:54.722582 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:58:54.721453 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m01:58:54.722999 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m01:58:54.723104 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m01:58:54.722494 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 01:58:54.717495 => 01:58:54.722422
[0m01:58:54.726054 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: BEGIN
[0m01:58:54.726626 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m01:58:54.727031 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 01:58:54.726974 => 01:58:54.726977
[0m01:58:54.723492 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: BEGIN
[0m01:58:54.725560 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m01:58:54.726850 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 01:58:54.720011 => 01:58:54.726770
[0m01:58:54.723252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:58:54.726228 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m01:58:54.726811 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:58:54.727476 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m01:58:54.729229 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m01:58:54.727800 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.729685 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m01:58:54.729950 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m01:58:54.727668 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:58:54.731333 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.731541 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m01:58:54.729883 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m01:58:54.729022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.727830 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m01:58:54.732644 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 01:58:54.732562 => 01:58:54.732567
[0m01:58:54.731759 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."rockets"
where id is null



      
    ) dbt_internal_test
[0m01:58:54.731977 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."starlink"
where data is null



      
    ) dbt_internal_test
[0m01:58:54.732222 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m01:58:54.733135 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."launches"
where data is null



      
    ) dbt_internal_test
[0m01:58:54.729090 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 01:58:54.723539 => 01:58:54.729020
[0m01:58:54.733709 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:58:54.734757 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 01:58:54.717341 => 01:58:54.734679
[0m01:58:54.731910 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m01:58:54.728535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m01:58:54.735321 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m01:58:54.735528 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: ROLLBACK
[0m01:58:54.735117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.733616 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m01:58:54.737252 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 01:58:54.737175 => 01:58:54.737179
[0m01:58:54.734971 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:58:54.736968 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m01:58:54.733382 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m01:58:54.738271 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 01:58:54.714379 => 01:58:54.738199
[0m01:58:54.737839 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 01:58:54.730171 => 01:58:54.737770
[0m01:58:54.738558 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: ROLLBACK
[0m01:58:54.737019 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: Close
[0m01:58:54.737675 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m01:58:54.735651 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:58:54.739494 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 01:58:54.708580 => 01:58:54.739424
[0m01:58:54.739965 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m01:58:54.737161 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m01:58:54.738816 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: Close
[0m01:58:54.739765 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: ROLLBACK
[0m01:58:54.740641 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."launches"
where id is null



      
    ) dbt_internal_test
[0m01:58:54.740466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8, now model.spacex_analytics.starlink_42k_projection)
[0m01:58:54.739588 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 01:58:54.735549 => 01:58:54.738913
[0m01:58:54.740348 [info ] [Thread-3 (]: 3 of 8 PASS source_not_null_bronze_rockets_id .................................. [[32mPASS[0m in 0.05s]
[0m01:58:54.738164 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m01:58:54.742421 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: Close
[0m01:58:54.738707 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m01:58:54.742204 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_bronze_starlink_data ............................... [[32mPASS[0m in 0.04s]
[0m01:58:54.742041 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m01:58:54.744186 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m01:58:54.745181 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m01:58:54.743614 [info ] [Thread-1 (]: 1 of 8 PASS source_not_null_bronze_launches_data ............................... [[32mPASS[0m in 0.05s]
[0m01:58:54.742736 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m01:58:54.742270 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m01:58:54.743214 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:58:54.746393 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 01:58:54.746320 => 01:58:54.746323
[0m01:58:54.747178 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 01:58:54.720247 => 01:58:54.747101
[0m01:58:54.743955 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 01:58:54.743840 => 01:58:54.743845
[0m01:58:54.747423 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: ROLLBACK
[0m01:58:54.745851 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m01:58:54.746318 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m01:58:54.742843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e, now model.spacex_analytics.starlink_constellation_status)
[0m01:58:54.745462 [info ] [Thread-4 (]: 5 of 8 START test source_not_null_bronze_starlink_id ........................... [RUN]
[0m01:58:54.745861 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m01:58:54.747207 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m01:58:54.747664 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m01:58:54.748980 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m01:58:54.748469 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m01:58:54.749688 [info ] [Thread-1 (]: 7 of 8 START test source_unique_bronze_rockets_id .............................. [RUN]
[0m01:58:54.748670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m01:58:54.747921 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: Close
[0m01:58:54.748199 [info ] [Thread-3 (]: 6 of 8 START test source_unique_bronze_launches_id ............................. [RUN]
[0m01:58:54.750983 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m01:58:54.751209 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m01:58:54.749604 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 01:58:54.744348 => 01:58:54.749523
[0m01:58:54.751949 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m01:58:54.752287 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m01:58:54.753280 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 01:58:54.749933 => 01:58:54.753210
[0m01:58:54.754001 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 01:58:54.753925 => 01:58:54.753930
[0m01:58:54.754223 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m01:58:54.750779 [info ] [Thread-2 (]: 2 of 8 PASS source_not_null_bronze_launches_id ................................. [[32mPASS[0m in 0.06s]
[0m01:58:54.755011 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m01:58:54.755254 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 01:58:54.755185 => 01:58:54.755188
[0m01:58:54.750075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m01:58:54.755858 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m01:58:54.750360 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m01:58:54.754683 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m01:58:54.758204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:58:54.755684 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m01:58:54.759127 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m01:58:54.759325 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m01:58:54.759337 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m01:58:54.759910 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m01:58:54.757978 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m01:58:54.760220 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m01:58:54.761026 [debug] [MainThread]: Command end result
[0m01:58:54.756034 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m01:58:54.759641 [info ] [Thread-2 (]: 8 of 8 START test source_unique_bronze_starlink_id ............................. [RUN]
[0m01:58:54.760382 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 01:58:54.751394 => 01:58:54.760151
[0m01:58:54.762793 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m01:58:54.763212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m01:58:54.763629 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m01:58:54.763809 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 01:58:54.756272 => 01:58:54.763736
[0m01:58:54.764259 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m01:58:54.765725 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m01:58:54.766087 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m01:58:54.766404 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 01:58:54.761469 => 01:58:54.766215
[0m01:58:54.767850 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m01:58:54.769058 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m01:58:54.769442 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m01:58:54.769814 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m01:58:54.770787 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m01:58:54.771244 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: BEGIN
[0m01:58:54.771569 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 01:58:54.766503 => 01:58:54.771491
[0m01:58:54.772553 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:58:54.772752 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m01:58:54.774102 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: BEGIN
[0m01:58:54.773207 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m01:58:54.772921 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m01:58:54.778787 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m01:58:54.774779 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:58:54.775116 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: BEGIN
[0m01:58:54.779580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:58:54.779270 [info ] [MainThread]: Building catalog
[0m01:58:54.778189 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m01:58:54.779077 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.781100 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m01:58:54.781385 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."launches"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:58:54.781950 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m01:58:54.782354 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: BEGIN
[0m01:58:54.782529 [debug] [ThreadPool]: Acquiring new postgres connection 'spacex_db.information_schema'
[0m01:58:54.782192 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.783977 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m01:58:54.782614 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:58:54.783103 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:58:54.782477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.786943 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m01:58:54.787177 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."rockets"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:58:54.784672 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."starlink"
where id is null



      
    ) dbt_internal_test
[0m01:58:54.786503 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 01:58:54.765014 => 01:58:54.786417
[0m01:58:54.787715 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: ROLLBACK
[0m01:58:54.787227 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m01:58:54.788454 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:58:54.789330 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 01:58:54.770170 => 01:58:54.789266
[0m01:58:54.788840 [debug] [ThreadPool]: On spacex_db.information_schema: BEGIN
[0m01:58:54.790261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:54.789691 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.789907 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: Close
[0m01:58:54.790015 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:58:54.792414 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.792662 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m01:58:54.792894 [debug] [ThreadPool]: On spacex_db.information_schema: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "spacex_db.information_schema"} */

    
    

    select
        'spacex_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('bronze') or upper(sch.nspname) = upper('gold') or upper(sch.nspname) = upper('silver'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m01:58:54.793586 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 01:58:54.768322 => 01:58:54.793507
[0m01:58:54.794057 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: ROLLBACK
[0m01:58:54.792268 [info ] [Thread-3 (]: 6 of 8 PASS source_unique_bronze_launches_id ................................... [[32mPASS[0m in 0.04s]
[0m01:58:54.790167 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: ROLLBACK
[0m01:58:54.790928 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m01:58:54.795045 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."starlink"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:58:54.794587 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m01:58:54.795325 [debug] [ThreadPool]: SQL status: SELECT 92 in 0.0 seconds
[0m01:58:54.794346 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: Close
[0m01:58:54.798394 [debug] [ThreadPool]: On spacex_db.information_schema: ROLLBACK
[0m01:58:54.798653 [debug] [ThreadPool]: On spacex_db.information_schema: Close
[0m01:58:54.798414 [info ] [Thread-4 (]: 5 of 8 PASS source_not_null_bronze_starlink_id ................................. [[32mPASS[0m in 0.05s]
[0m01:58:54.797892 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m01:58:54.794909 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: Close
[0m01:58:54.801042 [info ] [Thread-1 (]: 7 of 8 PASS source_unique_bronze_rockets_id .................................... [[32mPASS[0m in 0.05s]
[0m01:58:54.801365 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m01:58:54.799847 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m01:58:54.800599 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 01:58:54.775525 => 01:58:54.800530
[0m01:58:54.801999 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: ROLLBACK
[0m01:58:54.802243 [debug] [Thread-2 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: Close
[0m01:58:54.803188 [info ] [Thread-2 (]: 8 of 8 PASS source_unique_bronze_starlink_id ................................... [[32mPASS[0m in 0.04s]
[0m01:58:54.804252 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m01:58:54.806152 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:54.806382 [debug] [MainThread]: On master: BEGIN
[0m01:58:54.806704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:58:54.807178 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/target/catalog.json
[0m01:58:54.807570 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:58:54.807525 after 0.24 seconds
[0m01:58:54.807858 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:58:54.808061 [debug] [MainThread]: Connection 'spacex_db.information_schema' was properly closed.
[0m01:58:54.808260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959e1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951bee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bc27b0>]}
[0m01:58:54.808484 [debug] [MainThread]: Flushing usage events
[0m01:58:54.808686 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:54.808969 [debug] [MainThread]: On master: COMMIT
[0m01:58:54.809205 [debug] [MainThread]: Using postgres connection "master"
[0m01:58:54.809387 [debug] [MainThread]: On master: COMMIT
[0m01:58:54.809586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:58:54.809898 [debug] [MainThread]: On master: Close
[0m01:58:54.810261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:58:54.810445 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m01:58:54.810628 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m01:58:54.810825 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8' was properly closed.
[0m01:58:54.811009 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e' was properly closed.
[0m01:58:54.811212 [info ] [MainThread]: 
[0m01:58:54.811415 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m01:58:54.812063 [debug] [MainThread]: Command end result
[0m01:58:54.816255 [info ] [MainThread]: 
[0m01:58:54.816557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:58:54.816764 [info ] [MainThread]: 
[0m01:58:54.817001 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m01:58:54.817286 [debug] [MainThread]: Command `dbt test` succeeded at 01:58:54.817251 after 0.26 seconds
[0m01:58:54.817508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a17c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ce2630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b20b00>]}
[0m01:58:54.817742 [debug] [MainThread]: Flushing usage events
[0m01:58:57.075342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa510b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa571a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa563d700>]}


============================== 01:58:57.076917 | 4db3bf01-f1d9-4504-ad13-254c90f7da74 ==============================
[0m01:58:57.076917 [info ] [MainThread]: Running with dbt=1.6.0
[0m01:58:57.077232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation log_results --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:58:57.114305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4db3bf01-f1d9-4504-ad13-254c90f7da74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa526f020>]}
[0m01:58:57.119960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4db3bf01-f1d9-4504-ad13-254c90f7da74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa468c050>]}
[0m01:58:57.120327 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m01:58:57.123978 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m01:58:57.139173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:58:57.139510 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:58:57.142058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4db3bf01-f1d9-4504-ad13-254c90f7da74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa513c530>]}
[0m01:58:57.147672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4db3bf01-f1d9-4504-ad13-254c90f7da74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46ce120>]}
[0m01:58:57.148009 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 352 macros, 0 groups, 0 semantic models
[0m01:58:57.148268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db3bf01-f1d9-4504-ad13-254c90f7da74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4663c80>]}
[0m01:58:57.148667 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_results'
[0m01:58:57.148895 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m01:58:57.149089 [debug] [MainThread]: On macro_log_results: BEGIN
[0m01:58:57.149275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:58:57.151474 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m01:58:57.151760 [debug] [MainThread]: On macro_log_results: COMMIT
[0m01:58:57.151977 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m01:58:57.152171 [debug] [MainThread]: On macro_log_results: COMMIT
[0m01:58:57.152422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m01:58:57.157426 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m01:58:57.157825 [debug] [MainThread]: On macro_log_results: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "macro_log_results"} */

    
    SELECT 
      "🎯 ANSWER: Launches Needed" as launches_needed,
      "🎯 ANSWER: Months to 42K" as months_needed,
      "🎯 ANSWER: Est. Completion Date" as completion_date,
      "CONFIDENCE: Projection Reliability" as confidence
    FROM gold.starlink_42k_projection
    LIMIT 1
  
  
[0m01:58:57.158304 [debug] [MainThread]: Postgres adapter: Postgres error: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^

[0m01:58:57.158831 [debug] [MainThread]: Postgres adapter: Error running SQL: macro log_results
[0m01:58:57.159118 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m01:58:57.159333 [debug] [MainThread]: On macro_log_results: Close
[0m01:58:57.159688 [error] [MainThread]: Encountered an error while running operation: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^
[0m01:58:57.161619 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 73, in exception_handler
    yield
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "🎯 ANSWER: Launches Needed" does not exist
LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1054, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 290, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 146, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 84, in exception_handler
    raise dbt.exceptions.DbtDatabaseError(str(e).strip()) from e
dbt.exceptions.DbtDatabaseError: Database Error
  column "🎯 ANSWER: Launches Needed" does not exist
  LINE 5:       "🎯 ANSWER: Launches Needed" as launches_needed,
                ^

[0m01:58:57.163014 [debug] [MainThread]: Command `dbt run-operation` failed at 01:58:57.162974 after 0.09 seconds
[0m01:58:57.163255 [debug] [MainThread]: Connection 'macro_log_results' was properly closed.
[0m01:58:57.163519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa510baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa513c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa468f500>]}
[0m01:58:57.163781 [debug] [MainThread]: Flushing usage events
