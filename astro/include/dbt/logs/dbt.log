[0m00:11:18.959446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c2b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c2a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c2a6f0>]}


============================== 00:11:18.961055 | 5013db6b-1917-4862-8141-f0b96e4e26a3 ==============================
[0m00:11:18.961055 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:11:18.961383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:11:18.968235 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m00:11:18.968562 [debug] [MainThread]: Command `dbt deps` failed at 00:11:18.968516 after 0.01 seconds
[0m00:11:18.968787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c2a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c2ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c28ec0>]}
[0m00:11:18.969014 [debug] [MainThread]: Flushing usage events
[0m00:16:21.136640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5cb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6ea120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9f4aa0>]}


============================== 00:16:21.138572 | 704e58cf-6b94-44d5-91a4-7b746ba4beaa ==============================
[0m00:16:21.138572 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:16:21.138949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:16:21.145643 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m00:16:21.145995 [debug] [MainThread]: Command `dbt deps` failed at 00:16:21.145951 after 0.01 seconds
[0m00:16:21.146246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7da2f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be81d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c923590>]}
[0m00:16:21.146547 [debug] [MainThread]: Flushing usage events
[0m00:16:23.038346 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:21:24.722922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e7b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb8b6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f9fe90>]}


============================== 00:21:24.724762 | 4aa92dab-57f7-421f-97fd-c1b2a16f24e6 ==============================
[0m00:21:24.724762 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:21:24.725095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:21:24.732255 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m00:21:24.732811 [debug] [MainThread]: Command `dbt deps` failed at 00:21:24.732769 after 0.01 seconds
[0m00:21:24.733078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba677380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e9c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e9c0e0>]}
[0m00:21:24.733343 [debug] [MainThread]: Flushing usage events
[0m00:21:26.201974 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:35:08.437368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b9b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb51e6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b9a630>]}


============================== 04:35:08.438934 | 6de82cf7-89b1-4c2c-8e2a-ce85cdbb3d9a ==============================
[0m04:35:08.438934 [info ] [MainThread]: Running with dbt=1.6.0
[0m04:35:08.439331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:35:08.446564 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m04:35:08.447156 [debug] [MainThread]: Command `dbt deps` failed at 04:35:08.447114 after 0.01 seconds
[0m04:35:08.447446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4f3f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb917e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4bb9c10>]}
[0m04:35:08.447744 [debug] [MainThread]: Flushing usage events
[0m04:40:10.538924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3a8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4dbcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3aa630>]}


============================== 04:40:10.541245 | 530ecbd1-56a5-41e3-a6f8-c420fee5c1fa ==============================
[0m04:40:10.541245 [info ] [MainThread]: Running with dbt=1.6.0
[0m04:40:10.541640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:40:10.554834 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m04:40:10.556342 [debug] [MainThread]: Command `dbt deps` failed at 04:40:10.556112 after 0.02 seconds
[0m04:40:10.557470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c270170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4d9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3dc350>]}
[0m04:40:10.558311 [debug] [MainThread]: Flushing usage events
[0m04:40:11.994624 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:45:13.701003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c58e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1dd7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22a7740>]}


============================== 04:45:13.702688 | f6aa1f91-b7af-40ae-bc12-70134446aa68 ==============================
[0m04:45:13.702688 [info ] [MainThread]: Running with dbt=1.6.0
[0m04:45:13.703057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:45:13.710491 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m04:45:13.710988 [debug] [MainThread]: Command `dbt deps` failed at 04:45:13.710928 after 0.01 seconds
[0m04:45:13.711291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2294b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c89d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c8ade0>]}
[0m04:45:13.711591 [debug] [MainThread]: Flushing usage events
[0m04:45:15.190066 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:53:57.602974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8462b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8462a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8462b620>]}


============================== 04:53:57.605590 | 501a73c4-ad29-40d1-b502-7362fcb07fbe ==============================
[0m04:53:57.605590 [info ] [MainThread]: Running with dbt=1.6.0
[0m04:53:57.605997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:53:57.614296 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m04:53:57.614830 [debug] [MainThread]: Command `dbt deps` failed at 04:53:57.614777 after 0.02 seconds
[0m04:53:57.615118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ac9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b7f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b5d160>]}
[0m04:53:57.615415 [debug] [MainThread]: Flushing usage events
[0m04:58:59.794178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36c79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa307a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3078e60>]}


============================== 04:58:59.796720 | a4cf9196-3784-470a-a9e0-c3e984f3a05f ==============================
[0m04:58:59.796720 [info ] [MainThread]: Running with dbt=1.6.0
[0m04:58:59.797085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:58:59.803872 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m04:58:59.804225 [debug] [MainThread]: Command `dbt deps` failed at 04:58:59.804181 after 0.01 seconds
[0m04:58:59.804489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3038170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e1ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30abd70>]}
[0m04:58:59.804752 [debug] [MainThread]: Flushing usage events
[0m05:04:01.871120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891a8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8966a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891aa630>]}


============================== 05:04:01.872588 | ffe90933-2e75-4dbd-b230-d66544cb7849 ==============================
[0m05:04:01.872588 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:04:01.872927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m05:04:01.879556 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in /usr/local/airflow/include/dbt/dbt_project.yml
[0m05:04:01.879915 [debug] [MainThread]: Command `dbt deps` failed at 05:04:01.879871 after 0.01 seconds
[0m05:04:01.880167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896b8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895e2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891d8080>]}
[0m05:04:01.880415 [debug] [MainThread]: Flushing usage events
[0m05:04:03.691313 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:26:55.460835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c79b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdaa1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c79a630>]}


============================== 05:26:55.462750 | 7adba9b4-da13-4e1f-8062-3100e2cc2e1a ==============================
[0m05:26:55.462750 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:26:55.463285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:26:55.496817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7adba9b4-da13-4e1f-8062-3100e2cc2e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d732cf0>]}
[0m05:26:55.497973 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:26:55.498476 [debug] [MainThread]: Command `dbt deps` succeeded at 05:26:55.498424 after 0.04 seconds
[0m05:26:55.498789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cca0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c92e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c83f980>]}
[0m05:26:55.499060 [debug] [MainThread]: Flushing usage events
[0m05:26:57.254150 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:26:58.014007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fa4fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81da3cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fa6a80>]}


============================== 05:26:58.015742 | 66baa373-f242-41e9-a9b8-b4dfd3765003 ==============================
[0m05:26:58.015742 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:26:58.016117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models silver --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:26:58.058168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81089f70>]}
[0m05:26:58.063472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fa7440>]}
[0m05:26:58.063894 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:26:58.067994 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:26:58.068831 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:26:58.069107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81779ca0>]}
[0m05:26:58.330755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804c6030>]}
[0m05:26:58.335712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804a20c0>]}
[0m05:26:58.335964 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:26:58.336177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804c4e90>]}
[0m05:26:58.336854 [info ] [MainThread]: 
[0m05:26:58.337220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:26:58.337790 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:26:58.341379 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:26:58.341667 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:26:58.341870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:26:58.345090 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m05:26:58.345712 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:26:58.346207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_gold_silver)
[0m05:26:58.346552 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "gold_silver"
"
[0m05:26:58.348410 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_silver"
[0m05:26:58.348628 [debug] [ThreadPool]: On create_spacex_db_gold_silver: BEGIN
[0m05:26:58.348863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:26:58.350322 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.350584 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_silver"
[0m05:26:58.350837 [debug] [ThreadPool]: On create_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "create_spacex_db_gold_silver"} */
create schema if not exists "gold_silver"
[0m05:26:58.351984 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:26:58.352430 [debug] [ThreadPool]: On create_spacex_db_gold_silver: COMMIT
[0m05:26:58.352653 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_silver"
[0m05:26:58.352820 [debug] [ThreadPool]: On create_spacex_db_gold_silver: COMMIT
[0m05:26:58.353492 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m05:26:58.353684 [debug] [ThreadPool]: On create_spacex_db_gold_silver: Close
[0m05:26:58.354675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:26:58.354956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_gold_silver, now list_spacex_db_gold_silver)
[0m05:26:58.357006 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:26:58.357792 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:26:58.358011 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:26:58.358217 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:26:58.358398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:26:58.358629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:26:58.360193 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.360314 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.360452 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:26:58.360672 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:26:58.360886 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:26:58.361110 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:26:58.364322 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:26:58.364440 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:26:58.364951 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:26:58.365465 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:26:58.365726 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:26:58.365895 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:26:58.369716 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.370206 [debug] [MainThread]: On master: BEGIN
[0m05:26:58.370413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:26:58.371847 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.372066 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.372282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:26:58.377184 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m05:26:58.377809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8049a720>]}
[0m05:26:58.378098 [debug] [MainThread]: On master: ROLLBACK
[0m05:26:58.378372 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.378570 [debug] [MainThread]: On master: BEGIN
[0m05:26:58.378878 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.379093 [debug] [MainThread]: On master: COMMIT
[0m05:26:58.379274 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.379443 [debug] [MainThread]: On master: COMMIT
[0m05:26:58.379654 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:26:58.379830 [debug] [MainThread]: On master: Close
[0m05:26:58.380191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:26:58.380843 [info ] [MainThread]: 
[0m05:26:58.382126 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m05:26:58.382290 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m05:26:58.382536 [info ] [Thread-1 (]: 1 of 2 START sql view model gold_silver.silver_launches ........................ [RUN]
[0m05:26:58.382761 [info ] [Thread-2 (]: 2 of 2 START sql view model gold_silver.silver_starlink ........................ [RUN]
[0m05:26:58.383225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now model.spacex_analytics.silver_launches)
[0m05:26:58.383549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.silver_starlink)
[0m05:26:58.383775 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m05:26:58.383979 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m05:26:58.386959 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m05:26:58.388371 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m05:26:58.391286 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 05:26:58.387198 => 05:26:58.391183
[0m05:26:58.391591 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m05:26:58.397476 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 05:26:58.384160 => 05:26:58.397400
[0m05:26:58.403098 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m05:26:58.403998 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.silver_starlink"
[0m05:26:58.405245 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.silver_launches"
[0m05:26:58.408212 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.408476 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: BEGIN
[0m05:26:58.408746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:26:58.408903 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.409629 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: BEGIN
[0m05:26:58.409878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:26:58.410570 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.410885 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.411271 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

  create view "spacex_db"."gold_silver"."silver_starlink__dbt_tmp"
    
    
  as (
    

WITH parsed_starlink AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as satellite_id,
        data->'spaceTrack'->>'OBJECT_NAME' as satellite_name,
        data->>'launch' as launch_id,
        
        -- Launch and creation dates
        CASE 
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'LAUNCH_DATE')::date 
            ELSE NULL 
        END as launch_date,
        
        CASE 
            WHEN data->'spaceTrack'->>'CREATION_DATE' IS NOT NULL 
            THEN (data->'spaceTrack'->>'CREATION_DATE')::timestamp 
            ELSE NULL 
        END as tracking_creation_date,
        
        -- Satellite status determination (multiple fallback methods)
        CASE 
            -- Primary: DECAYED field
            WHEN data->'spaceTrack'->>'DECAYED' = '0' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'false' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = 'False' THEN true
            WHEN data->'spaceTrack'->>'DECAYED' = '1' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'true' THEN false
            WHEN data->'spaceTrack'->>'DECAYED' = 'True' THEN false
            -- Fallback: DECAY_DATE field
            WHEN data->'spaceTrack'->>'DECAY_DATE' IS NULL OR data->'spaceTrack'->>'DECAY_DATE' = '' THEN true
            ELSE false
        END as is_active,
        
        -- Orbital parameters (parsed to numeric types)
        CASE 
            WHEN data->'spaceTrack'->>'INCLINATION' IS NOT NULL 
            THEN (data->'spaceTrack'->>'INCLINATION')::numeric 
            ELSE NULL 
        END as inclination_deg,
        
        CASE 
            WHEN data->'spaceTrack'->>'SEMIMAJOR_AXIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'SEMIMAJOR_AXIS')::numeric 
            ELSE NULL 
        END as semimajor_axis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIOD' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIOD')::numeric 
            ELSE NULL 
        END as orbital_period_min,
        
        CASE 
            WHEN data->'spaceTrack'->>'APOAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'APOAPSIS')::numeric 
            ELSE NULL 
        END as apoapsis_km,
        
        CASE 
            WHEN data->'spaceTrack'->>'PERIAPSIS' IS NOT NULL 
            THEN (data->'spaceTrack'->>'PERIAPSIS')::numeric 
            ELSE NULL 
        END as periapsis_km,
        
        -- Current position data (if available)
        CASE 
            WHEN data->>'longitude' IS NOT NULL 
            THEN (data->>'longitude')::numeric 
            ELSE NULL 
        END as longitude,
        
        CASE 
            WHEN data->>'latitude' IS NOT NULL 
            THEN (data->>'latitude')::numeric 
            ELSE NULL 
        END as latitude,
        
        CASE 
            WHEN data->>'height_km' IS NOT NULL 
            THEN (data->>'height_km')::numeric 
            ELSE NULL 
        END as altitude_km,
        
        CASE 
            WHEN data->>'velocity_kms' IS NOT NULL 
            THEN (data->>'velocity_kms')::numeric 
            ELSE NULL 
        END as velocity_kms,
        
        -- Tracking information
        data->'spaceTrack'->>'NORAD_CAT_ID' as norad_catalog_id,
        data->'spaceTrack'->>'OBJECT_ID' as object_id,
        data->'spaceTrack'->>'DECAY_DATE' as decay_date_raw,
        
        -- Data quality assessment
        CASE 
            WHEN data->'spaceTrack'->>'OBJECT_NAME' IS NULL THEN 'missing_satellite_name'
            WHEN data->>'launch' IS NULL THEN 'missing_launch_reference'
            WHEN data->'spaceTrack'->>'DECAYED' IS NULL AND data->'spaceTrack'->>'DECAY_DATE' IS NULL THEN 'missing_status_info'
            WHEN data->'spaceTrack'->>'LAUNCH_DATE' IS NULL THEN 'missing_launch_date'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."starlink"
    WHERE data IS NOT NULL
)

SELECT 
    satellite_id,
    satellite_name,
    launch_id,
    launch_date,
    tracking_creation_date,
    is_active,
    inclination_deg,
    semimajor_axis_km,
    orbital_period_min,
    apoapsis_km,
    periapsis_km,
    longitude,
    latitude,
    altitude_km,
    velocity_kms,
    norad_catalog_id,
    object_id,
    decay_date_raw,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    CASE 
        WHEN semimajor_axis_km IS NOT NULL 
        THEN semimajor_axis_km - 6371.0  -- Convert to altitude above Earth's surface
        ELSE NULL 
    END as calculated_altitude_km,
    
    -- Orbital regime classification
    CASE 
        WHEN semimajor_axis_km - 6371.0 BETWEEN 160 AND 2000 THEN 'Low Earth Orbit (LEO)'
        WHEN semimajor_axis_km - 6371.0 BETWEEN 2000 AND 35786 THEN 'Medium Earth Orbit (MEO)'
        WHEN semimajor_axis_km - 6371.0 > 35786 THEN 'Geostationary Orbit (GEO)'
        ELSE 'Unknown'
    END as orbital_regime,
    
    -- Age calculation
    CASE 
        WHEN launch_date IS NOT NULL 
        THEN CURRENT_DATE - launch_date 
        ELSE NULL 
    END as satellite_age_days

FROM parsed_starlink
WHERE satellite_id IS NOT NULL

-- Add model documentation

  );
[0m05:26:58.411827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.412367 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.412837 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

  create view "spacex_db"."gold_silver"."silver_launches__dbt_tmp"
    
    
  as (
    

WITH parsed_launches AS (
    SELECT 
        -- Basic identifiers
        data->>'id' as launch_id,
        data->>'name' as mission_name,
        
        -- Date and time parsing
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp 
            ELSE NULL 
        END as launch_date_utc,
        
        CASE 
            WHEN data->>'date_utc' IS NOT NULL 
            THEN (data->>'date_utc')::timestamp::date 
            ELSE NULL 
        END as launch_date,
        
        -- Launch outcome
        CASE 
            WHEN (data->'success')::text = 'true' THEN true
            WHEN (data->'success')::text = 'false' THEN false
            ELSE NULL
        END as launch_success,
        
        CASE 
            WHEN (data->'upcoming')::text = 'true' THEN true
            WHEN (data->'upcoming')::text = 'false' THEN false
            ELSE NULL
        END as is_upcoming,
        
        -- Technical details
        data->>'rocket' as rocket_id,
        
        CASE 
            WHEN data->>'flight_number' IS NOT NULL 
            THEN (data->>'flight_number')::integer 
            ELSE NULL 
        END as flight_number,
        
        data->>'launchpad' as launchpad_id,
        data->>'details' as mission_details,
        
        -- Business logic: Starlink mission identification
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN true
            WHEN LOWER(data->>'name') LIKE '%starship%' AND LOWER(data->>'name') LIKE '%starlink%' THEN true
            ELSE false
        END as is_starlink_mission,
        
        -- Satellite count estimation for Starlink missions
        CASE 
            WHEN LOWER(data->>'name') LIKE '%starlink%' THEN
                CASE 
                    -- Early test missions
                    WHEN LOWER(data->>'name') LIKE '%demo%' 
                      OR LOWER(data->>'name') LIKE '%test%' 
                      OR data->>'name' ILIKE '%tintin%' THEN 2
                    -- V1.0 missions (60 satellites each)
                    WHEN data->>'name' ILIKE '%v1.0%' THEN 60
                    -- V2 missions (larger satellites, fewer per launch)
                    WHEN data->>'name' ILIKE '%v2%' THEN 23
                    -- Standard production batches
                    ELSE 60
                END
            ELSE 0
        END as estimated_satellite_count,
        
        -- Payload analysis
        CASE 
            WHEN data->'payloads' IS NOT NULL 
            THEN jsonb_array_length(data->'payloads') 
            ELSE 0 
        END as payload_count,
        
        -- Data quality assessment
        CASE 
            WHEN data->>'date_utc' IS NULL THEN 'missing_launch_date'
            WHEN data->>'name' IS NULL THEN 'missing_mission_name'
            WHEN (data->'success') IS NULL AND (data->'upcoming')::text = 'false' THEN 'missing_success_status'
            WHEN data->>'rocket' IS NULL THEN 'missing_rocket_info'
            ELSE 'valid'
        END as data_quality_flag,
        
        -- Metadata
        extracted_at,
        source_system
        
    FROM "spacex_db"."bronze"."launches"
    WHERE data IS NOT NULL
)

SELECT 
    launch_id,
    mission_name,
    launch_date_utc,
    launch_date,
    launch_success,
    is_upcoming,
    rocket_id,
    flight_number,
    launchpad_id,
    mission_details,
    is_starlink_mission,
    estimated_satellite_count,
    payload_count,
    data_quality_flag,
    extracted_at,
    source_system,
    
    -- Additional derived fields
    EXTRACT(YEAR FROM launch_date_utc) as launch_year,
    EXTRACT(MONTH FROM launch_date_utc) as launch_month,
    EXTRACT(DOW FROM launch_date_utc) as launch_day_of_week,
    
    -- Mission type classification
    CASE 
        WHEN is_starlink_mission THEN 'Starlink'
        WHEN LOWER(mission_name) LIKE '%crew%' THEN 'Crew'
        WHEN LOWER(mission_name) LIKE '%cargo%' OR LOWER(mission_name) LIKE '%crs%' THEN 'Cargo'
        WHEN LOWER(mission_name) LIKE '%satellite%' THEN 'Commercial Satellite'
        ELSE 'Other'
    END as mission_type

FROM parsed_launches
WHERE launch_id IS NOT NULL

-- Add model documentation

  );
[0m05:26:58.416900 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:26:58.417069 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:26:58.419432 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.420456 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.420749 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
alter table "spacex_db"."gold_silver"."silver_launches__dbt_tmp" rename to "silver_launches"
[0m05:26:58.420972 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
alter table "spacex_db"."gold_silver"."silver_starlink__dbt_tmp" rename to "silver_starlink"
[0m05:26:58.421454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:58.421603 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:58.426899 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.427897 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.428158 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

        COMMENT ON VIEW "spacex_db"."gold_silver"."silver_launches" IS 'Cleaned launch data with Starlink mission identification and satellite count estimation'
      
[0m05:26:58.428377 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */

        COMMENT ON VIEW "spacex_db"."gold_silver"."silver_starlink" IS 'Cleaned Starlink satellite data with active status determination and orbital parameters'
      
[0m05:26:58.429987 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m05:26:58.430128 [debug] [Thread-2 (]: SQL status: COMMENT in 0.0 seconds
[0m05:26:58.430534 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m05:26:58.431199 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.430948 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m05:26:58.431596 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.431402 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: COMMIT
[0m05:26:58.431790 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: COMMIT
[0m05:26:58.432661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:58.435625 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m05:26:58.435777 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:58.435955 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */
drop view if exists "spacex_db"."gold_silver"."silver_launches__dbt_backup" cascade
[0m05:26:58.436901 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_starlink"
[0m05:26:58.437225 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:26:58.437355 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.silver_starlink"} */
drop view if exists "spacex_db"."gold_silver"."silver_starlink__dbt_backup" cascade
[0m05:26:58.438021 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 05:26:58.404123 => 05:26:58.437959
[0m05:26:58.438314 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:26:58.438493 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: Close
[0m05:26:58.439066 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 05:26:58.391812 => 05:26:58.439014
[0m05:26:58.439511 [debug] [Thread-2 (]: On model.spacex_analytics.silver_starlink: Close
[0m05:26:58.440713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80464110>]}
[0m05:26:58.440829 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66baa373-f242-41e9-a9b8-b4dfd3765003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803db4a0>]}
[0m05:26:58.441136 [info ] [Thread-1 (]: 1 of 2 OK created sql view model gold_silver.silver_launches ................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:26:58.441432 [info ] [Thread-2 (]: 2 of 2 OK created sql view model gold_silver.silver_starlink ................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:26:58.441815 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m05:26:58.442091 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m05:26:58.446879 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.447056 [debug] [MainThread]: On master: BEGIN
[0m05:26:58.447209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:26:58.448464 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:26:58.448690 [debug] [MainThread]: On master: COMMIT
[0m05:26:58.449117 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:58.449308 [debug] [MainThread]: On master: COMMIT
[0m05:26:58.449554 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:26:58.449746 [debug] [MainThread]: On master: Close
[0m05:26:58.450058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:26:58.450550 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_launches' was properly closed.
[0m05:26:58.450746 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_starlink' was properly closed.
[0m05:26:58.450945 [info ] [MainThread]: 
[0m05:26:58.451215 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m05:26:58.451604 [debug] [MainThread]: Command end result
[0m05:26:58.456171 [info ] [MainThread]: 
[0m05:26:58.456446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:26:58.456653 [info ] [MainThread]: 
[0m05:26:58.456854 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:26:58.457222 [debug] [MainThread]: Command `dbt run` succeeded at 05:26:58.457185 after 0.45 seconds
[0m05:26:58.457457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810899a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f3dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f3dbe0>]}
[0m05:26:58.457687 [debug] [MainThread]: Flushing usage events
[0m05:26:59.312740 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:27:01.191298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b748ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4ba330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc4cc80>]}


============================== 05:27:01.192999 | be1720af-5233-49a2-b284-a86ced899074 ==============================
[0m05:27:01.192999 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:27:01.193333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:27:01.229062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b77c200>]}
[0m05:27:01.234511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8a80e0>]}
[0m05:27:01.234864 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:27:01.238566 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:27:01.255541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:27:01.255795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:27:01.257939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b74b260>]}
[0m05:27:01.263283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad172c0>]}
[0m05:27:01.263563 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:27:01.263815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7eee40>]}
[0m05:27:01.264478 [info ] [MainThread]: 
[0m05:27:01.264840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:27:01.265392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:27:01.269041 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:27:01.269284 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:27:01.269513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:01.271545 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:27:01.272129 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:27:01.272631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_gold_gold)
[0m05:27:01.272983 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "gold_gold"
"
[0m05:27:01.274875 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_gold"
[0m05:27:01.275124 [debug] [ThreadPool]: On create_spacex_db_gold_gold: BEGIN
[0m05:27:01.275330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:01.277173 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.277449 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_gold"
[0m05:27:01.277849 [debug] [ThreadPool]: On create_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "create_spacex_db_gold_gold"} */
create schema if not exists "gold_gold"
[0m05:27:01.278260 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:27:01.278696 [debug] [ThreadPool]: On create_spacex_db_gold_gold: COMMIT
[0m05:27:01.278931 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_gold_gold"
[0m05:27:01.279150 [debug] [ThreadPool]: On create_spacex_db_gold_gold: COMMIT
[0m05:27:01.279676 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m05:27:01.279903 [debug] [ThreadPool]: On create_spacex_db_gold_gold: Close
[0m05:27:01.280752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_gold_gold, now list_spacex_db_gold_silver)
[0m05:27:01.281092 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:27:01.283068 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:27:01.283817 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:27:01.284032 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:27:01.284221 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:27:01.284413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:01.284614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:01.285870 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.285988 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.286105 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:27:01.286304 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:27:01.286504 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:27:01.286719 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:27:01.287857 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:27:01.288388 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:27:01.288518 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:27:01.288657 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:27:01.289140 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:27:01.290194 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:27:01.292627 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.292864 [debug] [MainThread]: On master: BEGIN
[0m05:27:01.293075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:27:01.294404 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.294665 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.294918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:27:01.298410 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:27:01.298960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c693ec0>]}
[0m05:27:01.299244 [debug] [MainThread]: On master: ROLLBACK
[0m05:27:01.299537 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.299755 [debug] [MainThread]: On master: BEGIN
[0m05:27:01.300096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.300321 [debug] [MainThread]: On master: COMMIT
[0m05:27:01.300561 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.300776 [debug] [MainThread]: On master: COMMIT
[0m05:27:01.301044 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:27:01.301256 [debug] [MainThread]: On master: Close
[0m05:27:01.301635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:27:01.302235 [info ] [MainThread]: 
[0m05:27:01.303632 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:27:01.303938 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:27:01.304330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now model.spacex_analytics.starlink_constellation_status)
[0m05:27:01.304609 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:27:01.307634 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:27:01.309253 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:27:01.304835 => 05:27:01.309163
[0m05:27:01.309513 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:27:01.322675 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:27:01.324253 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:27:01.324547 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:27:01.324763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:27:01.326352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.326577 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:27:01.326877 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600 as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:27:01.328614 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:27:01.328839 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: ROLLBACK
[0m05:27:01.329161 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:27:01.309715 => 05:27:01.329085
[0m05:27:01.329378 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:27:01.333562 [debug] [Thread-1 (]: Database Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)
  function round(double precision, integer) does not exist
  LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:27:01.333861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be1720af-5233-49a2-b284-a86ced899074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac7b650>]}
[0m05:27:01.334154 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold_gold.starlink_constellation_status .. [[31mERROR[0m in 0.03s]
[0m05:27:01.334441 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:27:01.335810 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:27:01.336071 [info ] [Thread-3 (]: 2 of 2 SKIP relation gold_gold.starlink_42k_projection ......................... [[33mSKIP[0m]
[0m05:27:01.336297 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:27:01.337440 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.337666 [debug] [MainThread]: On master: BEGIN
[0m05:27:01.337850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:27:01.339144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:27:01.339321 [debug] [MainThread]: On master: COMMIT
[0m05:27:01.339475 [debug] [MainThread]: Using postgres connection "master"
[0m05:27:01.339639 [debug] [MainThread]: On master: COMMIT
[0m05:27:01.339848 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:27:01.340005 [debug] [MainThread]: On master: Close
[0m05:27:01.340295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:27:01.340458 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:27:01.340615 [debug] [MainThread]: Connection 'list_spacex_db_gold_gold' was properly closed.
[0m05:27:01.340815 [info ] [MainThread]: 
[0m05:27:01.340988 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m05:27:01.341281 [debug] [MainThread]: Command end result
[0m05:27:01.344944 [info ] [MainThread]: 
[0m05:27:01.345148 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:27:01.345315 [info ] [MainThread]: 
[0m05:27:01.345489 [error] [MainThread]: [33mDatabase Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)[0m
[0m05:27:01.345655 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:27:01.345816 [error] [MainThread]:   LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
[0m05:27:01.345974 [error] [MainThread]:                 ^
[0m05:27:01.346155 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:27:01.346329 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:27:01.346509 [info ] [MainThread]: 
[0m05:27:01.346706 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m05:27:01.346949 [debug] [MainThread]: Command `dbt run` failed at 05:27:01.346915 after 0.16 seconds
[0m05:27:01.347153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc7fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb38770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb85940>]}
[0m05:27:01.347335 [debug] [MainThread]: Flushing usage events
[0m05:27:02.207590 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:32:03.979193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbdb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d217620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc9a330>]}


============================== 05:32:03.981248 | c6a81c57-89b2-4081-b159-5233cd5ad9db ==============================
[0m05:32:03.981248 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:32:03.981868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:32:04.035127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c15d670>]}
[0m05:32:04.041128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c15c8c0>]}
[0m05:32:04.041857 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:32:04.046845 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:32:04.065710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:32:04.066107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:32:04.068407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c15fdd0>]}
[0m05:32:04.075214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1aa1e0>]}
[0m05:32:04.075564 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:32:04.075972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ccbd730>]}
[0m05:32:04.076795 [info ] [MainThread]: 
[0m05:32:04.077276 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:32:04.077903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:32:04.082160 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:32:04.082509 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:32:04.082722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:32:04.085010 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:32:04.085750 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:32:04.086572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_silver)
[0m05:32:04.087061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:32:04.089190 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:32:04.090217 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:32:04.090605 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:32:04.090940 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:32:04.091231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:32:04.091498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:32:04.093408 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.093654 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.093826 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:32:04.094115 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:32:04.094412 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:32:04.094702 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:32:04.096052 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:32:04.096225 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:32:04.096803 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:32:04.097443 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:32:04.097857 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:32:04.098047 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:32:04.101306 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.101649 [debug] [MainThread]: On master: BEGIN
[0m05:32:04.101903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:32:04.103550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.103821 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.104073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:32:04.107789 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:32:04.108541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc0c4a0>]}
[0m05:32:04.108847 [debug] [MainThread]: On master: ROLLBACK
[0m05:32:04.109136 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.109354 [debug] [MainThread]: On master: BEGIN
[0m05:32:04.109768 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.110109 [debug] [MainThread]: On master: COMMIT
[0m05:32:04.110320 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.110513 [debug] [MainThread]: On master: COMMIT
[0m05:32:04.110799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:32:04.111027 [debug] [MainThread]: On master: Close
[0m05:32:04.111409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:32:04.111831 [info ] [MainThread]: 
[0m05:32:04.113511 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:32:04.113883 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:32:04.114306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now model.spacex_analytics.starlink_constellation_status)
[0m05:32:04.114613 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:32:04.117846 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:32:04.119064 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:32:04.114836 => 05:32:04.118988
[0m05:32:04.119268 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:32:04.134052 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:32:04.135265 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:32:04.135581 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:32:04.135793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:04.137451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.137771 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:32:04.138080 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600 as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:32:04.139337 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:32:04.141416 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: ROLLBACK
[0m05:32:04.141765 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:32:04.119448 => 05:32:04.141692
[0m05:32:04.141972 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:32:04.143661 [debug] [Thread-1 (]: Database Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)
  function round(double precision, integer) does not exist
  LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:32:04.143990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a81c57-89b2-4081-b159-5233cd5ad9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff786a7830>]}
[0m05:32:04.144324 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold_gold.starlink_constellation_status .. [[31mERROR[0m in 0.03s]
[0m05:32:04.144788 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:32:04.146195 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:32:04.146608 [info ] [Thread-3 (]: 2 of 2 SKIP relation gold_gold.starlink_42k_projection ......................... [[33mSKIP[0m]
[0m05:32:04.146891 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:32:04.148253 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.148496 [debug] [MainThread]: On master: BEGIN
[0m05:32:04.148683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:32:04.150207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:32:04.150382 [debug] [MainThread]: On master: COMMIT
[0m05:32:04.150539 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:04.150682 [debug] [MainThread]: On master: COMMIT
[0m05:32:04.150863 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:32:04.151014 [debug] [MainThread]: On master: Close
[0m05:32:04.151273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:32:04.151439 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:32:04.151610 [debug] [MainThread]: Connection 'list_spacex_db_gold_gold' was properly closed.
[0m05:32:04.151795 [info ] [MainThread]: 
[0m05:32:04.151980 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m05:32:04.152286 [debug] [MainThread]: Command end result
[0m05:32:04.156259 [info ] [MainThread]: 
[0m05:32:04.156735 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:32:04.157120 [info ] [MainThread]: 
[0m05:32:04.157675 [error] [MainThread]: [33mDatabase Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)[0m
[0m05:32:04.157956 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:32:04.158196 [error] [MainThread]:   LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
[0m05:32:04.158368 [error] [MainThread]:                 ^
[0m05:32:04.158546 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:32:04.158709 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:32:04.158893 [info ] [MainThread]: 
[0m05:32:04.159079 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m05:32:04.159331 [debug] [MainThread]: Command `dbt run` failed at 05:32:04.159290 after 0.19 seconds
[0m05:32:04.159569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d10e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d97b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d07ac60>]}
[0m05:32:04.159780 [debug] [MainThread]: Flushing usage events
[0m05:37:07.210052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e98b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb0d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e98a630>]}


============================== 05:37:07.212046 | da678821-e62f-492c-8093-34cd0d025100 ==============================
[0m05:37:07.212046 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:37:07.212365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:37:07.251411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e98be30>]}
[0m05:37:07.256822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df01ca0>]}
[0m05:37:07.257188 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:37:07.261318 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:37:07.278651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:37:07.278925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:37:07.281032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ded75f0>]}
[0m05:37:07.287669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df3ffb0>]}
[0m05:37:07.287948 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:37:07.288249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea10980>]}
[0m05:37:07.288936 [info ] [MainThread]: 
[0m05:37:07.289318 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:37:07.289913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:37:07.293624 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:37:07.293841 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:37:07.294056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:07.296833 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:37:07.297424 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:37:07.298181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_silver)
[0m05:37:07.298546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:37:07.300434 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:37:07.301234 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:37:07.301450 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:37:07.301684 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:37:07.301875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:37:07.302087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:07.303510 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.303984 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.304152 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:37:07.304401 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:37:07.304714 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:37:07.305010 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:37:07.306547 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:37:07.306943 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:37:07.307373 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:37:07.307919 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:37:07.308294 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:37:07.308448 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:37:07.311511 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.311776 [debug] [MainThread]: On master: BEGIN
[0m05:37:07.312004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:37:07.313212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.313471 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.313758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:37:07.317291 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:37:07.317849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3a81a0>]}
[0m05:37:07.318131 [debug] [MainThread]: On master: ROLLBACK
[0m05:37:07.318431 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.318676 [debug] [MainThread]: On master: BEGIN
[0m05:37:07.319022 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.319265 [debug] [MainThread]: On master: COMMIT
[0m05:37:07.319497 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.319740 [debug] [MainThread]: On master: COMMIT
[0m05:37:07.320025 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:37:07.320252 [debug] [MainThread]: On master: Close
[0m05:37:07.320626 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:37:07.321116 [info ] [MainThread]: 
[0m05:37:07.322453 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:37:07.322779 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:37:07.323133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m05:37:07.323390 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:37:07.326392 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:37:07.327891 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:37:07.323613 => 05:37:07.327822
[0m05:37:07.328202 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:37:07.341189 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:37:07.342425 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:37:07.342726 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:37:07.342978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:37:07.344289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.344523 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:37:07.344818 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600 as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:37:07.346269 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:37:07.348098 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: ROLLBACK
[0m05:37:07.348422 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:37:07.328419 => 05:37:07.348357
[0m05:37:07.348655 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:37:07.350197 [debug] [Thread-1 (]: Database Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)
  function round(double precision, integer) does not exist
  LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:37:07.350755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da678821-e62f-492c-8093-34cd0d025100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4863f0>]}
[0m05:37:07.351107 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model gold_gold.starlink_constellation_status .. [[31mERROR[0m in 0.03s]
[0m05:37:07.351669 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:37:07.353403 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:37:07.353722 [info ] [Thread-3 (]: 2 of 2 SKIP relation gold_gold.starlink_42k_projection ......................... [[33mSKIP[0m]
[0m05:37:07.354027 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:37:07.355322 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.355553 [debug] [MainThread]: On master: BEGIN
[0m05:37:07.355739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:37:07.356896 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:37:07.357122 [debug] [MainThread]: On master: COMMIT
[0m05:37:07.357317 [debug] [MainThread]: Using postgres connection "master"
[0m05:37:07.357514 [debug] [MainThread]: On master: COMMIT
[0m05:37:07.357735 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:37:07.357924 [debug] [MainThread]: On master: Close
[0m05:37:07.358251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:37:07.358697 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m05:37:07.358894 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:37:07.359110 [info ] [MainThread]: 
[0m05:37:07.359336 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m05:37:07.359671 [debug] [MainThread]: Command end result
[0m05:37:07.364323 [info ] [MainThread]: 
[0m05:37:07.364565 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:37:07.364761 [info ] [MainThread]: 
[0m05:37:07.364955 [error] [MainThread]: [33mDatabase Error in model starlink_constellation_status (models/gold/starlink_constellation_status.sql)[0m
[0m05:37:07.365139 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:37:07.365323 [error] [MainThread]:   LINE 119:     ROUND(f.hours_since_last_update, 1) as hours_since_last_...
[0m05:37:07.365517 [error] [MainThread]:                 ^
[0m05:37:07.365702 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:37:07.365881 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_constellation_status.sql
[0m05:37:07.366058 [info ] [MainThread]: 
[0m05:37:07.366262 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m05:37:07.366680 [debug] [MainThread]: Command `dbt run` failed at 05:37:07.366572 after 0.16 seconds
[0m05:37:07.367000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea5e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea02cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee1b560>]}
[0m05:37:07.367247 [debug] [MainThread]: Flushing usage events
[0m05:40:02.053838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed53ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c45f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c203a40>]}


============================== 05:40:02.055879 | e0743292-f03b-4850-b6aa-842968f4678e ==============================
[0m05:40:02.055879 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:40:02.056401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:40:02.100829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bebde50>]}
[0m05:40:02.106846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b40ca70>]}
[0m05:40:02.107399 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:40:02.111562 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:40:02.135257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:40:02.135768 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_constellation_status.sql
[0m05:40:02.153769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bfeb230>]}
[0m05:40:02.160580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b373bf0>]}
[0m05:40:02.160979 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:40:02.161421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b373dd0>]}
[0m05:40:02.162460 [info ] [MainThread]: 
[0m05:40:02.163081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:40:02.163831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:40:02.168280 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:40:02.168586 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:40:02.168830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:40:02.171919 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:40:02.172834 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:40:02.173721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_silver)
[0m05:40:02.174148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:40:02.178123 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:40:02.177003 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:40:02.178941 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:40:02.178641 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:40:02.179511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:40:02.179195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:40:02.182660 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.183187 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:40:02.182946 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.183750 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:40:02.183489 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:40:02.184032 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:40:02.185386 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:40:02.186986 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:40:02.186431 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:40:02.187833 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:40:02.187386 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:40:02.188215 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:40:02.191642 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.191977 [debug] [MainThread]: On master: BEGIN
[0m05:40:02.192250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:40:02.194282 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.194575 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.194865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:40:02.199432 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:40:02.200135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8cae10>]}
[0m05:40:02.200423 [debug] [MainThread]: On master: ROLLBACK
[0m05:40:02.200732 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.200952 [debug] [MainThread]: On master: BEGIN
[0m05:40:02.201368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.201628 [debug] [MainThread]: On master: COMMIT
[0m05:40:02.201884 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.202105 [debug] [MainThread]: On master: COMMIT
[0m05:40:02.202394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:40:02.202605 [debug] [MainThread]: On master: Close
[0m05:40:02.203027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:40:02.203475 [info ] [MainThread]: 
[0m05:40:02.205166 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:40:02.205573 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:40:02.206075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m05:40:02.206344 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:40:02.209595 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.210848 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:40:02.206556 => 05:40:02.210737
[0m05:40:02.211093 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:40:02.225768 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.227286 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.227562 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:40:02.227845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:40:02.229995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.230369 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.230714 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:40:02.253114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m05:40:02.256150 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.256658 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m05:40:02.257131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:40:02.263704 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:40:02.264149 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.264499 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:40:02.265546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:40:02.268505 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:40:02.268942 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m05:40:02.269308 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:40:02.270060 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:40:02.211284 => 05:40:02.269993
[0m05:40:02.270314 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:40:02.270753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3e7f50>]}
[0m05:40:02.271691 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.06s]
[0m05:40:02.272203 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:40:02.273453 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:40:02.273725 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m05:40:02.274098 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m05:40:02.274349 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m05:40:02.276409 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m05:40:02.277403 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 05:40:02.274570 => 05:40:02.277318
[0m05:40:02.277643 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m05:40:02.279949 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m05:40:02.280939 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:40:02.281172 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m05:40:02.281368 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:40:02.283162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.283936 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:40:02.284407 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        (SELECT current_active_satellites FROM current_status) / NULLIF(COUNT(CASE WHEN launch_success THEN 1 END), 0) as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)
        ) as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, 50)  -- Minimum 50 per launch
        ) as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING(
            (42000 - s.current_active_satellites) / 70.0  -- Optimistic 70 satellites per launch
        ) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count), 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    ROUND(optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month), 1) as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(actual_satellites_per_successful_launch, 1) as "METRIC: Actual Sats per Success Launch",
    ROUND(recent_total_launches::numeric / NULLIF(recent_successful_launches, 0), 2) as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m05:40:02.286210 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:40:02.288681 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m05:40:02.289155 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 05:40:02.277819 => 05:40:02.289070
[0m05:40:02.289443 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m05:40:02.291238 [debug] [Thread-3 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  function round(double precision, integer) does not exist
  LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:40:02.291585 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0743292-f03b-4850-b6aa-842968f4678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae16750>]}
[0m05:40:02.291903 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model gold_gold.starlink_42k_projection ........ [[31mERROR[0m in 0.02s]
[0m05:40:02.292359 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:40:02.294051 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.294265 [debug] [MainThread]: On master: BEGIN
[0m05:40:02.294446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:40:02.295821 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:40:02.296013 [debug] [MainThread]: On master: COMMIT
[0m05:40:02.296171 [debug] [MainThread]: Using postgres connection "master"
[0m05:40:02.296313 [debug] [MainThread]: On master: COMMIT
[0m05:40:02.296504 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:40:02.296660 [debug] [MainThread]: On master: Close
[0m05:40:02.296949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:40:02.297107 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m05:40:02.297253 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:40:02.297401 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m05:40:02.297580 [info ] [MainThread]: 
[0m05:40:02.297759 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m05:40:02.298098 [debug] [MainThread]: Command end result
[0m05:40:02.302020 [info ] [MainThread]: 
[0m05:40:02.302282 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:40:02.302523 [info ] [MainThread]: 
[0m05:40:02.302775 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m05:40:02.302997 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:40:02.303187 [error] [MainThread]:   LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
[0m05:40:02.303360 [error] [MainThread]:                 ^
[0m05:40:02.303537 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:40:02.303701 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:40:02.303883 [info ] [MainThread]: 
[0m05:40:02.304067 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:40:02.304304 [debug] [MainThread]: Command `dbt run` failed at 05:40:02.304267 after 0.25 seconds
[0m05:40:02.304525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c203a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5e0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed53ec0>]}
[0m05:40:02.304728 [debug] [MainThread]: Flushing usage events
[0m05:45:04.922698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb17cb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b6d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c56f60>]}


============================== 05:45:04.924419 | 6b82eb6c-1960-4f02-b984-563799dee11b ==============================
[0m05:45:04.924419 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:45:04.924775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:45:04.962808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb193b200>]}
[0m05:45:04.968169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c549e0>]}
[0m05:45:04.968558 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:45:04.973729 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:45:04.987550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:45:04.987796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:45:04.990083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d3d220>]}
[0m05:45:04.995652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d8afc0>]}
[0m05:45:04.995956 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:45:04.996210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d17f80>]}
[0m05:45:04.997131 [info ] [MainThread]: 
[0m05:45:04.997617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:45:04.998215 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:45:05.002301 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:45:05.002638 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:45:05.002884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:05.005388 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:45:05.006083 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:45:05.006876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_gold)
[0m05:45:05.007171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_silver'
[0m05:45:05.009404 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:45:05.010214 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:45:05.010540 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:45:05.010790 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:45:05.011056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:05.011300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:05.012946 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.013082 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.013394 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:45:05.013686 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:45:05.013953 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:45:05.014241 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:45:05.015418 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:45:05.016164 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:45:05.016338 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m05:45:05.016515 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:45:05.017015 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:45:05.017766 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:45:05.020106 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.020361 [debug] [MainThread]: On master: BEGIN
[0m05:45:05.020571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:05.022089 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.022341 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.022648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:45:05.026275 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:45:05.026896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d8b620>]}
[0m05:45:05.027198 [debug] [MainThread]: On master: ROLLBACK
[0m05:45:05.027528 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.027760 [debug] [MainThread]: On master: BEGIN
[0m05:45:05.028111 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.028349 [debug] [MainThread]: On master: COMMIT
[0m05:45:05.028603 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.028862 [debug] [MainThread]: On master: COMMIT
[0m05:45:05.029134 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:45:05.029359 [debug] [MainThread]: On master: Close
[0m05:45:05.029736 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:45:05.030424 [info ] [MainThread]: 
[0m05:45:05.031827 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:45:05.032150 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:45:05.032563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m05:45:05.032821 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:45:05.035858 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.037448 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:45:05.033030 => 05:45:05.037367
[0m05:45:05.037712 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:45:05.050798 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.052046 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.052275 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:45:05.052486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:05.053977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.054184 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.054432 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:45:05.066797 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m05:45:05.069177 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.069431 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m05:45:05.069768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:45:05.070759 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.070978 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m05:45:05.071246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:45:05.077817 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:45:05.078099 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.078348 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:45:05.078997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:45:05.081705 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:05.081946 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m05:45:05.083825 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:45:05.084405 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:45:05.037916 => 05:45:05.084343
[0m05:45:05.084626 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:45:05.085013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0cabf50>]}
[0m05:45:05.085329 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.05s]
[0m05:45:05.085821 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:45:05.087210 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:45:05.087447 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m05:45:05.087817 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m05:45:05.088016 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m05:45:05.089750 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m05:45:05.090543 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 05:45:05.088165 => 05:45:05.090472
[0m05:45:05.090735 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m05:45:05.092051 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m05:45:05.092752 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:45:05.092954 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m05:45:05.093128 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:45:05.094419 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.094660 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:45:05.094992 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        (SELECT current_active_satellites FROM current_status) / NULLIF(COUNT(CASE WHEN launch_success THEN 1 END), 0) as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)
        ) as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, 50)  -- Minimum 50 per launch
        ) as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING(
            (42000 - s.current_active_satellites) / 70.0  -- Optimistic 70 satellites per launch
        ) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count), 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    ROUND(optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month), 1) as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(actual_satellites_per_successful_launch, 1) as "METRIC: Actual Sats per Success Launch",
    ROUND(recent_total_launches::numeric / NULLIF(recent_successful_launches, 0), 2) as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m05:45:05.097614 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:45:05.098096 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m05:45:05.101475 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 05:45:05.090893 => 05:45:05.101391
[0m05:45:05.101720 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m05:45:05.105407 [debug] [Thread-3 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  function round(double precision, integer) does not exist
  LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:45:05.106691 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b82eb6c-1960-4f02-b984-563799dee11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d59340>]}
[0m05:45:05.107071 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model gold_gold.starlink_42k_projection ........ [[31mERROR[0m in 0.02s]
[0m05:45:05.107557 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:45:05.109320 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.109572 [debug] [MainThread]: On master: BEGIN
[0m05:45:05.109805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:45:05.111369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:05.111604 [debug] [MainThread]: On master: COMMIT
[0m05:45:05.111793 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:05.111979 [debug] [MainThread]: On master: COMMIT
[0m05:45:05.112202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:45:05.112384 [debug] [MainThread]: On master: Close
[0m05:45:05.112707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:45:05.113323 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:45:05.113540 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m05:45:05.113718 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m05:45:05.113925 [info ] [MainThread]: 
[0m05:45:05.114197 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m05:45:05.114570 [debug] [MainThread]: Command end result
[0m05:45:05.118734 [info ] [MainThread]: 
[0m05:45:05.118996 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:45:05.119200 [info ] [MainThread]: 
[0m05:45:05.119411 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m05:45:05.119615 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:45:05.119798 [error] [MainThread]:   LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
[0m05:45:05.119975 [error] [MainThread]:                 ^
[0m05:45:05.120152 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:45:05.120324 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:45:05.120511 [info ] [MainThread]: 
[0m05:45:05.120713 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:45:05.120982 [debug] [MainThread]: Command `dbt run` failed at 05:45:05.120947 after 0.20 seconds
[0m05:45:05.121228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb18ebcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d2fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b6d9a0>]}
[0m05:45:05.121453 [debug] [MainThread]: Flushing usage events
[0m05:45:06.676825 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:45:20.163217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f578800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a1d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f57af90>]}


============================== 05:45:20.165158 | fcc29022-eff9-4418-9ec0-bb59a358803c ==============================
[0m05:45:20.165158 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:45:20.165539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:45:20.202837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eafd280>]}
[0m05:45:20.208415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eaff230>]}
[0m05:45:20.208885 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:45:20.212944 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:45:20.231874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:45:20.232244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:45:20.234547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eadb830>]}
[0m05:45:20.240873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb47290>]}
[0m05:45:20.241221 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:45:20.241626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6dee40>]}
[0m05:45:20.242348 [info ] [MainThread]: 
[0m05:45:20.242762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:45:20.243365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:45:20.247209 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:45:20.247509 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:45:20.247753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:20.249945 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:45:20.250591 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:45:20.251320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_silver)
[0m05:45:20.251708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:45:20.253654 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:45:20.254421 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:45:20.254733 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:45:20.255000 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:45:20.255287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:20.255515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:20.257363 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.257499 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.257704 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:45:20.257965 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:45:20.258279 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:45:20.258586 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:45:20.259812 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m05:45:20.261677 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:45:20.261100 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:45:20.262521 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:45:20.262079 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:45:20.262852 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:45:20.266215 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.266524 [debug] [MainThread]: On master: BEGIN
[0m05:45:20.266778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:45:20.268560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.268810 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.269087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:45:20.273032 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:45:20.273779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9031b200>]}
[0m05:45:20.274097 [debug] [MainThread]: On master: ROLLBACK
[0m05:45:20.274432 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.274674 [debug] [MainThread]: On master: BEGIN
[0m05:45:20.275063 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.275291 [debug] [MainThread]: On master: COMMIT
[0m05:45:20.275514 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.275741 [debug] [MainThread]: On master: COMMIT
[0m05:45:20.276006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:45:20.276216 [debug] [MainThread]: On master: Close
[0m05:45:20.276635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:45:20.277136 [info ] [MainThread]: 
[0m05:45:20.278663 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:45:20.278987 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:45:20.279397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m05:45:20.279647 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:45:20.282844 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.284118 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:45:20.279846 => 05:45:20.284034
[0m05:45:20.284367 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:45:20.298208 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.299517 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.299773 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:45:20.300002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:45:20.301677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.301937 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.302253 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:45:20.314962 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m05:45:20.317474 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.317818 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m05:45:20.318312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:45:20.319413 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.319729 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m05:45:20.320112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:45:20.326996 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:45:20.327314 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.327577 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:45:20.328258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:45:20.331045 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:45:20.331314 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m05:45:20.332311 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:45:20.333019 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:45:20.284562 => 05:45:20.332950
[0m05:45:20.333296 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:45:20.333717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea8fb60>]}
[0m05:45:20.334918 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.05s]
[0m05:45:20.335417 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:45:20.336594 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:45:20.336874 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m05:45:20.337301 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m05:45:20.337534 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m05:45:20.339437 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m05:45:20.340319 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 05:45:20.337703 => 05:45:20.340224
[0m05:45:20.340582 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m05:45:20.342016 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m05:45:20.342881 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:45:20.343125 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m05:45:20.343347 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:45:20.344917 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.345129 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:45:20.345476 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        (SELECT current_active_satellites FROM current_status) / NULLIF(COUNT(CASE WHEN launch_success THEN 1 END), 0) as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)
        ) as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, 50)  -- Minimum 50 per launch
        ) as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING(
            (42000 - s.current_active_satellites) / 70.0  -- Optimistic 70 satellites per launch
        ) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count), 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    ROUND(optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month), 1) as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(actual_satellites_per_successful_launch, 1) as "METRIC: Actual Sats per Success Launch",
    ROUND(recent_total_launches::numeric / NULLIF(recent_successful_launches, 0), 2) as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m05:45:20.347057 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:45:20.347282 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m05:45:20.347604 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 05:45:20.340754 => 05:45:20.347530
[0m05:45:20.347814 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m05:45:20.349450 [debug] [Thread-3 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  function round(double precision, integer) does not exist
  LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:45:20.349775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc29022-eff9-4418-9ec0-bb59a358803c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb18710>]}
[0m05:45:20.350111 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model gold_gold.starlink_42k_projection ........ [[31mERROR[0m in 0.01s]
[0m05:45:20.350619 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:45:20.352234 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.352457 [debug] [MainThread]: On master: BEGIN
[0m05:45:20.352659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:45:20.353921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:45:20.354130 [debug] [MainThread]: On master: COMMIT
[0m05:45:20.354322 [debug] [MainThread]: Using postgres connection "master"
[0m05:45:20.354477 [debug] [MainThread]: On master: COMMIT
[0m05:45:20.354683 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:45:20.354848 [debug] [MainThread]: On master: Close
[0m05:45:20.355157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:45:20.355322 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m05:45:20.355472 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:45:20.355631 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m05:45:20.355840 [info ] [MainThread]: 
[0m05:45:20.356028 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m05:45:20.356360 [debug] [MainThread]: Command end result
[0m05:45:20.360537 [info ] [MainThread]: 
[0m05:45:20.360786 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:45:20.360973 [info ] [MainThread]: 
[0m05:45:20.361162 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m05:45:20.361345 [error] [MainThread]:   function round(double precision, integer) does not exist
[0m05:45:20.361521 [error] [MainThread]:   LINE 152:     ROUND(current_pace_months_needed, 1) as "🎯 CURRENT PACE...
[0m05:45:20.361691 [error] [MainThread]:                 ^
[0m05:45:20.361854 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:45:20.362017 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:45:20.362178 [info ] [MainThread]: 
[0m05:45:20.362379 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:45:20.362631 [debug] [MainThread]: Command `dbt run` failed at 05:45:20.362593 after 0.20 seconds
[0m05:45:20.362870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa180b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a1d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f70eed0>]}
[0m05:45:20.363115 [debug] [MainThread]: Flushing usage events
[0m05:45:21.359752 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:50:22.326722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e21bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3ad9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f162330>]}


============================== 05:50:22.328307 | 23d97afb-0792-4a34-9abf-497b2482da42 ==============================
[0m05:50:22.328307 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:50:22.328661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:50:22.370528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d77bef0>]}
[0m05:50:22.376113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e24a720>]}
[0m05:50:22.376620 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:50:22.380854 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:50:22.397083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:50:22.397454 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m05:50:22.414707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d79c440>]}
[0m05:50:22.421131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d703e30>]}
[0m05:50:22.421431 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:50:22.421872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d703bf0>]}
[0m05:50:22.422558 [info ] [MainThread]: 
[0m05:50:22.422972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:50:22.423509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:50:22.427024 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:50:22.427231 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:50:22.427409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:22.429929 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:50:22.430541 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:50:22.431218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_silver)
[0m05:50:22.431571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m05:50:22.434256 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:50:22.433547 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:50:22.434727 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:50:22.434471 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:50:22.435255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:22.434997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:22.436592 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.437063 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:50:22.436911 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.437594 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:50:22.437313 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:50:22.437828 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:50:22.439230 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:50:22.439791 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:50:22.440523 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m05:50:22.441179 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:50:22.440749 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:50:22.441464 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:50:22.444245 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.444511 [debug] [MainThread]: On master: BEGIN
[0m05:50:22.444748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:50:22.445965 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.446179 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.446420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:50:22.450292 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:50:22.450809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7e53a0>]}
[0m05:50:22.451074 [debug] [MainThread]: On master: ROLLBACK
[0m05:50:22.451354 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.451570 [debug] [MainThread]: On master: BEGIN
[0m05:50:22.451902 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.452132 [debug] [MainThread]: On master: COMMIT
[0m05:50:22.452352 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.452560 [debug] [MainThread]: On master: COMMIT
[0m05:50:22.452832 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:50:22.453039 [debug] [MainThread]: On master: Close
[0m05:50:22.453374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:50:22.453766 [info ] [MainThread]: 
[0m05:50:22.455206 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:50:22.455518 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:50:22.455895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m05:50:22.456141 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:50:22.459007 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.460293 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:50:22.456336 => 05:50:22.460221
[0m05:50:22.460536 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:50:22.473112 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.474247 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.474465 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:50:22.474676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:22.475744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.475980 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.476269 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:50:22.491833 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m05:50:22.494051 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.494347 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m05:50:22.494797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:50:22.495841 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.496110 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m05:50:22.496516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:50:22.502962 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:50:22.503241 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.503509 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:50:22.504201 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:50:22.507660 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:50:22.507915 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m05:50:22.508886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:50:22.509493 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:50:22.460719 => 05:50:22.509423
[0m05:50:22.509737 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:50:22.510131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d17fa10>]}
[0m05:50:22.511118 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.05s]
[0m05:50:22.511561 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:50:22.512682 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:50:22.512953 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m05:50:22.513347 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m05:50:22.513543 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m05:50:22.515289 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m05:50:22.516265 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 05:50:22.513707 => 05:50:22.516175
[0m05:50:22.516502 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m05:50:22.517879 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m05:50:22.519806 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:50:22.520010 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m05:50:22.520195 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:50:22.521508 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.521736 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:50:22.522114 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        (SELECT current_active_satellites FROM current_status) / NULLIF(COUNT(CASE WHEN launch_success THEN 1 END), 0) as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)
        ) as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, 50)  -- Minimum 50 per launch
        ) as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING(
            (42000 - s.current_active_satellites) / 70.0  -- Optimistic 70 satellites per launch
        ) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count)::numeric, 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch::numeric, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month::numeric, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year::numeric, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate::numeric, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed::numeric, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed::numeric, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    ROUND((optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month))::numeric, 1) as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(actual_satellites_per_successful_launch::numeric, 1) as "METRIC: Actual Sats per Success Launch",
    ROUND((recent_total_launches::numeric / NULLIF(recent_successful_launches, 0))::numeric, 2) as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m05:50:22.527988 [debug] [Thread-3 (]: Postgres adapter: Postgres error: division by zero

[0m05:50:22.529590 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m05:50:22.529937 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 05:50:22.516667 => 05:50:22.529869
[0m05:50:22.530171 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m05:50:22.532330 [debug] [Thread-3 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  division by zero
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:50:22.532618 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23d97afb-0792-4a34-9abf-497b2482da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d17c380>]}
[0m05:50:22.532921 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model gold_gold.starlink_42k_projection ........ [[31mERROR[0m in 0.02s]
[0m05:50:22.533218 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:50:22.534834 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.535073 [debug] [MainThread]: On master: BEGIN
[0m05:50:22.535298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:50:22.536434 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:50:22.536634 [debug] [MainThread]: On master: COMMIT
[0m05:50:22.536812 [debug] [MainThread]: Using postgres connection "master"
[0m05:50:22.536974 [debug] [MainThread]: On master: COMMIT
[0m05:50:22.537177 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:50:22.537349 [debug] [MainThread]: On master: Close
[0m05:50:22.537651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:50:22.537826 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m05:50:22.537989 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:50:22.538152 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m05:50:22.538346 [info ] [MainThread]: 
[0m05:50:22.538561 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m05:50:22.538897 [debug] [MainThread]: Command end result
[0m05:50:22.542806 [info ] [MainThread]: 
[0m05:50:22.543023 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:50:22.543200 [info ] [MainThread]: 
[0m05:50:22.543376 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m05:50:22.543546 [error] [MainThread]:   division by zero
[0m05:50:22.543712 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:50:22.543893 [info ] [MainThread]: 
[0m05:50:22.544072 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:50:22.544306 [debug] [MainThread]: Command `dbt run` failed at 05:50:22.544272 after 0.22 seconds
[0m05:50:22.544518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e39b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926bd7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6094f0>]}
[0m05:50:22.544709 [debug] [MainThread]: Flushing usage events
[0m05:50:23.860082 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m05:55:25.630283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33db620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4071a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33d9220>]}


============================== 05:55:25.632737 | 01a017ec-09ed-4860-894a-9e44f168c2ec ==============================
[0m05:55:25.632737 [info ] [MainThread]: Running with dbt=1.6.0
[0m05:55:25.633093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m05:55:25.668225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64786b0>]}
[0m05:55:25.673424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa390e120>]}
[0m05:55:25.673798 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m05:55:25.677369 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m05:55:25.692448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:55:25.692719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:55:25.694789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa340cc50>]}
[0m05:55:25.700228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29a37a0>]}
[0m05:55:25.700512 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m05:55:25.700753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3859b50>]}
[0m05:55:25.701417 [info ] [MainThread]: 
[0m05:55:25.701811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:55:25.702342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m05:55:25.705974 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m05:55:25.706204 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m05:55:25.706407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:25.708390 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:55:25.708974 [debug] [ThreadPool]: On list_spacex_db: Close
[0m05:55:25.709620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_gold)
[0m05:55:25.711648 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:55:25.711928 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_silver'
[0m05:55:25.712081 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m05:55:25.712819 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:55:25.713092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:55:25.713341 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m05:55:25.713961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:25.714838 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.715111 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.715240 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m05:55:25.715504 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m05:55:25.715775 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m05:55:25.716058 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m05:55:25.717154 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m05:55:25.718028 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m05:55:25.718467 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m05:55:25.719041 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m05:55:25.719343 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m05:55:25.719602 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m05:55:25.721938 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.722190 [debug] [MainThread]: On master: BEGIN
[0m05:55:25.722419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:55:25.723617 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.723867 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.724131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:55:25.727669 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m05:55:25.728187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33dadb0>]}
[0m05:55:25.728478 [debug] [MainThread]: On master: ROLLBACK
[0m05:55:25.728778 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.729011 [debug] [MainThread]: On master: BEGIN
[0m05:55:25.729359 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.729606 [debug] [MainThread]: On master: COMMIT
[0m05:55:25.729828 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.730049 [debug] [MainThread]: On master: COMMIT
[0m05:55:25.730328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:55:25.730565 [debug] [MainThread]: On master: Close
[0m05:55:25.730932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:55:25.731448 [info ] [MainThread]: 
[0m05:55:25.732776 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m05:55:25.733080 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m05:55:25.733441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now model.spacex_analytics.starlink_constellation_status)
[0m05:55:25.733766 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m05:55:25.736679 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.738221 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 05:55:25.733981 => 05:55:25.738149
[0m05:55:25.738472 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m05:55:25.751330 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.752570 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.752826 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m05:55:25.753077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:25.754346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.754594 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.754915 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m05:55:25.767144 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m05:55:25.769343 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.769566 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m05:55:25.769870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:55:25.770869 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.771109 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m05:55:25.771429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:55:25.777867 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:55:25.778122 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.778347 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m05:55:25.778993 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:55:25.781586 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m05:55:25.781817 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m05:55:25.782843 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:55:25.783393 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 05:55:25.738697 => 05:55:25.783332
[0m05:55:25.783610 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m05:55:25.783951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28d34a0>]}
[0m05:55:25.784259 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.05s]
[0m05:55:25.784700 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m05:55:25.785842 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m05:55:25.786120 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m05:55:25.786533 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m05:55:25.786748 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m05:55:25.788791 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m05:55:25.789688 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 05:55:25.786922 => 05:55:25.789598
[0m05:55:25.789939 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m05:55:25.791381 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m05:55:25.792220 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:55:25.792440 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m05:55:25.792656 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m05:55:25.793832 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.794058 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m05:55:25.794413 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        (SELECT current_active_satellites FROM current_status) / NULLIF(COUNT(CASE WHEN launch_success THEN 1 END), 0) as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)
        ) as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CEILING(
            (42000 - s.current_active_satellites) / 
            GREATEST(e.actual_satellites_per_successful_launch, 50)  -- Minimum 50 per launch
        ) as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING(
            (42000 - s.current_active_satellites) / 70.0  -- Optimistic 70 satellites per launch
        ) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count)::numeric, 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch::numeric, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month::numeric, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year::numeric, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate::numeric, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed::numeric, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed::numeric, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    ROUND((optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month))::numeric, 1) as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(actual_satellites_per_successful_launch::numeric, 1) as "METRIC: Actual Sats per Success Launch",
    ROUND((recent_total_launches::numeric / NULLIF(recent_successful_launches, 0))::numeric, 2) as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m05:55:25.799765 [debug] [Thread-3 (]: Postgres adapter: Postgres error: division by zero

[0m05:55:25.800022 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: ROLLBACK
[0m05:55:25.802345 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 05:55:25.790138 => 05:55:25.802284
[0m05:55:25.802559 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m05:55:25.804004 [debug] [Thread-3 (]: Database Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)
  division by zero
  compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:55:25.804284 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01a017ec-09ed-4860-894a-9e44f168c2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa06fb710>]}
[0m05:55:25.804563 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model gold_gold.starlink_42k_projection ........ [[31mERROR[0m in 0.02s]
[0m05:55:25.804956 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m05:55:25.806586 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.806823 [debug] [MainThread]: On master: BEGIN
[0m05:55:25.807027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:55:25.808150 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:25.808340 [debug] [MainThread]: On master: COMMIT
[0m05:55:25.808503 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:25.808658 [debug] [MainThread]: On master: COMMIT
[0m05:55:25.808846 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:55:25.808996 [debug] [MainThread]: On master: Close
[0m05:55:25.809247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:25.809419 [debug] [MainThread]: Connection 'list_spacex_db_gold_gold' was properly closed.
[0m05:55:25.809581 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m05:55:25.809732 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m05:55:25.809912 [info ] [MainThread]: 
[0m05:55:25.810091 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m05:55:25.810408 [debug] [MainThread]: Command end result
[0m05:55:25.814029 [info ] [MainThread]: 
[0m05:55:25.814263 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:55:25.814455 [info ] [MainThread]: 
[0m05:55:25.814657 [error] [MainThread]: [33mDatabase Error in model starlink_42k_projection (models/gold/starlink_42k_projection.sql)[0m
[0m05:55:25.814841 [error] [MainThread]:   division by zero
[0m05:55:25.815019 [error] [MainThread]:   compiled Code at target/run/spacex_analytics/models/gold/starlink_42k_projection.sql
[0m05:55:25.815200 [info ] [MainThread]: 
[0m05:55:25.815400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:55:25.815669 [debug] [MainThread]: Command `dbt run` failed at 05:55:25.815633 after 0.19 seconds
[0m05:55:25.815887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38780b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34cbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa353ac60>]}
[0m05:55:25.816076 [debug] [MainThread]: Flushing usage events
[0m05:55:27.684143 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m06:14:01.598413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9434a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98ca330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad92cc80>]}


============================== 06:14:01.600921 | 84f0773b-1931-42fc-87fa-ee3481415939 ==============================
[0m06:14:01.600921 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:14:01.601273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:14:01.645795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9437830>]}
[0m06:14:01.651279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89ab1a0>]}
[0m06:14:01.651728 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m06:14:01.655974 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:14:01.677263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:14:01.677737 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/starlink_42k_projection.sql
[0m06:14:01.697547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89abcb0>]}
[0m06:14:01.704215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8934290>]}
[0m06:14:01.704550 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m06:14:01.704797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9a649b0>]}
[0m06:14:01.705530 [info ] [MainThread]: 
[0m06:14:01.705960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:14:01.706750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m06:14:01.710927 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m06:14:01.711233 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m06:14:01.711469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:01.715468 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m06:14:01.716190 [debug] [ThreadPool]: On list_spacex_db: Close
[0m06:14:01.717025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_gold_gold)
[0m06:14:01.717411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_silver'
[0m06:14:01.720926 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:01.719975 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:01.721494 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m06:14:01.721203 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m06:14:01.722019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:01.721752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:14:01.724587 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.725423 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.725696 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:01.725978 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:01.726292 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m06:14:01.726650 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m06:14:01.729120 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:01.729873 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m06:14:01.730020 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:01.730264 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m06:14:01.730779 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m06:14:01.732194 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m06:14:01.734555 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.734837 [debug] [MainThread]: On master: BEGIN
[0m06:14:01.735071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:01.737021 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.737413 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.737727 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:14:01.742218 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:01.742956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa2f3f80>]}
[0m06:14:01.743267 [debug] [MainThread]: On master: ROLLBACK
[0m06:14:01.743595 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.743881 [debug] [MainThread]: On master: BEGIN
[0m06:14:01.744297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.744549 [debug] [MainThread]: On master: COMMIT
[0m06:14:01.744797 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.745041 [debug] [MainThread]: On master: COMMIT
[0m06:14:01.745336 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:01.745596 [debug] [MainThread]: On master: Close
[0m06:14:01.746056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:14:01.746861 [info ] [MainThread]: 
[0m06:14:01.748424 [debug] [Thread-1 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m06:14:01.748770 [info ] [Thread-1 (]: 1 of 2 START sql table model gold_gold.starlink_constellation_status ........... [RUN]
[0m06:14:01.749266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.starlink_constellation_status)
[0m06:14:01.749527 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m06:14:01.753239 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.754962 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 06:14:01.749729 => 06:14:01.754862
[0m06:14:01.755278 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m06:14:01.769770 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.771334 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.771617 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: BEGIN
[0m06:14:01.771900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:01.774659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.774952 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.775227 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp"
  
  
    as
  
  (
    

WITH constellation_metrics AS (
    SELECT 
        -- Current constellation status
        COUNT(*) as total_satellites_tracked,
        COUNT(CASE WHEN is_active THEN 1 END) as current_active_satellites,
        COUNT(CASE WHEN NOT is_active THEN 1 END) as inactive_satellites,
        ROUND(
            COUNT(CASE WHEN is_active THEN 1 END) * 100.0 / COUNT(*), 
            2
        ) as active_percentage,
        
        -- Timeline information
        MIN(launch_date) as first_satellite_launch_date,
        MAX(launch_date) as latest_satellite_launch_date,
        
        -- Orbital characteristics (for active satellites only)
        ROUND(AVG(CASE WHEN is_active THEN inclination_deg END), 2) as avg_inclination_active_sats,
        ROUND(AVG(CASE WHEN is_active THEN calculated_altitude_km END), 1) as avg_altitude_active_sats_km,
        ROUND(AVG(CASE WHEN is_active THEN orbital_period_min END), 2) as avg_period_active_sats_min,
        
        -- Quality metrics
        COUNT(CASE WHEN data_quality_flag != 'valid' THEN 1 END) as satellites_with_quality_issues,
        ROUND(
            COUNT(CASE WHEN data_quality_flag = 'valid' THEN 1 END) * 100.0 / COUNT(*),
            2
        ) as data_quality_percentage

    FROM "spacex_db"."gold_silver"."silver_starlink"
    WHERE satellite_id IS NOT NULL
),

launch_performance AS (
    SELECT 
        -- Launch statistics (Starlink missions only)
        COUNT(*) as total_starlink_launches,
        COUNT(CASE WHEN launch_success THEN 1 END) as successful_starlink_launches,
        COUNT(CASE WHEN NOT launch_success AND NOT is_upcoming THEN 1 END) as failed_starlink_launches,
        ROUND(
            COUNT(CASE WHEN launch_success THEN 1 END) * 100.0 / 
            COUNT(CASE WHEN NOT is_upcoming THEN 1 END), 
            2
        ) as launch_success_rate_pct,
        
        -- Satellite deployment metrics
        SUM(CASE WHEN launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_launched_successfully,
        ROUND(
            AVG(CASE WHEN launch_success THEN estimated_satellite_count END), 
            1
        ) as avg_satellites_per_successful_launch,
        
        -- Timeline
        MIN(launch_date) as first_starlink_launch_date,
        MAX(CASE WHEN NOT is_upcoming THEN launch_date END) as latest_completed_launch_date,
        
        -- Recent activity (last 30 days)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN 1 END) as launches_last_30_days,
        SUM(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '30 days' AND launch_success THEN estimated_satellite_count ELSE 0 END) as satellites_deployed_last_30_days

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND data_quality_flag = 'valid'
),

data_freshness AS (
    SELECT 
        MAX(extracted_at) as last_data_update,
        ROUND((EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MAX(extracted_at))) / 3600)::numeric, 2) as hours_since_last_update
    FROM "spacex_db"."gold_silver"."silver_starlink"
)

SELECT 
    'starlink_constellation' as metric_category,
    CURRENT_TIMESTAMP as calculated_at,
    
    -- Constellation metrics
    c.total_satellites_tracked,
    c.current_active_satellites,
    c.inactive_satellites,
    c.active_percentage,
    c.satellites_with_quality_issues,
    c.data_quality_percentage,
    
    -- Launch performance metrics
    l.total_starlink_launches,
    l.successful_starlink_launches,
    l.failed_starlink_launches,
    l.launch_success_rate_pct,
    l.satellites_launched_successfully,
    l.avg_satellites_per_successful_launch,
    l.launches_last_30_days,
    l.satellites_deployed_last_30_days,
    
    -- Timeline information
    l.first_starlink_launch_date,
    l.latest_completed_launch_date,
    c.first_satellite_launch_date,
    c.latest_satellite_launch_date,
    
    -- Technical averages for active satellites
    c.avg_inclination_active_sats as avg_inclination_deg,
    c.avg_altitude_active_sats_km as avg_altitude_km,
    c.avg_period_active_sats_min as avg_orbital_period_min,
    
    -- Data freshness indicators
    f.last_data_update,
    ROUND(f.hours_since_last_update::numeric, 1) as hours_since_last_update,
    
    -- Health indicators
    CASE 
        WHEN f.hours_since_last_update > 48 THEN 'Stale'
        WHEN f.hours_since_last_update > 24 THEN 'Warning'
        ELSE 'Fresh'
    END as data_freshness_status,
    
    CASE 
        WHEN c.data_quality_percentage >= 95 THEN 'Excellent'
        WHEN c.data_quality_percentage >= 90 THEN 'Good'
        WHEN c.data_quality_percentage >= 80 THEN 'Fair'
        ELSE 'Poor'
    END as data_quality_status

FROM constellation_metrics c
CROSS JOIN launch_performance l
CROSS JOIN data_freshness f
  );
  
[0m06:14:01.798635 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:01.801490 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.802007 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status" rename to "starlink_constellation_status__dbt_backup"
[0m06:14:01.802814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:14:01.804059 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.804562 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
alter table "spacex_db"."gold_gold"."starlink_constellation_status__dbt_tmp" rename to "starlink_constellation_status"
[0m06:14:01.805843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:14:01.815307 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m06:14:01.816764 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.817084 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: COMMIT
[0m06:14:01.818020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m06:14:01.823549 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.starlink_constellation_status"
[0m06:14:01.823948 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_constellation_status"} */
drop table if exists "spacex_db"."gold_gold"."starlink_constellation_status__dbt_backup" cascade
[0m06:14:01.825499 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m06:14:01.826303 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 06:14:01.755530 => 06:14:01.826228
[0m06:14:01.826540 [debug] [Thread-1 (]: On model.spacex_analytics.starlink_constellation_status: Close
[0m06:14:01.826947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa838e900>]}
[0m06:14:01.827286 [info ] [Thread-1 (]: 1 of 2 OK created sql table model gold_gold.starlink_constellation_status ...... [[32mSELECT 1[0m in 0.08s]
[0m06:14:01.827629 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m06:14:01.829350 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m06:14:01.829736 [info ] [Thread-3 (]: 2 of 2 START sql table model gold_gold.starlink_42k_projection ................. [RUN]
[0m06:14:01.830168 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.starlink_42k_projection'
[0m06:14:01.830410 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m06:14:01.832550 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.833768 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 06:14:01.830624 => 06:14:01.833690
[0m06:14:01.833990 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m06:14:01.835543 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.836541 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.836803 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: BEGIN
[0m06:14:01.837034 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:14:01.838795 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.839036 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.839439 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

  
    

  create  table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp"
  
  
    as
  
  (
    

WITH current_status AS (
    SELECT * FROM "spacex_db"."gold_gold"."starlink_constellation_status"
),

recent_launch_frequency AS (
    -- Calculate launch frequency based on recent performance (last 24 months for accuracy)
    SELECT 
        COUNT(*) as launches_last_24_months,
        COUNT(*) / 24.0 as avg_launches_per_month,
        COUNT(*) / 2.0 as avg_launches_per_year,
        
        -- Seasonal analysis (launches by quarter)
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 1 THEN 1.0 ELSE 0.0 END) * 12 as q1_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 2 THEN 1.0 ELSE 0.0 END) * 12 as q2_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 3 THEN 1.0 ELSE 0.0 END) * 12 as q3_annualized_rate,
        AVG(CASE WHEN EXTRACT(QUARTER FROM launch_date) = 4 THEN 1.0 ELSE 0.0 END) * 12 as q4_annualized_rate,
        
        -- Recent trend (last 6 months vs previous 6 months)
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as recent_6mo_monthly_rate,
        COUNT(CASE WHEN launch_date BETWEEN CURRENT_DATE - INTERVAL '12 months' AND CURRENT_DATE - INTERVAL '6 months' THEN 1 END) / 6.0 as previous_6mo_monthly_rate

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_success = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
      AND launch_date <= CURRENT_DATE  -- Exclude future/upcoming launches
),

deployment_efficiency AS (
    -- Analyze satellite deployment efficiency over time
    SELECT 
        -- Actual satellites deployed vs estimated
        AVG(estimated_satellite_count) as avg_estimated_per_launch,
        
        -- Success rate by time period
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' AND launch_success THEN 1 END) as recent_successful_launches,
        COUNT(CASE WHEN launch_date >= CURRENT_DATE - INTERVAL '12 months' THEN 1 END) as recent_total_launches,
        
        -- Calculate actual deployment rate (using Starlink satellite counts)
        CASE 
            WHEN COUNT(CASE WHEN launch_success THEN 1 END) > 0 THEN
                (SELECT current_active_satellites FROM current_status) / COUNT(CASE WHEN launch_success THEN 1 END)
            ELSE NULL
        END as actual_satellites_per_successful_launch

    FROM "spacex_db"."gold_silver"."silver_launches"
    WHERE is_starlink_mission = true
      AND launch_date >= CURRENT_DATE - INTERVAL '24 months'
),

projection_scenarios AS (
    SELECT 
        s.*,
        f.launches_last_24_months,
        f.avg_launches_per_month,
        f.avg_launches_per_year,
        f.recent_6mo_monthly_rate,
        f.previous_6mo_monthly_rate,
        e.avg_estimated_per_launch,
        e.recent_successful_launches,
        e.recent_total_launches,
        e.actual_satellites_per_successful_launch,
        
        -- Business question parameters
        42000 as target_satellite_count,
        42000 - s.current_active_satellites as satellites_still_needed,
        
        -- Scenario 1: Conservative (based on historical average)
        CASE 
            WHEN GREATEST(COALESCE(e.actual_satellites_per_successful_launch, 0), COALESCE(e.avg_estimated_per_launch, 0)) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch))
            ELSE NULL
        END as conservative_launches_needed,
        
        -- Scenario 2: Current pace (based on recent 6 months)
        CASE 
            WHEN GREATEST(COALESCE(e.actual_satellites_per_successful_launch, 0), 50) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50))
            ELSE NULL
        END as current_pace_launches_needed,
        
        -- Scenario 3: Optimistic (assuming improved efficiency)
        CEILING((42000 - s.current_active_satellites) / 70.0) as optimistic_launches_needed,
        
        -- Timeline calculations
        CASE 
            WHEN f.avg_launches_per_month > 0 AND GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, e.avg_estimated_per_launch)) / f.avg_launches_per_month
            ELSE NULL
        END as conservative_months_needed,
        
        CASE 
            WHEN f.recent_6mo_monthly_rate > 0 AND GREATEST(e.actual_satellites_per_successful_launch, 50) > 0 THEN
                CEILING((42000 - s.current_active_satellites) / GREATEST(e.actual_satellites_per_successful_launch, 50)) / f.recent_6mo_monthly_rate
            ELSE NULL
        END as current_pace_months_needed,
        
        -- Trend analysis
        CASE 
            WHEN f.recent_6mo_monthly_rate > f.previous_6mo_monthly_rate THEN 'Accelerating'
            WHEN f.recent_6mo_monthly_rate < f.previous_6mo_monthly_rate THEN 'Decelerating'
            ELSE 'Stable'
        END as launch_frequency_trend

    FROM current_status s
    CROSS JOIN recent_launch_frequency f
    CROSS JOIN deployment_efficiency e
)

SELECT 
    'starlink_42k_analysis' as analysis_type,
    CURRENT_TIMESTAMP as analysis_timestamp,
    
    -- Current state
    target_satellite_count as "TARGET: Satellites Goal",
    current_active_satellites as "CURRENT: Active Satellites",
    satellites_still_needed as "REMAINING: Satellites Needed",
    ROUND((current_active_satellites * 100.0 / target_satellite_count)::numeric, 1) as "PROGRESS: Percent Complete",
    
    -- Historical context
    total_starlink_launches as "HISTORY: Total Starlink Launches",
    successful_starlink_launches as "HISTORY: Successful Launches",
    launch_success_rate_pct as "HISTORY: Success Rate %",
    ROUND(avg_satellites_per_successful_launch::numeric, 1) as "HISTORY: Avg Satellites per Launch",
    
    -- Recent performance indicators
    launches_last_24_months as "RECENT: Launches (24 months)",
    ROUND(avg_launches_per_month::numeric, 2) as "RECENT: Launches per Month",
    ROUND(avg_launches_per_year::numeric, 1) as "RECENT: Launches per Year",
    ROUND(recent_6mo_monthly_rate::numeric, 2) as "RECENT: Launches per Month (6mo trend)",
    launch_frequency_trend as "TREND: Launch Frequency",
    
    -- 🎯 BUSINESS ANSWERS - Multiple Scenarios
    conservative_launches_needed as "🎯 CONSERVATIVE: Launches Needed",
    ROUND(conservative_months_needed::numeric, 1) as "🎯 CONSERVATIVE: Months to 42K",
    CASE 
        WHEN conservative_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * conservative_months_needed)::date
        ELSE NULL
    END as "🎯 CONSERVATIVE: Est. Completion Date",
    
    current_pace_launches_needed as "🎯 CURRENT PACE: Launches Needed",
    ROUND(current_pace_months_needed::numeric, 1) as "🎯 CURRENT PACE: Months to 42K",
    CASE 
        WHEN current_pace_months_needed IS NOT NULL THEN
            (CURRENT_DATE + INTERVAL '1 month' * current_pace_months_needed)::date
        ELSE NULL
    END as "🎯 CURRENT PACE: Est. Completion Date",
    
    optimistic_launches_needed as "🎯 OPTIMISTIC: Launches Needed",
    CASE 
        WHEN GREATEST(COALESCE(recent_6mo_monthly_rate, 0), COALESCE(avg_launches_per_month, 0)) > 0 AND optimistic_launches_needed > 0 THEN
            ROUND((optimistic_launches_needed / GREATEST(recent_6mo_monthly_rate, avg_launches_per_month))::numeric, 1)
        ELSE NULL
    END as "🎯 OPTIMISTIC: Months to 42K",
    
    -- Confidence and risk assessment
    CASE 
        WHEN launches_last_24_months >= 24 AND recent_successful_launches >= 6 THEN 'High Confidence'
        WHEN launches_last_24_months >= 12 AND recent_successful_launches >= 3 THEN 'Medium Confidence'
        WHEN launches_last_24_months >= 6 THEN 'Low Confidence'
        ELSE 'Insufficient Data'
    END as "CONFIDENCE: Projection Reliability",
    
    -- Risk factors
    CASE 
        WHEN hours_since_last_update > 48 THEN 'Data Staleness Risk'
        WHEN launch_success_rate_pct < 90 THEN 'Launch Reliability Risk'
        WHEN launch_frequency_trend = 'Decelerating' THEN 'Pace Deceleration Risk'
        WHEN satellites_still_needed > current_active_satellites THEN 'Scale Challenge Risk'
        ELSE 'Low Risk'
    END as "RISK: Primary Risk Factor",
    
    -- Performance metrics for analysts
    ROUND(COALESCE(actual_satellites_per_successful_launch, 0)::numeric, 1) as "METRIC: Actual Sats per Success Launch",
    CASE 
        WHEN recent_successful_launches > 0 THEN
            ROUND((recent_total_launches::numeric / recent_successful_launches)::numeric, 2)
        ELSE NULL
    END as "METRIC: Recent Success Rate",
    hours_since_last_update as "METRIC: Data Age (hours)",
    
    -- Key assumptions for transparency
    'Based on recent 24-month performance data' as "ASSUMPTION: Time Period",
    'Excludes satellite deorbiting/failures' as "ASSUMPTION: Satellite Longevity",
    'Assumes current technology and regulations' as "ASSUMPTION: External Factors"

FROM projection_scenarios

-- Add model documentation

  );
  
[0m06:14:01.845059 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:01.846390 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.846624 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
alter table "spacex_db"."gold_gold"."starlink_42k_projection__dbt_tmp" rename to "starlink_42k_projection"
[0m06:14:01.846928 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:14:01.847800 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.847997 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */

        COMMENT ON TABLE "spacex_db"."gold_gold"."starlink_42k_projection" IS 'Business intelligence table answering: When will SpaceX reach 42,000 Starlink satellites and how many launches will it take?'
      
[0m06:14:01.848577 [debug] [Thread-3 (]: SQL status: COMMENT in 0.0 seconds
[0m06:14:01.849187 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m06:14:01.849384 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.849566 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: COMMIT
[0m06:14:01.850172 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m06:14:01.851333 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.starlink_42k_projection"
[0m06:14:01.851613 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "model.spacex_analytics.starlink_42k_projection"} */
drop table if exists "spacex_db"."gold_gold"."starlink_42k_projection__dbt_backup" cascade
[0m06:14:01.851928 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m06:14:01.852548 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 06:14:01.834154 => 06:14:01.852460
[0m06:14:01.852773 [debug] [Thread-3 (]: On model.spacex_analytics.starlink_42k_projection: Close
[0m06:14:01.853214 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f0773b-1931-42fc-87fa-ee3481415939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa838d160>]}
[0m06:14:01.853567 [info ] [Thread-3 (]: 2 of 2 OK created sql table model gold_gold.starlink_42k_projection ............ [[32mSELECT 1[0m in 0.02s]
[0m06:14:01.854131 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m06:14:01.855853 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.856073 [debug] [MainThread]: On master: BEGIN
[0m06:14:01.856260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:14:01.857812 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:01.858012 [debug] [MainThread]: On master: COMMIT
[0m06:14:01.858177 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:01.858338 [debug] [MainThread]: On master: COMMIT
[0m06:14:01.858606 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:01.858879 [debug] [MainThread]: On master: Close
[0m06:14:01.859202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:01.859397 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m06:14:01.859638 [debug] [MainThread]: Connection 'list_spacex_db_gold_silver' was properly closed.
[0m06:14:01.859833 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m06:14:01.860064 [info ] [MainThread]: 
[0m06:14:01.860272 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m06:14:01.860628 [debug] [MainThread]: Command end result
[0m06:14:01.864397 [info ] [MainThread]: 
[0m06:14:01.864658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:14:01.864870 [info ] [MainThread]: 
[0m06:14:01.865099 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:14:01.865372 [debug] [MainThread]: Command `dbt run` succeeded at 06:14:01.865328 after 0.27 seconds
[0m06:14:01.865583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93e8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa0c1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa95bc200>]}
[0m06:14:01.865795 [debug] [MainThread]: Flushing usage events
[0m06:14:03.472163 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m06:14:04.874349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b90b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba9ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c10f740>]}


============================== 06:14:04.876138 | bcb6bd0f-4a76-4e86-902c-5337f081613c ==============================
[0m06:14:04.876138 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:14:04.876676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:14:04.898036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862bb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86a85e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8643cb60>]}


============================== 06:14:04.900542 | 28170a0f-63f2-4b38-abb6-e633c0250afd ==============================
[0m06:14:04.900542 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:14:04.901162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:14:04.918083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba8b110>]}
[0m06:14:04.923765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7d2360>]}
[0m06:14:04.924393 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m06:14:04.930351 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:14:04.941047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863d9df0>]}
[0m06:14:04.947505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8582f2f0>]}
[0m06:14:04.947821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:14:04.948836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:14:04.947905 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m06:14:04.951288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9a25d0>]}
[0m06:14:04.953696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aede990>]}
[0m06:14:04.954027 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m06:14:04.954261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1cf4a0>]}
[0m06:14:04.955209 [info ] [MainThread]: 
[0m06:14:04.955447 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:14:04.955810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:14:04.956410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_silver'
[0m06:14:04.957044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m06:14:04.961914 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:04.961138 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:04.962311 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m06:14:04.962118 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m06:14:04.962951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:04.962627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:04.966528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:04.966920 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:04.966688 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:04.967546 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:04.967191 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m06:14:04.967928 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m06:14:04.969531 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:04.971468 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:04.972612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:14:04.972114 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m06:14:04.972898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:14:04.972726 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m06:14:04.973157 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m06:14:04.973543 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m06:14:04.976317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8582ffb0>]}
[0m06:14:04.977063 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:04.977342 [debug] [MainThread]: On master: BEGIN
[0m06:14:04.977587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:04.979031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:04.979346 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:04.979711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:14:04.982938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85872ea0>]}
[0m06:14:04.983216 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m06:14:04.983635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8665ecc0>]}
[0m06:14:04.984161 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:04.985138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb6bd0f-4a76-4e86-902c-5337f081613c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aedee70>]}
[0m06:14:04.984555 [info ] [MainThread]: 
[0m06:14:04.985717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:14:04.985414 [debug] [MainThread]: On master: ROLLBACK
[0m06:14:04.986269 [debug] [MainThread]: On master: Close
[0m06:14:04.986649 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:14:04.987003 [info ] [MainThread]: 
[0m06:14:04.986402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_gold'
[0m06:14:04.991681 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m06:14:04.987404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_gold_silver'
[0m06:14:04.992046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now model.spacex_analytics.silver_launches)
[0m06:14:04.992848 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m06:14:04.991808 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:04.993015 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:04.993561 [debug] [ThreadPool]: On list_spacex_db_gold_gold: BEGIN
[0m06:14:04.993795 [debug] [ThreadPool]: On list_spacex_db_gold_silver: BEGIN
[0m06:14:04.995564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:04.995784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:04.992227 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_starlink
[0m06:14:04.997776 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:04.992710 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:04.998110 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_silver"
[0m06:14:04.998555 [debug] [ThreadPool]: On list_spacex_db_gold_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_silver"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_silver'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_silver'
  
[0m06:14:04.992555 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:04.998262 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:04.999290 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_gold_gold"
[0m06:14:04.999127 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae'
[0m06:14:04.999761 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:04.999559 [debug] [ThreadPool]: On list_spacex_db_gold_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "list_spacex_db_gold_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold_gold'
  
[0m06:14:04.999890 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:05.002457 [debug] [ThreadPool]: On list_spacex_db_gold_silver: ROLLBACK
[0m06:14:05.003758 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:05.003933 [debug] [ThreadPool]: On list_spacex_db_gold_silver: Close
[0m06:14:05.004363 [debug] [ThreadPool]: On list_spacex_db_gold_gold: ROLLBACK
[0m06:14:05.005786 [debug] [ThreadPool]: On list_spacex_db_gold_gold: Close
[0m06:14:05.008055 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:04.998640 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb'
[0m06:14:04.997420 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m06:14:05.008337 [debug] [MainThread]: On master: BEGIN
[0m06:14:04.997828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now model.spacex_analytics.silver_starlink)
[0m06:14:05.008923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:05.009115 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_starlink
[0m06:14:05.008490 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.013830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.014127 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:05.014368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:14:05.006845 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m06:14:05.011872 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (compile): 06:14:04.993007 => 06:14:05.011745
[0m06:14:05.015760 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m06:14:05.016276 [debug] [Thread-1 (]: Timing info for model.spacex_analytics.silver_launches (execute): 06:14:05.016200 => 06:14:05.016209
[0m06:14:05.011578 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_starlink"
[0m06:14:05.014980 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m06:14:05.016954 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m06:14:05.017380 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 06:14:05.000057 => 06:14:05.017273
[0m06:14:05.019265 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.017979 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.020179 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m06:14:05.020233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_launches, now test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1)
[0m06:14:05.020825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28170a0f-63f2-4b38-abb6-e633c0250afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85872ba0>]}
[0m06:14:05.021020 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.021141 [debug] [MainThread]: On master: ROLLBACK
[0m06:14:05.021426 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:05.021612 [debug] [MainThread]: On master: BEGIN
[0m06:14:05.021957 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.022135 [debug] [MainThread]: On master: COMMIT
[0m06:14:05.022295 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:05.022450 [debug] [MainThread]: On master: COMMIT
[0m06:14:05.022642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:05.022791 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m06:14:05.022812 [debug] [MainThread]: On master: Close
[0m06:14:05.019732 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (compile): 06:14:05.010025 => 06:14:05.019670
[0m06:14:05.019554 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 06:14:05.012653 => 06:14:05.019466
[0m06:14:05.019904 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 06:14:05.019820 => 06:14:05.019837
[0m06:14:05.023282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:14:05.024404 [info ] [MainThread]: 
[0m06:14:05.024267 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.025327 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.023967 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 06:14:05.021278 => 06:14:05.023901
[0m06:14:05.023437 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_starlink
[0m06:14:05.026492 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.023703 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.026950 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 06:14:05.026861 => 06:14:05.026866
[0m06:14:05.027119 [info ] [Thread-1 (]: 1 of 8 START test source_not_null_bronze_launches_data ......................... [RUN]
[0m06:14:05.026205 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.026834 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.026541 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.silver_starlink (execute): 06:14:05.026461 => 06:14:05.026465
[0m06:14:05.026676 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.025935 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed)
[0m06:14:05.029142 [info ] [Thread-2 (]: 2 of 8 START test source_not_null_bronze_launches_id ........................... [RUN]
[0m06:14:05.029226 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.029513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_gold, now test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb)
[0m06:14:05.031142 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.028456 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 06:14:05.028383 => 06:14:05.028386
[0m06:14:05.028972 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_starlink
[0m06:14:05.027956 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.032307 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.032640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m06:14:05.031891 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.030956 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m06:14:05.032848 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.027348 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.033134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.silver_starlink, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m06:14:05.031645 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.036594 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m06:14:05.036904 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.028242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_gold_silver, now test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae)
[0m06:14:05.038550 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.037121 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 06:14:05.029436 => 06:14:05.037049
[0m06:14:05.037348 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.039198 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m06:14:05.039498 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.040359 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 06:14:05.040295 => 06:14:05.040298
[0m06:14:05.038022 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m06:14:05.038208 [info ] [Thread-4 (]: 4 of 8 START test source_not_null_bronze_starlink_data ......................... [RUN]
[0m06:14:05.040008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m06:14:05.028704 [info ] [Thread-3 (]: 3 of 8 START test source_not_null_bronze_rockets_id ............................ [RUN]
[0m06:14:05.040451 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m06:14:05.041869 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (compile): 06:14:05.031338 => 06:14:05.041793
[0m06:14:05.042087 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.039731 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 06:14:05.033809 => 06:14:05.039663
[0m06:14:05.042404 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.041118 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 06:14:05.037837 => 06:14:05.041059
[0m06:14:05.043852 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.044091 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 06:14:05.044032 => 06:14:05.044035
[0m06:14:05.043621 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 06:14:05.043543 => 06:14:05.043547
[0m06:14:05.044881 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.040817 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.044452 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.041708 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.041131 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed'
[0m06:14:05.048772 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.045133 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.047833 [debug] [Thread-3 (]: Began running node model.spacex_analytics.starlink_constellation_status
[0m06:14:05.042386 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (compile): 06:14:05.038732 => 06:14:05.042272
[0m06:14:05.049651 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m06:14:05.041580 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1'
[0m06:14:05.051077 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.050132 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m06:14:05.050538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now model.spacex_analytics.starlink_constellation_status)
[0m06:14:05.052667 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.starlink_constellation_status
[0m06:14:05.050291 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m06:14:05.052051 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 06:14:05.048134 => 06:14:05.051975
[0m06:14:05.050731 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.051742 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.048611 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m06:14:05.053234 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m06:14:05.054069 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.starlink_constellation_status"
[0m06:14:05.055222 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m06:14:05.054503 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.058154 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 06:14:05.058074 => 06:14:05.058078
[0m06:14:05.056964 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (compile): 06:14:05.048942 => 06:14:05.056877
[0m06:14:05.056760 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m06:14:05.059404 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_constellation_status (compile): 06:14:05.052820 => 06:14:05.059334
[0m06:14:05.059239 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.058835 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.059891 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.starlink_constellation_status
[0m06:14:05.058953 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (compile): 06:14:05.051565 => 06:14:05.058568
[0m06:14:05.061313 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.061244 [debug] [Thread-3 (]: Timing info for model.spacex_analytics.starlink_constellation_status (execute): 06:14:05.061169 => 06:14:05.061171
[0m06:14:05.059631 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m06:14:05.062536 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: BEGIN
[0m06:14:05.061075 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 06:14:05.055379 => 06:14:05.061002
[0m06:14:05.059092 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m06:14:05.062987 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: BEGIN
[0m06:14:05.062654 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.starlink_constellation_status
[0m06:14:05.062905 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.060797 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m06:14:05.062734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:05.063681 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 06:14:05.063612 => 06:14:05.063615
[0m06:14:05.064376 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.062223 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m06:14:05.063232 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:14:05.064731 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m06:14:05.065879 [debug] [Thread-2 (]: Began running node model.spacex_analytics.starlink_42k_projection
[0m06:14:05.065636 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: BEGIN
[0m06:14:05.066752 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:14:05.066727 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e, now model.spacex_analytics.starlink_42k_projection)
[0m06:14:05.066618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.067538 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"
[0m06:14:05.067250 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.starlink_42k_projection
[0m06:14:05.067235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.068643 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"
[0m06:14:05.069723 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."launches"
where id is null



      
    ) dbt_internal_test
[0m06:14:05.067091 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m06:14:05.070256 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: BEGIN
[0m06:14:05.071135 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.starlink_42k_projection"
[0m06:14:05.070027 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.068115 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."launches"
where data is null



      
    ) dbt_internal_test
[0m06:14:05.070558 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:14:05.071305 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.072671 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_42k_projection (compile): 06:14:05.068308 => 06:14:05.072588
[0m06:14:05.072924 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.starlink_42k_projection
[0m06:14:05.073170 [debug] [Thread-2 (]: Timing info for model.spacex_analytics.starlink_42k_projection (execute): 06:14:05.073105 => 06:14:05.073110
[0m06:14:05.073566 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.starlink_42k_projection
[0m06:14:05.071441 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"
[0m06:14:05.074595 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data
from "spacex_db"."bronze"."starlink"
where data is null



      
    ) dbt_internal_test
[0m06:14:05.074152 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb (execute): 06:14:05.042517 => 06:14:05.074065
[0m06:14:05.075144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:05.075807 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m06:14:05.072542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.076115 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_42k_projection' was properly closed.
[0m06:14:05.076907 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m06:14:05.075396 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.077191 [debug] [MainThread]: Connection 'model.spacex_analytics.starlink_constellation_status' was properly closed.
[0m06:14:05.075673 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: ROLLBACK
[0m06:14:05.078062 [debug] [MainThread]: Command end result
[0m06:14:05.076780 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae (execute): 06:14:05.054552 => 06:14:05.076703
[0m06:14:05.077068 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.077355 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"
[0m06:14:05.078306 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb: Close
[0m06:14:05.080542 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: ROLLBACK
[0m06:14:05.081211 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed (execute): 06:14:05.060114 => 06:14:05.081148
[0m06:14:05.081454 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."rockets"
where id is null



      
    ) dbt_internal_test
[0m06:14:05.082902 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae: Close
[0m06:14:05.083093 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: ROLLBACK
[0m06:14:05.083631 [info ] [Thread-2 (]: 2 of 8 PASS source_not_null_bronze_launches_id ................................. [[32mPASS[0m in 0.05s]
[0m06:14:05.085291 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.084724 [info ] [Thread-1 (]: 1 of 8 PASS source_not_null_bronze_launches_data ............................... [[32mPASS[0m in 0.06s]
[0m06:14:05.085575 [debug] [Thread-4 (]: On test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed: Close
[0m06:14:05.085810 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb
[0m06:14:05.088182 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.086900 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae
[0m06:14:05.087344 [info ] [Thread-4 (]: 4 of 8 PASS source_not_null_bronze_starlink_data ............................... [[32mPASS[0m in 0.05s]
[0m06:14:05.086530 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1 (execute): 06:14:05.061594 => 06:14:05.086449
[0m06:14:05.088692 [info ] [Thread-2 (]: 5 of 8 START test source_not_null_bronze_starlink_id ........................... [RUN]
[0m06:14:05.089199 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.089611 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed
[0m06:14:05.091055 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m06:14:05.091446 [info ] [MainThread]: Building catalog
[0m06:14:05.091307 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.090335 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_id.a97991fefb, now test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e)
[0m06:14:05.092225 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.089848 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: ROLLBACK
[0m06:14:05.094317 [debug] [ThreadPool]: Acquiring new postgres connection 'spacex_db.information_schema'
[0m06:14:05.091940 [info ] [Thread-4 (]: 7 of 8 START test source_unique_bronze_rockets_id .............................. [RUN]
[0m06:14:05.090608 [info ] [Thread-1 (]: 6 of 8 START test source_unique_bronze_launches_id ............................. [RUN]
[0m06:14:05.096977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_launches_data.7e19aa63ae, now test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8)
[0m06:14:05.097186 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.097164 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m06:14:05.097448 [debug] [ThreadPool]: On spacex_db.information_schema: BEGIN
[0m06:14:05.097625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:05.096670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_starlink_data.56f12f45ed, now test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972)
[0m06:14:05.094027 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m06:14:05.094636 [debug] [Thread-3 (]: On test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1: Close
[0m06:14:05.100881 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.099676 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m06:14:05.100392 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.101686 [debug] [ThreadPool]: Using postgres connection "spacex_db.information_schema"
[0m06:14:05.102156 [debug] [ThreadPool]: On spacex_db.information_schema: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "spacex_db.information_schema"} */

    
    

    select
        'spacex_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('gold_silver') or upper(sch.nspname) = upper('gold_gold') or upper(sch.nspname) = upper('bronze'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m06:14:05.101273 [info ] [Thread-3 (]: 3 of 8 PASS source_not_null_bronze_rockets_id .................................. [[32mPASS[0m in 0.06s]
[0m06:14:05.103450 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m06:14:05.104243 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (compile): 06:14:05.092399 => 06:14:05.104170
[0m06:14:05.104657 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1
[0m06:14:05.109073 [debug] [ThreadPool]: SQL status: SELECT 124 in 0.0 seconds
[0m06:14:05.106152 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (compile): 06:14:05.097357 => 06:14:05.106048
[0m06:14:05.110201 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.109253 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.110019 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (compile): 06:14:05.102027 => 06:14:05.109885
[0m06:14:05.108847 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.114172 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m06:14:05.114420 [debug] [ThreadPool]: On spacex_db.information_schema: ROLLBACK
[0m06:14:05.112876 [info ] [Thread-3 (]: 8 of 8 START test source_unique_bronze_starlink_id ............................. [RUN]
[0m06:14:05.115184 [debug] [ThreadPool]: On spacex_db.information_schema: Close
[0m06:14:05.113358 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.112420 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m06:14:05.114999 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.spacex_analytics.source_not_null_bronze_rockets_id.56dfcaa2d1, now test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9)
[0m06:14:05.117643 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m06:14:05.118109 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m06:14:05.118288 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.118946 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: BEGIN
[0m06:14:05.119277 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m06:14:05.120922 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m06:14:05.121455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:14:05.121676 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m06:14:05.123553 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: BEGIN
[0m06:14:05.122875 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: BEGIN
[0m06:14:05.124237 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:14:05.124918 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (compile): 06:14:05.119378 => 06:14:05.124685
[0m06:14:05.125576 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.126490 [info ] [MainThread]: Catalog written to /usr/local/airflow/include/dbt/target/catalog.json
[0m06:14:05.126902 [debug] [MainThread]: Command `dbt docs generate` succeeded at 06:14:05.126853 after 0.26 seconds
[0m06:14:05.127123 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m06:14:05.127304 [debug] [MainThread]: Connection 'spacex_db.information_schema' was properly closed.
[0m06:14:05.127512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba9ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c10eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c10f740>]}
[0m06:14:05.127800 [debug] [MainThread]: Flushing usage events
[0m06:14:05.125114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:05.128001 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m06:14:05.128248 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.128756 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"
[0m06:14:05.129398 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "spacex_db"."bronze"."starlink"
where id is null



      
    ) dbt_internal_test
[0m06:14:05.129817 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.130348 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"
[0m06:14:05.130100 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m06:14:05.130725 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.130581 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."rockets"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:14:05.130871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.131013 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: BEGIN
[0m06:14:05.133930 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:14:05.133705 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"
[0m06:14:05.133566 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.132657 [debug] [Thread-2 (]: Timing info for test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e (execute): 06:14:05.113564 => 06:14:05.132576
[0m06:14:05.135407 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: ROLLBACK
[0m06:14:05.135125 [debug] [Thread-4 (]: Timing info for test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972 (execute): 06:14:05.116674 => 06:14:05.135047
[0m06:14:05.134330 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."launches"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:14:05.135877 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e: Close
[0m06:14:05.135713 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: ROLLBACK
[0m06:14:05.136387 [info ] [Thread-2 (]: 5 of 8 PASS source_not_null_bronze_starlink_id ................................. [[32mPASS[0m in 0.05s]
[0m06:14:05.136865 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e
[0m06:14:05.136625 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972: Close
[0m06:14:05.138026 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.137859 [info ] [Thread-4 (]: 7 of 8 PASS source_unique_bronze_rockets_id .................................... [[32mPASS[0m in 0.04s]
[0m06:14:05.140084 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972
[0m06:14:05.139816 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.140602 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"
[0m06:14:05.139056 [debug] [Thread-1 (]: Timing info for test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8 (execute): 06:14:05.111576 => 06:14:05.138984
[0m06:14:05.141043 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "spacex_db"."bronze"."starlink"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:14:05.141315 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: ROLLBACK
[0m06:14:05.141830 [debug] [Thread-1 (]: On test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8: Close
[0m06:14:05.142286 [info ] [Thread-1 (]: 6 of 8 PASS source_unique_bronze_launches_id ................................... [[32mPASS[0m in 0.05s]
[0m06:14:05.142581 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8
[0m06:14:05.144094 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m06:14:05.149585 [debug] [Thread-3 (]: Timing info for test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9 (execute): 06:14:05.126136 => 06:14:05.149461
[0m06:14:05.149886 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: ROLLBACK
[0m06:14:05.150320 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9: Close
[0m06:14:05.150729 [info ] [Thread-3 (]: 8 of 8 PASS source_unique_bronze_starlink_id ................................... [[32mPASS[0m in 0.04s]
[0m06:14:05.151685 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9
[0m06:14:05.153117 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:05.153325 [debug] [MainThread]: On master: BEGIN
[0m06:14:05.153755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:14:05.155215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:05.155418 [debug] [MainThread]: On master: COMMIT
[0m06:14:05.155596 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:05.155754 [debug] [MainThread]: On master: COMMIT
[0m06:14:05.155955 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:05.156119 [debug] [MainThread]: On master: Close
[0m06:14:05.156411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:05.156724 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_bronze_starlink_id.f072583f8e' was properly closed.
[0m06:14:05.156918 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_launches_id.5753f3b0a8' was properly closed.
[0m06:14:05.157095 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_rockets_id.d0345c9972' was properly closed.
[0m06:14:05.157253 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_bronze_starlink_id.342e53caf9' was properly closed.
[0m06:14:05.157436 [info ] [MainThread]: 
[0m06:14:05.157656 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m06:14:05.158223 [debug] [MainThread]: Command end result
[0m06:14:05.162265 [info ] [MainThread]: 
[0m06:14:05.162531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:14:05.162737 [info ] [MainThread]: 
[0m06:14:05.162943 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m06:14:05.163211 [debug] [MainThread]: Command `dbt test` succeeded at 06:14:05.163173 after 0.27 seconds
[0m06:14:05.163436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8676dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8676d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8639bad0>]}
[0m06:14:05.163659 [debug] [MainThread]: Flushing usage events
[0m06:14:06.026217 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m06:14:06.026581 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m06:14:07.210539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec78800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed99ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec79ac0>]}


============================== 06:14:07.212777 | 706afecb-61b3-4673-a134-67b62676d6b8 ==============================
[0m06:14:07.212777 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:14:07.213254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation log_results --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:14:07.251915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '706afecb-61b3-4673-a134-67b62676d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1cb8f0>]}
[0m06:14:07.257946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '706afecb-61b3-4673-a134-67b62676d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f128ef0>]}
[0m06:14:07.258528 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m06:14:07.262752 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:14:07.277394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:14:07.277802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:14:07.280256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '706afecb-61b3-4673-a134-67b62676d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1ea810>]}
[0m06:14:07.285704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '706afecb-61b3-4673-a134-67b62676d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2451c0>]}
[0m06:14:07.286001 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 350 macros, 0 groups, 0 semantic models
[0m06:14:07.286292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '706afecb-61b3-4673-a134-67b62676d6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edfee40>]}
[0m06:14:07.286755 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_results'
[0m06:14:07.286985 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m06:14:07.287147 [debug] [MainThread]: On macro_log_results: BEGIN
[0m06:14:07.287297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:07.289340 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:07.289638 [debug] [MainThread]: On macro_log_results: COMMIT
[0m06:14:07.289849 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m06:14:07.290051 [debug] [MainThread]: On macro_log_results: COMMIT
[0m06:14:07.290267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:07.295460 [debug] [MainThread]: Using postgres connection "macro_log_results"
[0m06:14:07.295810 [debug] [MainThread]: On macro_log_results: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "spacex_analytics", "target_name": "dev", "connection_name": "macro_log_results"} */

    
    SELECT 
      "🎯 ANSWER: Launches Needed" as launches_needed,
      "🎯 ANSWER: Months to 42K" as months_needed,
      "🎯 ANSWER: Est. Completion Date" as completion_date,
      "CONFIDENCE: Projection Reliability" as confidence
    FROM gold.starlink_42k_projection
    LIMIT 1
  
  
[0m06:14:07.296312 [debug] [MainThread]: Postgres adapter: Postgres error: relation "gold.starlink_42k_projection" does not exist
LINE 9:     FROM gold.starlink_42k_projection
                 ^

[0m06:14:07.296779 [debug] [MainThread]: Postgres adapter: Error running SQL: macro log_results
[0m06:14:07.297001 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m06:14:07.297207 [debug] [MainThread]: On macro_log_results: Close
[0m06:14:07.297564 [error] [MainThread]: Encountered an error while running operation: Database Error
  relation "gold.starlink_42k_projection" does not exist
  LINE 9:     FROM gold.starlink_42k_projection
                   ^
[0m06:14:07.299886 [debug] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 73, in exception_handler
    yield
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "gold.starlink_42k_projection" does not exist
LINE 9:     FROM gold.starlink_42k_projection
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 58, in run
    self._run_unsafe(package_name, macro_name)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 43, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1054, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 30, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 290, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 146, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 66, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/usr/local/lib/python3.12/site-packages/dbt/adapters/postgres/connections.py", line 84, in exception_handler
    raise dbt.exceptions.DbtDatabaseError(str(e).strip()) from e
dbt.exceptions.DbtDatabaseError: Database Error
  relation "gold.starlink_42k_projection" does not exist
  LINE 9:     FROM gold.starlink_42k_projection
                   ^

[0m06:14:07.301036 [debug] [MainThread]: Command `dbt run-operation` failed at 06:14:07.300991 after 0.10 seconds
[0m06:14:07.301260 [debug] [MainThread]: Connection 'macro_log_results' was properly closed.
[0m06:14:07.301476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0b72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0b7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0b6f60>]}
[0m06:14:07.301702 [debug] [MainThread]: Flushing usage events
[0m06:14:08.157689 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
